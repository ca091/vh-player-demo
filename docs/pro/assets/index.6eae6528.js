var __defProp=Object.defineProperty,__defProps=Object.defineProperties,__getOwnPropDescs=Object.getOwnPropertyDescriptors,__getOwnPropSymbols=Object.getOwnPropertySymbols,__hasOwnProp=Object.prototype.hasOwnProperty,__propIsEnum=Object.prototype.propertyIsEnumerable,__defNormalProp=(e,t,i)=>t in e?__defProp(e,t,{enumerable:!0,configurable:!0,writable:!0,value:i}):e[t]=i,__spreadValues=(e,t)=>{for(var i in t||(t={}))__hasOwnProp.call(t,i)&&__defNormalProp(e,i,t[i]);if(__getOwnPropSymbols)for(var i of __getOwnPropSymbols(t))__propIsEnum.call(t,i)&&__defNormalProp(e,i,t[i]);return e},__spreadProps=(e,t)=>__defProps(e,__getOwnPropDescs(t)),__vite_style__=document.createElement("style");__vite_style__.innerHTML="h1,h2,h3,h4,p{margin:0}section{padding-bottom:8px;border-bottom:1px solid #ccc}section+section{margin-top:8px}.player{position:relative;height:56.25vw;background-color:rgba(0,0,0,.1)}.mask{position:absolute;width:100%;top:0;left:0;bottom:0;z-index:2;color:#fff;background-color:rgba(0,0,0,.5);display:none}.mask-capture>img{height:80%}#url{width:90%}#log{height:300px;overflow:scroll;border:1px solid}#mask-all{position:fixed;left:0;right:0;top:0;bottom:0;z-index:999;background:rgba(0,0,0,.5)}:-webkit-full-screen video,:fullscreen video{position:absolute;width:100%;height:100%}.barrage-root{position:absolute;left:0;right:0;top:0;bottom:0;z-index:3;overflow:hidden}.barrage-root .barrage-item{padding:0 6px;position:absolute;left:100%;z-index:4;will-change:transform;cursor:pointer;font-size:14px;color:#fff;white-space:nowrap;border:none}.barrage-root .barrage-item img{max-height:120px}.marquee-root{position:absolute;left:0;right:0;top:0;bottom:0;z-index:2;overflow:hidden}.marquee-root .marquee{position:absolute;white-space:nowrap;user-select:none;font-size:18px;color:#ff8d41}@font-face{font-family:iconfont-player;src:url('//at.alicdn.com/t/font_2982367_7hc2i5lgn5u.eot?t=1644487605199');src:url('//at.alicdn.com/t/font_2982367_7hc2i5lgn5u.eot?t=1644487605199#iefix') format('embedded-opentype'),url('//at.alicdn.com/t/font_2982367_7hc2i5lgn5u.woff2?t=1644487605199') format('woff2'),url('//at.alicdn.com/t/font_2982367_7hc2i5lgn5u.woff?t=1644487605199') format('woff'),url('//at.alicdn.com/t/font_2982367_7hc2i5lgn5u.ttf?t=1644487605199') format('truetype'),url('//at.alicdn.com/t/font_2982367_7hc2i5lgn5u.svg?t=1644487605199#iconfont-player') format('svg')}.iconfont-player{font-family:iconfont-player!important;font-size:18px;font-style:normal;-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale}.icon-player-Loading:before{content:\"\\e65d\"}.icon-player-danmukaiqi:before{content:\"\\e613\"}.icon-player-danmuguanbi:before{content:\"\\e614\"}.icon-player-reload:before{content:\"\\e602\"}.icon-player-diandiandian:before{content:\"\\e8f5\"}.icon-player-bofang:before{content:\"\\e61c\"}.icon-player-bofangzanting:before{content:\"\\e61d\"}.icon-player-jingyin:before{content:\"\\e61e\"}.icon-player-shengyin:before{content:\"\\e62c\"}.icon-player-quanping:before{content:\"\\e646\"}.icon-player-quanping1:before{content:\"\\e672\"}@supports ((--a:0)){.player-control-wrapper,.player-loading-wrapper{--colorMain:#3967FF;--colorBg:rgba(0,0,0,.8);--colorBgBar:#eee;--colorFont:#fff;--colorPoint:#fff;--colorSuccess:#54b946;--margin:12px;--padding:8px;--paddingVol:10px;--borderRadius:4px}}.player-control-wrapper,.player-loading-wrapper{position:absolute;left:0;right:0;bottom:0;z-index:5}.player-loading-wrapper{top:0;display:flex;align-items:center;justify-content:center}.player-loading-wrapper.hide{display:none}.player-control-wrapper{font-size:14px;color:var(--colorFont);background:linear-gradient(0deg,#000,transparent);display:none;user-select:none}.player-control-wrapper.active{display:block}.player-control-wrapper *{box-sizing:content-box!important}.player-control-wrapper .hide{display:none}.player-control-wrapper ul{margin:0;padding:4px var(--padding);position:absolute;z-index:9;list-style:none;border-radius:var(--borderRadius);background-color:var(--colorBg)}.player-control-wrapper ul.active{display:block}.player-control-wrapper li{line-height:1.6;cursor:pointer}.player-control-wrapper li.active{color:var(--colorMain)}.player-control-wrapper.is-live .tools-wrapper{padding:var(--padding)}.player-control-wrapper .tools-wrapper{padding:0 var(--padding) 2px;justify-content:space-between}.player-control-wrapper .bar-wrapper{flex:1;margin:0 8px;padding:8px 0;overflow:hidden}.player-control-wrapper .tools-wrapper,.player-control-wrapper .tools-wrapper-left,.player-control-wrapper .tools-wrapper-right{display:flex;align-items:center}.icon-player-bofang,.icon-player-bofangzanting,.icon-player-jingyin,.icon-player-shengyin{font-weight:700}.icon-player-Loading{font-size:28px;color:var(--colorMain);animation:loading-circle 1.3s linear infinite}.icon-player-danmuguanbi,.icon-player-danmukaiqi{font-size:24px}.icon-player-danmukaiqi{color:var(--colorSuccess)}.player-control-wrapper .ui-barrage-root,.player-control-wrapper .ui-fullscreen-root,.player-control-wrapper .ui-play-root,.player-control-wrapper .ui-reload-root,.player-control-wrapper .ui-volume-root{margin-right:var(--margin)}.player-control-wrapper .ui-duration-root{min-width:94px}.player-control-wrapper .bar-root{height:4px;position:relative;background-color:var(--colorBgBar);cursor:pointer}.player-control-wrapper .bar-root .bar{position:absolute;top:0;left:0;width:100%;height:100%;transform:translateX(-100%)}.player-control-wrapper .bar-root .pos{position:absolute;top:50%;left:-8px;z-index:8;width:8px;height:8px;border-radius:50%;background-color:var(--colorPoint);border:4px solid var(--colorMain);transform:translate(0,-50%)}.player-control-wrapper .bar-root .bar.bar-current{background-color:var(--colorMain);z-index:7}.player-control-wrapper .bar-root .bar.bar-buffered{background-color:#999;z-index:6}.player-control-wrapper .ui-volume-root{position:relative}.player-control-wrapper .slider-root,.player-control-wrapper .volume-slider{position:absolute;width:4px}.player-control-wrapper .volume-slider{padding:var(--paddingVol);left:0;bottom:26px;z-index:9;height:70px;display:none;border-radius:var(--borderRadius);background-color:var(--colorBg)}.player-control-wrapper .volume-slider.active{display:block}.player-control-wrapper .slider-root{left:var(--paddingVol);top:var(--paddingVol);bottom:var(--paddingVol);border-radius:var(--borderRadius);overflow:hidden;cursor:pointer;background-color:var(--colorBgBar)}.player-control-wrapper .slider-root .slider{position:absolute;left:0;top:0;width:100%;height:100%;transform:translateY(100%);background-color:var(--colorMain)}.player-control-wrapper .volume-slider .pos{position:absolute;left:calc(var(--paddingVol) - 2px);bottom:calc(var(--paddingVol) - 4px);width:8px;height:8px;border-radius:50%;transform:translateY(0);cursor:pointer;background-color:var(--colorPoint)}.player-control-wrapper .ui-setting-root{position:relative}.player-control-wrapper .setting-content,.player-control-wrapper .setting-content2{bottom:26px;text-align:center;display:none}.player-control-wrapper .setting-content{right:0;width:50px}.player-control-wrapper .setting-content2{right:68px;width:66px}video::cue{color:#fff;background:0 0;text-shadow:0 1px #000,1px 0 #000,-1px 0 #000,0 -1px #000}@keyframes loading-circle{from{transform:rotateZ(0)}to{transform:rotateZ(360deg)}}@media (any-hover:hover){.iconfont-player:hover{color:var(--colorMain);cursor:pointer}.player-control-wrapper li:hover{color:var(--colorMain)}}",document.head.appendChild(__vite_style__),function(e,t,i){"use strict";function r(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}var n=r(e),a=r(t);const s=document.querySelector.bind(document);function o(e="div",t={},i={}){const r=document.createElement(e);return Object.getOwnPropertyNames(t).forEach((e=>{r[e]=t[e]})),Object.getOwnPropertyNames(i).forEach((e=>{r.setAttribute(e,i[e])})),r}function l(e){return"string"==typeof e?s(e):e}function d(e,t){return new Promise(((i,r)=>{if(document.getElementById(e))i(!0);else{let n=document.createElement("script");n.setAttribute("id",e),n.setAttribute("src",t),document.head.appendChild(n),n.onload=()=>i(!0),n.onerror=()=>r(Error("network error")),setTimeout((()=>{r(Error("timeout"))}),1e4)}}))}function h(){const e={transition:"transitionend",WebkitTransition:"webkitTransitionEnd"};let t=document.createElement("div"),i=Object.keys(e);for(let r of i)if(void 0!==t.style[r])return{css:r,event:e[r]};return!1}const u=window.WebKitCSSMatrix||window.DOMMatrix||window.MSCSSMatrix;function c(e){const t=window.getComputedStyle(e,null).getPropertyValue("transform");return Number(u?new u(t).m41:t.match(/[+-]?\d+/g)[4])}function p(e,t){let i=void 0!==document.hidden?["hidden","visibilitychange","visibilityState"]:"webkitHidden"in document?["webkitHidden","webkitvisibilitychange","webkitVisibilityState"]:void 0;i&&document.addEventListener(i[1],(function(){"visible"===document[i[2]]?e&&e():t&&t()}),!1)}function f(e,t,i){const r="ontouchend"in document,n={down:{t:"touchstart",f:"mousedown"},move:{t:"touchmove",f:"mousemove"},up:{t:"touchend",f:"mouseup"}};let a=e.getBoundingClientRect(),s=r?n[t].t:n[t].f;e.addEventListener(s,(e=>{r&&function(e,t){t.clientX="touchend"===e?t.changedTouches[0].clientX:t.touches[0].clientX}(s,e),i(e,a.x)}))}var g="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function m(e){if(e.__esModule)return e;var t=Object.defineProperty({},"__esModule",{value:!0});return Object.keys(e).forEach((function(i){var r=Object.getOwnPropertyDescriptor(e,i);Object.defineProperty(t,i,r.get?r:{enumerable:!0,get:function(){return e[i]}})})),t}var y={},v={},b={};Object.defineProperty(b,"__esModule",{value:!0});b.ContentRect=function(e){if("getBBox"in e){var t=e.getBBox();return Object.freeze({height:t.height,left:0,top:0,width:t.width})}var i=window.getComputedStyle(e);return Object.freeze({height:parseFloat(i.height||"0"),left:parseFloat(i.paddingLeft||"0"),top:parseFloat(i.paddingTop||"0"),width:parseFloat(i.width||"0")})},Object.defineProperty(v,"__esModule",{value:!0});var w=b,S=function(){function e(e){this.target=e,this.$$broadcastWidth=this.$$broadcastHeight=0}return Object.defineProperty(e.prototype,"broadcastWidth",{get:function(){return this.$$broadcastWidth},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"broadcastHeight",{get:function(){return this.$$broadcastHeight},enumerable:!0,configurable:!0}),e.prototype.isActive=function(){var e=w.ContentRect(this.target);return!!e&&(e.width!==this.broadcastWidth||e.height!==this.broadcastHeight)},e}();v.ResizeObservation=S;var T={};Object.defineProperty(T,"__esModule",{value:!0});var E=b,_=function(e){this.target=e,this.contentRect=E.ContentRect(e)};T.ResizeObserverEntry=_,Object.defineProperty(y,"__esModule",{value:!0});var k=v,P=T,A=[],L=function(){function e(e){this.$$observationTargets=[],this.$$activeTargets=[],this.$$skippedTargets=[];var t=function(e){if(void 0===e)return"Failed to construct 'ResizeObserver': 1 argument required, but only 0 present.";if("function"!=typeof e)return"Failed to construct 'ResizeObserver': The callback provided as parameter 1 is not a function."}(e);if(t)throw TypeError(t);this.$$callback=e}return e.prototype.observe=function(e){var t,i=C("observe",e);if(i)throw TypeError(i);R(this.$$observationTargets,e)>=0||(this.$$observationTargets.push(new k.ResizeObservation(e)),t=this,A.indexOf(t)<0&&(A.push(t),B()))},e.prototype.unobserve=function(e){var t=C("unobserve",e);if(t)throw TypeError(t);var i=R(this.$$observationTargets,e);i<0||(this.$$observationTargets.splice(i,1),0===this.$$observationTargets.length&&O(this))},e.prototype.disconnect=function(){this.$$observationTargets=[],this.$$activeTargets=[],O(this)},e}();function O(e){var t=A.indexOf(e);t>=0&&(A.splice(t,1),j())}function C(e,t){return void 0===t?"Failed to execute '"+e+"' on 'ResizeObserver': 1 argument required, but only 0 present.":t&&t.nodeType===window.Node.ELEMENT_NODE?void 0:"Failed to execute '"+e+"' on 'ResizeObserver': parameter 1 is not of type 'Element'."}function R(e,t){for(var i=0;i<e.length;i+=1)if(e[i].target===t)return i;return-1}y.ResizeObserver=L;var I,x,D,U=function(e){A.forEach((function(t){t.$$activeTargets=[],t.$$skippedTargets=[],t.$$observationTargets.forEach((function(i){i.isActive()&&(N(i.target)>e?t.$$activeTargets.push(i):t.$$skippedTargets.push(i))}))}))},M=function(){var e=1/0;return A.forEach((function(t){if(t.$$activeTargets.length){var i=[];t.$$activeTargets.forEach((function(t){var r=new P.ResizeObserverEntry(t.target);i.push(r),t.$$broadcastWidth=r.contentRect.width,t.$$broadcastHeight=r.contentRect.height;var n=N(t.target);n<e&&(e=n)})),t.$$callback(i,t),t.$$activeTargets=[]}})),e},N=function(e){for(var t=0;e.parentNode;)e=e.parentNode,t+=1;return t},F=function(){var e,t=0;for(U(t);A.some((function(e){return!!e.$$activeTargets.length}));)t=M(),U(t);A.some((function(e){return!!e.$$skippedTargets.length}))&&(e=new window.ErrorEvent("ResizeLoopError",{message:"ResizeObserver loop completed with undelivered notifications."}),window.dispatchEvent(e))},B=function(){I||V()},V=function(){I=window.requestAnimationFrame((function(){F(),V()}))},j=function(){I&&!A.some((function(e){return!!e.$$observationTargets.length}))&&(window.cancelAnimationFrame(I),I=void 0)},z=y.install=function(){return window.ResizeObserver=L},q={exports:{}};
/*!@license
   * UAParser.js v0.7.28
   * Lightweight JavaScript-based User-Agent string parser
   * https://github.com/faisalman/ua-parser-js
   *
   * Copyright © 2012-2021 Faisal Salman <f@faisalman.com>
   * Licensed under MIT License
   */
x=q,D=q.exports,function(e,t){var i="function",r="object",n="string",a="model",s="name",o="type",l="vendor",d="version",h="architecture",u="console",c="mobile",p="tablet",f="smarttv",g="wearable",m="embedded",y={extend:function(e,t){var i={};for(var r in e)t[r]&&t[r].length%2==0?i[r]=t[r].concat(e[r]):i[r]=e[r];return i},has:function(e,t){return typeof e===n&&-1!==t.toLowerCase().indexOf(e.toLowerCase())},lowerize:function(e){return e.toLowerCase()},major:function(e){return typeof e===n?e.replace(/[^\d\.]/g,"").split(".")[0]:t},trim:function(e,t){return e=e.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,""),void 0===t?e:e.substring(0,255)}},v={rgx:function(e,n){for(var a,s,o,l,d,h,u=0;u<n.length&&!d;){var c=n[u],p=n[u+1];for(a=s=0;a<c.length&&!d;)if(d=c[a++].exec(e))for(o=0;o<p.length;o++)h=d[++s],typeof(l=p[o])===r&&l.length>0?2==l.length?typeof l[1]==i?this[l[0]]=l[1].call(this,h):this[l[0]]=l[1]:3==l.length?typeof l[1]!==i||l[1].exec&&l[1].test?this[l[0]]=h?h.replace(l[1],l[2]):t:this[l[0]]=h?l[1].call(this,h,l[2]):t:4==l.length&&(this[l[0]]=h?l[3].call(this,h.replace(l[1],l[2])):t):this[l]=h||t;u+=2}},str:function(e,i){for(var n in i)if(typeof i[n]===r&&i[n].length>0){for(var a=0;a<i[n].length;a++)if(y.has(i[n][a],e))return"?"===n?t:n}else if(y.has(i[n],e))return"?"===n?t:n;return e}},b={browser:{oldSafari:{version:{"1.0":"/8",1.2:"/1",1.3:"/3","2.0":"/412","2.0.2":"/416","2.0.3":"/417","2.0.4":"/419","?":"/"}},oldEdge:{version:{.1:"12.",21:"13.",31:"14.",39:"15.",41:"16.",42:"17.",44:"18."}}},os:{windows:{version:{ME:"4.90","NT 3.11":"NT3.51","NT 4.0":"NT4.0",2e3:"NT 5.0",XP:["NT 5.1","NT 5.2"],Vista:"NT 6.0",7:"NT 6.1",8:"NT 6.2",8.1:"NT 6.3",10:["NT 6.4","NT 10.0"],RT:"ARM"}}}},w={browser:[[/\b(?:crmo|crios)\/([\w\.]+)/i],[d,[s,"Chrome"]],[/edg(?:e|ios|a)?\/([\w\.]+)/i],[d,[s,"Edge"]],[/(opera\smini)\/([\w\.-]+)/i,/(opera\s[mobiletab]{3,6})\b.+version\/([\w\.-]+)/i,/(opera)(?:.+version\/|[\/\s]+)([\w\.]+)/i],[s,d],[/opios[\/\s]+([\w\.]+)/i],[d,[s,"Opera Mini"]],[/\sopr\/([\w\.]+)/i],[d,[s,"Opera"]],[/(kindle)\/([\w\.]+)/i,/(lunascape|maxthon|netfront|jasmine|blazer)[\/\s]?([\w\.]*)/i,/(avant\s|iemobile|slim)(?:browser)?[\/\s]?([\w\.]*)/i,/(ba?idubrowser)[\/\s]?([\w\.]+)/i,/(?:ms|\()(ie)\s([\w\.]+)/i,/(flock|rockmelt|midori|epiphany|silk|skyfire|ovibrowser|bolt|iron|vivaldi|iridium|phantomjs|bowser|quark|qupzilla|falkon)\/([\w\.-]+)/i,/(rekonq|puffin|brave|whale|qqbrowserlite|qq)\/([\w\.]+)/i,/(weibo)__([\d\.]+)/i],[s,d],[/(?:[\s\/]uc?\s?browser|(?:juc.+)ucweb)[\/\s]?([\w\.]+)/i],[d,[s,"UCBrowser"]],[/(?:windowswechat)?\sqbcore\/([\w\.]+)\b.*(?:windowswechat)?/i],[d,[s,"WeChat(Win) Desktop"]],[/micromessenger\/([\w\.]+)/i],[d,[s,"WeChat"]],[/konqueror\/([\w\.]+)/i],[d,[s,"Konqueror"]],[/trident.+rv[:\s]([\w\.]{1,9})\b.+like\sgecko/i],[d,[s,"IE"]],[/yabrowser\/([\w\.]+)/i],[d,[s,"Yandex"]],[/(avast|avg)\/([\w\.]+)/i],[[s,/(.+)/,"$1 Secure Browser"],d],[/focus\/([\w\.]+)/i],[d,[s,"Firefox Focus"]],[/opt\/([\w\.]+)/i],[d,[s,"Opera Touch"]],[/coc_coc_browser\/([\w\.]+)/i],[d,[s,"Coc Coc"]],[/dolfin\/([\w\.]+)/i],[d,[s,"Dolphin"]],[/coast\/([\w\.]+)/i],[d,[s,"Opera Coast"]],[/xiaomi\/miuibrowser\/([\w\.]+)/i],[d,[s,"MIUI Browser"]],[/fxios\/([\w\.-]+)/i],[d,[s,"Firefox"]],[/(qihu|qhbrowser|qihoobrowser|360browser)/i],[[s,"360 Browser"]],[/(oculus|samsung|sailfish)browser\/([\w\.]+)/i],[[s,/(.+)/,"$1 Browser"],d],[/(comodo_dragon)\/([\w\.]+)/i],[[s,/_/g," "],d],[/\s(electron)\/([\w\.]+)\ssafari/i,/(tesla)(?:\sqtcarbrowser|\/(20[12]\d\.[\w\.-]+))/i,/m?(qqbrowser|baiduboxapp|2345Explorer)[\/\s]?([\w\.]+)/i],[s,d],[/(MetaSr)[\/\s]?([\w\.]+)/i,/(LBBROWSER)/i],[s],[/;fbav\/([\w\.]+);/i],[d,[s,"Facebook"]],[/FBAN\/FBIOS|FB_IAB\/FB4A/i],[[s,"Facebook"]],[/safari\s(line)\/([\w\.]+)/i,/\b(line)\/([\w\.]+)\/iab/i,/(chromium|instagram)[\/\s]([\w\.-]+)/i],[s,d],[/\bgsa\/([\w\.]+)\s.*safari\//i],[d,[s,"GSA"]],[/headlesschrome(?:\/([\w\.]+)|\s)/i],[d,[s,"Chrome Headless"]],[/\swv\).+(chrome)\/([\w\.]+)/i],[[s,"Chrome WebView"],d],[/droid.+\sversion\/([\w\.]+)\b.+(?:mobile\ssafari|safari)/i],[d,[s,"Android Browser"]],[/(chrome|omniweb|arora|[tizenoka]{5}\s?browser)\/v?([\w\.]+)/i],[s,d],[/version\/([\w\.]+)\s.*mobile\/\w+\s(safari)/i],[d,[s,"Mobile Safari"]],[/version\/([\w\.]+)\s.*(mobile\s?safari|safari)/i],[d,s],[/webkit.+?(mobile\s?safari|safari)(\/[\w\.]+)/i],[s,[d,v.str,b.browser.oldSafari.version]],[/(webkit|khtml)\/([\w\.]+)/i],[s,d],[/(navigator|netscape)\/([\w\.-]+)/i],[[s,"Netscape"],d],[/ile\svr;\srv:([\w\.]+)\).+firefox/i],[d,[s,"Firefox Reality"]],[/ekiohf.+(flow)\/([\w\.]+)/i,/(swiftfox)/i,/(icedragon|iceweasel|camino|chimera|fennec|maemo\sbrowser|minimo|conkeror)[\/\s]?([\w\.\+]+)/i,/(firefox|seamonkey|k-meleon|icecat|iceape|firebird|phoenix|palemoon|basilisk|waterfox)\/([\w\.-]+)$/i,/(firefox)\/([\w\.]+)\s[\w\s\-]+\/[\w\.]+$/i,/(mozilla)\/([\w\.]+)\s.+rv\:.+gecko\/\d+/i,/(polaris|lynx|dillo|icab|doris|amaya|w3m|netsurf|sleipnir)[\/\s]?([\w\.]+)/i,/(links)\s\(([\w\.]+)/i,/(gobrowser)\/?([\w\.]*)/i,/(ice\s?browser)\/v?([\w\._]+)/i,/(mosaic)[\/\s]([\w\.]+)/i],[s,d]],cpu:[[/(?:(amd|x(?:(?:86|64)[_-])?|wow|win)64)[;\)]/i],[[h,"amd64"]],[/(ia32(?=;))/i],[[h,y.lowerize]],[/((?:i[346]|x)86)[;\)]/i],[[h,"ia32"]],[/\b(aarch64|armv?8e?l?)\b/i],[[h,"arm64"]],[/\b(arm(?:v[67])?ht?n?[fl]p?)\b/i],[[h,"armhf"]],[/windows\s(ce|mobile);\sppc;/i],[[h,"arm"]],[/((?:ppc|powerpc)(?:64)?)(?:\smac|;|\))/i],[[h,/ower/,"",y.lowerize]],[/(sun4\w)[;\)]/i],[[h,"sparc"]],[/((?:avr32|ia64(?=;))|68k(?=\))|\barm(?:64|(?=v(?:[1-7]|[5-7]1)l?|;|eabi))|(?=atmel\s)avr|(?:irix|mips|sparc)(?:64)?\b|pa-risc)/i],[[h,y.lowerize]]],device:[[/\b(sch-i[89]0\d|shw-m380s|sm-[pt]\w{2,4}|gt-[pn]\d{2,4}|sgh-t8[56]9|nexus\s10)/i],[a,[l,"Samsung"],[o,p]],[/\b((?:s[cgp]h|gt|sm)-\w+|galaxy\snexus)/i,/\ssamsung[\s-]([\w-]+)/i,/sec-(sgh\w+)/i],[a,[l,"Samsung"],[o,c]],[/\((ip(?:hone|od)[\s\w]*);/i],[a,[l,"Apple"],[o,c]],[/\((ipad);[\w\s\),;-]+apple/i,/applecoremedia\/[\w\.]+\s\((ipad)/i,/\b(ipad)\d\d?,\d\d?[;\]].+ios/i],[a,[l,"Apple"],[o,p]],[/\b((?:agr|ags[23]|bah2?|sht?)-a?[lw]\d{2})/i],[a,[l,"Huawei"],[o,p]],[/d\/huawei([\w\s-]+)[;\)]/i,/\b(nexus\s6p|vog-[at]?l\d\d|ane-[at]?l[x\d]\d|eml-a?l\d\da?|lya-[at]?l\d[\dc]|clt-a?l\d\di?|ele-l\d\d)/i,/\b(\w{2,4}-[atu][ln][01259][019])[;\)\s]/i],[a,[l,"Huawei"],[o,c]],[/\b(poco[\s\w]+)(?:\sbuild|\))/i,/\b;\s(\w+)\sbuild\/hm\1/i,/\b(hm[\s\-_]?note?[\s_]?(?:\d\w)?)\sbuild/i,/\b(redmi[\s\-_]?(?:note|k)?[\w\s_]+)(?:\sbuild|\))/i,/\b(mi[\s\-_]?(?:a\d|one|one[\s_]plus|note lte)?[\s_]?(?:\d?\w?)[\s_]?(?:plus)?)\sbuild/i],[[a,/_/g," "],[l,"Xiaomi"],[o,c]],[/\b(mi[\s\-_]?(?:pad)(?:[\w\s_]+))(?:\sbuild|\))/i],[[a,/_/g," "],[l,"Xiaomi"],[o,p]],[/;\s(\w+)\sbuild.+\soppo/i,/\s(cph[12]\d{3}|p(?:af|c[al]|d\w|e[ar])[mt]\d0|x9007)\b/i],[a,[l,"OPPO"],[o,c]],[/\svivo\s(\w+)(?:\sbuild|\))/i,/\s(v[12]\d{3}\w?[at])(?:\sbuild|;)/i],[a,[l,"Vivo"],[o,c]],[/\s(rmx[12]\d{3})(?:\sbuild|;)/i],[a,[l,"Realme"],[o,c]],[/\s(milestone|droid(?:[2-4x]|\s(?:bionic|x2|pro|razr))?:?(\s4g)?)\b[\w\s]+build\//i,/\smot(?:orola)?[\s-](\w*)/i,/((?:moto[\s\w\(\)]+|xt\d{3,4}|nexus\s6)(?=\sbuild|\)))/i],[a,[l,"Motorola"],[o,c]],[/\s(mz60\d|xoom[\s2]{0,2})\sbuild\//i],[a,[l,"Motorola"],[o,p]],[/((?=lg)?[vl]k\-?\d{3})\sbuild|\s3\.[\s\w;-]{10}lg?-([06cv9]{3,4})/i],[a,[l,"LG"],[o,p]],[/(lm-?f100[nv]?|nexus\s[45])/i,/lg[e;\s\/-]+((?!browser|netcast)\w+)/i,/\blg(\-?[\d\w]+)\sbuild/i],[a,[l,"LG"],[o,c]],[/(ideatab[\w\-\s]+)/i,/lenovo\s?(s(?:5000|6000)(?:[\w-]+)|tab(?:[\s\w]+)|yt[\d\w-]{6}|tb[\d\w-]{6})/i],[a,[l,"Lenovo"],[o,p]],[/(?:maemo|nokia).*(n900|lumia\s\d+)/i,/nokia[\s_-]?([\w\.-]*)/i],[[a,/_/g," "],[l,"Nokia"],[o,c]],[/droid.+;\s(pixel\sc)[\s)]/i],[a,[l,"Google"],[o,p]],[/droid.+;\s(pixel[\s\daxl]{0,6})(?:\sbuild|\))/i],[a,[l,"Google"],[o,c]],[/droid.+\s([c-g]\d{4}|so[-l]\w+|xq-a\w[4-7][12])(?=\sbuild\/|\).+chrome\/(?![1-6]{0,1}\d\.))/i],[a,[l,"Sony"],[o,c]],[/sony\stablet\s[ps]\sbuild\//i,/(?:sony)?sgp\w+(?:\sbuild\/|\))/i],[[a,"Xperia Tablet"],[l,"Sony"],[o,p]],[/\s(kb2005|in20[12]5|be20[12][59])\b/i,/\ba000(1)\sbuild/i,/\boneplus\s(a\d{4})[\s)]/i],[a,[l,"OnePlus"],[o,c]],[/(alexa)webm/i,/(kf[a-z]{2}wi)(\sbuild\/|\))/i,/(kf[a-z]+)(\sbuild\/|\)).+silk\//i],[a,[l,"Amazon"],[o,p]],[/(sd|kf)[0349hijorstuw]+(\sbuild\/|\)).+silk\//i],[[a,"Fire Phone"],[l,"Amazon"],[o,c]],[/\((playbook);[\w\s\),;-]+(rim)/i],[a,l,[o,p]],[/((?:bb[a-f]|st[hv])100-\d)/i,/\(bb10;\s(\w+)/i],[a,[l,"BlackBerry"],[o,c]],[/(?:\b|asus_)(transfo[prime\s]{4,10}\s\w+|eeepc|slider\s\w+|nexus\s7|padfone|p00[cj])/i],[a,[l,"ASUS"],[o,p]],[/\s(z[es]6[027][01][km][ls]|zenfone\s\d\w?)\b/i],[a,[l,"ASUS"],[o,c]],[/(nexus\s9)/i],[a,[l,"HTC"],[o,p]],[/(htc)[;_\s-]{1,2}([\w\s]+(?=\)|\sbuild)|\w+)/i,/(zte)-(\w*)/i,/(alcatel|geeksphone|nexian|panasonic|(?=;\s)sony)[_\s-]?([\w-]*)/i],[l,[a,/_/g," "],[o,c]],[/droid[x\d\.\s;]+\s([ab][1-7]\-?[0178a]\d\d?)/i],[a,[l,"Acer"],[o,p]],[/droid.+;\s(m[1-5]\snote)\sbuild/i,/\bmz-([\w-]{2,})/i],[a,[l,"Meizu"],[o,c]],[/(blackberry|benq|palm(?=\-)|sonyericsson|acer|asus|dell|meizu|motorola|polytron)[\s_-]?([\w-]*)/i,/(hp)\s([\w\s]+\w)/i,/(asus)-?(\w+)/i,/(microsoft);\s(lumia[\s\w]+)/i,/(lenovo)[_\s-]?([\w-]+)/i,/linux;.+(jolla);/i,/droid.+;\s(oppo)\s?([\w\s]+)\sbuild/i],[l,a,[o,c]],[/(archos)\s(gamepad2?)/i,/(hp).+(touchpad(?!.+tablet)|tablet)/i,/(kindle)\/([\w\.]+)/i,/\s(nook)[\w\s]+build\/(\w+)/i,/(dell)\s(strea[kpr\s\d]*[\dko])/i,/[;\/]\s?(le[\s\-]+pan)[\s\-]+(\w{1,9})\sbuild/i,/[;\/]\s?(trinity)[\-\s]*(t\d{3})\sbuild/i,/\b(gigaset)[\s\-]+(q\w{1,9})\sbuild/i,/\b(vodafone)\s([\w\s]+)(?:\)|\sbuild)/i],[l,a,[o,p]],[/\s(surface\sduo)\s/i],[a,[l,"Microsoft"],[o,p]],[/droid\s[\d\.]+;\s(fp\du?)\sbuild/i],[a,[l,"Fairphone"],[o,c]],[/\s(u304aa)\sbuild/i],[a,[l,"AT&T"],[o,c]],[/sie-(\w*)/i],[a,[l,"Siemens"],[o,c]],[/[;\/]\s?(rct\w+)\sbuild/i],[a,[l,"RCA"],[o,p]],[/[;\/\s](venue[\d\s]{2,7})\sbuild/i],[a,[l,"Dell"],[o,p]],[/[;\/]\s?(q(?:mv|ta)\w+)\sbuild/i],[a,[l,"Verizon"],[o,p]],[/[;\/]\s(?:barnes[&\s]+noble\s|bn[rt])([\w\s\+]*)\sbuild/i],[a,[l,"Barnes & Noble"],[o,p]],[/[;\/]\s(tm\d{3}\w+)\sbuild/i],[a,[l,"NuVision"],[o,p]],[/;\s(k88)\sbuild/i],[a,[l,"ZTE"],[o,p]],[/;\s(nx\d{3}j)\sbuild/i],[a,[l,"ZTE"],[o,c]],[/[;\/]\s?(gen\d{3})\sbuild.*49h/i],[a,[l,"Swiss"],[o,c]],[/[;\/]\s?(zur\d{3})\sbuild/i],[a,[l,"Swiss"],[o,p]],[/[;\/]\s?((zeki)?tb.*\b)\sbuild/i],[a,[l,"Zeki"],[o,p]],[/[;\/]\s([yr]\d{2})\sbuild/i,/[;\/]\s(dragon[\-\s]+touch\s|dt)(\w{5})\sbuild/i],[[l,"Dragon Touch"],a,[o,p]],[/[;\/]\s?(ns-?\w{0,9})\sbuild/i],[a,[l,"Insignia"],[o,p]],[/[;\/]\s?((nxa|Next)-?\w{0,9})\sbuild/i],[a,[l,"NextBook"],[o,p]],[/[;\/]\s?(xtreme\_)?(v(1[045]|2[015]|[3469]0|7[05]))\sbuild/i],[[l,"Voice"],a,[o,c]],[/[;\/]\s?(lvtel\-)?(v1[12])\sbuild/i],[[l,"LvTel"],a,[o,c]],[/;\s(ph-1)\s/i],[a,[l,"Essential"],[o,c]],[/[;\/]\s?(v(100md|700na|7011|917g).*\b)\sbuild/i],[a,[l,"Envizen"],[o,p]],[/[;\/]\s?(trio[\s\w\-\.]+)\sbuild/i],[a,[l,"MachSpeed"],[o,p]],[/[;\/]\s?tu_(1491)\sbuild/i],[a,[l,"Rotor"],[o,p]],[/(shield[\w\s]+)\sbuild/i],[a,[l,"Nvidia"],[o,p]],[/(sprint)\s(\w+)/i],[l,a,[o,c]],[/(kin\.[onetw]{3})/i],[[a,/\./g," "],[l,"Microsoft"],[o,c]],[/droid\s[\d\.]+;\s(cc6666?|et5[16]|mc[239][23]x?|vc8[03]x?)\)/i],[a,[l,"Zebra"],[o,p]],[/droid\s[\d\.]+;\s(ec30|ps20|tc[2-8]\d[kx])\)/i],[a,[l,"Zebra"],[o,c]],[/\s(ouya)\s/i,/(nintendo)\s([wids3utch]+)/i],[l,a,[o,u]],[/droid.+;\s(shield)\sbuild/i],[a,[l,"Nvidia"],[o,u]],[/(playstation\s[345portablevi]+)/i],[a,[l,"Sony"],[o,u]],[/[\s\(;](xbox(?:\sone)?(?!;\sxbox))[\s\);]/i],[a,[l,"Microsoft"],[o,u]],[/smart-tv.+(samsung)/i],[l,[o,f]],[/hbbtv.+maple;(\d+)/i],[[a,/^/,"SmartTV"],[l,"Samsung"],[o,f]],[/(?:linux;\snetcast.+smarttv|lg\snetcast\.tv-201\d)/i],[[l,"LG"],[o,f]],[/(apple)\s?tv/i],[l,[a,"Apple TV"],[o,f]],[/crkey/i],[[a,"Chromecast"],[l,"Google"],[o,f]],[/droid.+aft([\w])(\sbuild\/|\))/i],[a,[l,"Amazon"],[o,f]],[/\(dtv[\);].+(aquos)/i],[a,[l,"Sharp"],[o,f]],[/hbbtv\/\d+\.\d+\.\d+\s+\([\w\s]*;\s*(\w[^;]*);([^;]*)/i],[[l,y.trim],[a,y.trim],[o,f]],[/[\s\/\(](android\s|smart[-\s]?|opera\s)tv[;\)\s]/i],[[o,f]],[/((pebble))app\/[\d\.]+\s/i],[l,a,[o,g]],[/droid.+;\s(glass)\s\d/i],[a,[l,"Google"],[o,g]],[/droid\s[\d\.]+;\s(wt63?0{2,3})\)/i],[a,[l,"Zebra"],[o,g]],[/(tesla)(?:\sqtcarbrowser|\/20[12]\d\.[\w\.-]+)/i],[l,[o,m]],[/droid .+?; ([^;]+?)(?: build|\) applewebkit).+? mobile safari/i],[a,[o,c]],[/droid .+?;\s([^;]+?)(?: build|\) applewebkit).+?(?! mobile) safari/i],[a,[o,p]],[/\s(tablet|tab)[;\/]/i,/\s(mobile)(?:[;\/]|\ssafari)/i],[[o,y.lowerize]],[/(android[\w\.\s\-]{0,9});.+build/i],[a,[l,"Generic"]],[/(phone)/i],[[o,c]]],engine:[[/windows.+\sedge\/([\w\.]+)/i],[d,[s,"EdgeHTML"]],[/webkit\/537\.36.+chrome\/(?!27)([\w\.]+)/i],[d,[s,"Blink"]],[/(presto)\/([\w\.]+)/i,/(webkit|trident|netfront|netsurf|amaya|lynx|w3m|goanna)\/([\w\.]+)/i,/ekioh(flow)\/([\w\.]+)/i,/(khtml|tasman|links)[\/\s]\(?([\w\.]+)/i,/(icab)[\/\s]([23]\.[\d\.]+)/i],[s,d],[/rv\:([\w\.]{1,9})\b.+(gecko)/i],[d,s]],os:[[/microsoft\s(windows)\s(vista|xp)/i],[s,d],[/(windows)\snt\s6\.2;\s(arm)/i,/(windows\sphone(?:\sos)*)[\s\/]?([\d\.\s\w]*)/i,/(windows\smobile|windows)[\s\/]?([ntce\d\.\s]+\w)(?!.+xbox)/i],[s,[d,v.str,b.os.windows.version]],[/(win(?=3|9|n)|win\s9x\s)([nt\d\.]+)/i],[[s,"Windows"],[d,v.str,b.os.windows.version]],[/ip[honead]{2,4}\b(?:.*os\s([\w]+)\slike\smac|;\sopera)/i,/cfnetwork\/.+darwin/i],[[d,/_/g,"."],[s,"iOS"]],[/(mac\sos\sx)\s?([\w\s\.]*)/i,/(macintosh|mac(?=_powerpc)\s)(?!.+haiku)/i],[[s,"Mac OS"],[d,/_/g,"."]],[/(android|webos|palm\sos|qnx|bada|rim\stablet\sos|meego|sailfish|contiki)[\/\s-]?([\w\.]*)/i,/(blackberry)\w*\/([\w\.]*)/i,/(tizen|kaios)[\/\s]([\w\.]+)/i,/\((series40);/i],[s,d],[/\(bb(10);/i],[d,[s,"BlackBerry"]],[/(?:symbian\s?os|symbos|s60(?=;)|series60)[\/\s-]?([\w\.]*)/i],[d,[s,"Symbian"]],[/mozilla.+\(mobile;.+gecko.+firefox/i],[[s,"Firefox OS"]],[/web0s;.+rt(tv)/i,/\b(?:hp)?wos(?:browser)?\/([\w\.]+)/i],[d,[s,"webOS"]],[/crkey\/([\d\.]+)/i],[d,[s,"Chromecast"]],[/(cros)\s[\w]+\s([\w\.]+\w)/i],[[s,"Chromium OS"],d],[/(nintendo|playstation)\s([wids345portablevuch]+)/i,/(xbox);\s+xbox\s([^\);]+)/i,/(mint)[\/\s\(\)]?(\w*)/i,/(mageia|vectorlinux)[;\s]/i,/(joli|[kxln]?ubuntu|debian|suse|opensuse|gentoo|arch(?=\slinux)|slackware|fedora|mandriva|centos|pclinuxos|redhat|zenwalk|linpus|raspbian)(?:\sgnu\/linux)?(?:\slinux)?[\/\s-]?(?!chrom|package)([\w\.-]*)/i,/(hurd|linux)\s?([\w\.]*)/i,/(gnu)\s?([\w\.]*)/i,/\s([frentopc-]{0,4}bsd|dragonfly)\s?(?!amd|[ix346]{1,2}86)([\w\.]*)/i,/(haiku)\s(\w+)/i],[s,d],[/(sunos)\s?([\w\.\d]*)/i],[[s,"Solaris"],d],[/((?:open)?solaris)[\/\s-]?([\w\.]*)/i,/(aix)\s((\d)(?=\.|\)|\s)[\w\.])*/i,/(plan\s9|minix|beos|os\/2|amigaos|morphos|risc\sos|openvms|fuchsia)/i,/(unix)\s?([\w\.]*)/i],[s,d]]},S=function(i,r){if("object"==typeof i&&(r=i,i=t),!(this instanceof S))return new S(i,r).getResult();var a=i||(void 0!==e&&e.navigator&&e.navigator.userAgent?e.navigator.userAgent:""),s=r?y.extend(w,r):w;return this.getBrowser=function(){var e={name:t,version:t};return v.rgx.call(e,a,s.browser),e.major=y.major(e.version),e},this.getCPU=function(){var e={architecture:t};return v.rgx.call(e,a,s.cpu),e},this.getDevice=function(){var e={vendor:t,model:t,type:t};return v.rgx.call(e,a,s.device),e},this.getEngine=function(){var e={name:t,version:t};return v.rgx.call(e,a,s.engine),e},this.getOS=function(){var e={name:t,version:t};return v.rgx.call(e,a,s.os),e},this.getResult=function(){return{ua:this.getUA(),browser:this.getBrowser(),engine:this.getEngine(),os:this.getOS(),device:this.getDevice(),cpu:this.getCPU()}},this.getUA=function(){return a},this.setUA=function(e){return a=typeof e===n&&e.length>255?y.trim(e,255):e,this},this.setUA(a),this};S.VERSION="0.7.28",S.BROWSER={NAME:s,MAJOR:"major",VERSION:d},S.CPU={ARCHITECTURE:h},S.DEVICE={MODEL:a,VENDOR:l,TYPE:o,CONSOLE:u,MOBILE:c,SMARTTV:f,TABLET:p,WEARABLE:g,EMBEDDED:m},S.ENGINE={NAME:s,VERSION:d},S.OS={NAME:s,VERSION:d},x.exports&&(D=x.exports=S),D.UAParser=S;var T=void 0!==e&&(e.jQuery||e.Zepto);if(T&&!T.ua){var E=new S;T.ua=E.getResult(),T.ua.get=function(){return E.getUA()},T.ua.set=function(e){E.setUA(e);var t=E.getResult();for(var i in t)T.ua[i]=t[i]}}}("object"==typeof window?window:g);const G=function(){var e,t;let i=(new q.exports.UAParser).getResult(),r=/mqqbrowser|qzone|qqbrowser|qq|micromessenger/i.test(i.ua),n=/android|adr/i.test(i.ua.toLowerCase());return{isTencent:r,browser:null==(e=i.browser.name)?void 0:e.toLowerCase(),browserVersion:i.browser.version,os:null==(t=i.os.name)?void 0:t.toLowerCase(),osVersion:i.os.version,platform:/(phone|pad|pod|iPhone|iPod|ios|iPad|Android|Mobile|BlackBerry|IEMobile|MQQBrowser|JUC|Fennec|wOSBrowser|BrowserNG|WebOS|Symbian|Windows Phone)/i.test(i.ua)?"mobile":"pc",isIOS:/\(i[^;]+;( U;)? CPU.+Mac OS X/.test(i.ua),isAndroid:n,isX5:r&&n,isUC:/ucbrowser/.test(i.ua.toLowerCase()),supportMSE:!(!window.MediaSource&&!window.WebKitMediaSource)}}();function H(e,t){let i=Date.now(),r=null;return(...n)=>{r=Date.now(),r-i>t&&(e(...n),i=r)}}class W extends class{constructor(){this.autoplay=!0,this.controls="native",this.poster="",this.debug=!1}merge(e){if(!e)return this;for(let t in e)"object"==typeof e[t]?this[t]=__spreadValues(__spreadValues({},this[t]),e[t]):this[t]=e[t];return this}}{constructor(){super(),this.language="en",this.scheduleOption={enable:!0,playerData:{dispatch_server:"",log_info:{uid:""},default_server:{uri:""},app_type:0,live_type:0,live_subtitle:0,live_delay:0,live_duration:0}},this.switchOption={enable:!0},this.marqueeOption={enable:!1},this.watermarkOption={enable:!1},this.barrageOption={enable:!0,positionRange:[0,.5],speed:100,style:{opacity:80,backgroundColor:"transparent"}},this.peer5Option={enable:!1,customerId:"",fallback:!0},this.vttOptions={enable:!1};let e={bufferPursue:20,bufferSeek:30,bufferStop:10,pursueSpeed:1.2,mode:"pursue"},t={bufferPursue:30,bufferSeek:40,bufferStop:20,pursueSpeed:1.2,mode:"pursue"};this.pursueOption={enable:!0,flv:e,hls:t,dash:t,native:e}}}Date.now();const $="app_id",X="third_party_user_id",Q="client",Y="access_token",K="package_check";var Z,J,ee,te,ie,re,ne,ae;(J=Z||(Z={})).Flv="flv",J.Hls="hls",J.HlsNative="hlsnative",J.Flash="flash",J.Native="native",J.Dash="dash",(te=ee||(ee={})).P360="360p",te.P480="480p",te.P720="720p",te.Pa="a",te.PSame="same",(re=ie||(ie={})).TX="tx",re.ALI="ali",re.HW="hw",re.CY="cy",(ae=ne||(ne={})).UISingleDisplay="UISingleDisplay",ae.UIResize="UIResize",function(e){e.Error="error",e.Waiting="waiting",e.Ended="ended",e.Loaded="loadeddata",e.Play="play",e.Canplay="canplay",e.Pause="pause",e.Ratechange="ratechange",e.Stalled="stalled",e.Volumechange="volumechange"}(ne||(ne={})),function(e){e.VTT_ADDED="vttAdded",e.VTT_SELECTED="vttSelected",e.VTT_CLOSED="vttClosed",e.DEFINITION_CHANGE="definitionChange",e.LIVESUBTITLE_OPENED="liveSubtitleOpened",e.LIVESUBTITLE_CLOSED="liveSubtitleClosed",e.AUTOPLAY_FAILED="autoplayFailed",e.FULLSCREEN_CHANGED="fullscreenChanged",e.LAG_REPORT="lagReport",e.LAG_RECOVER="lagRecover",e.OPEN_BARRAGE="openBarrage",e.CLOSE_BARRAGE="closeBarrage",e.CLEAR_BARRAGE="clearBarrage",e.SCHEDULER_COMPLETE="scheduleComplete",e.PULL_STREAM_FAILED="PULL_STREAM_FAILED",e.LINE_CHANGE="lineChange",e.LINE_CHANGED="lineChanged",e.LIVE_TIMESHIFT="liveTimeShift",e.TOUCH_PLAY="touchPlay"}(ne||(ne={}));var se,oe,le={exports:{}};!function(e){var t=Object.prototype.hasOwnProperty,i="~";function r(){}function n(e,t,i){this.fn=e,this.context=t,this.once=i||!1}function a(e,t,r,a,s){if("function"!=typeof r)throw new TypeError("The listener must be a function");var o=new n(r,a||e,s),l=i?i+t:t;return e._events[l]?e._events[l].fn?e._events[l]=[e._events[l],o]:e._events[l].push(o):(e._events[l]=o,e._eventsCount++),e}function s(e,t){0==--e._eventsCount?e._events=new r:delete e._events[t]}function o(){this._events=new r,this._eventsCount=0}Object.create&&(r.prototype=Object.create(null),(new r).__proto__||(i=!1)),o.prototype.eventNames=function(){var e,r,n=[];if(0===this._eventsCount)return n;for(r in e=this._events)t.call(e,r)&&n.push(i?r.slice(1):r);return Object.getOwnPropertySymbols?n.concat(Object.getOwnPropertySymbols(e)):n},o.prototype.listeners=function(e){var t=i?i+e:e,r=this._events[t];if(!r)return[];if(r.fn)return[r.fn];for(var n=0,a=r.length,s=new Array(a);n<a;n++)s[n]=r[n].fn;return s},o.prototype.listenerCount=function(e){var t=i?i+e:e,r=this._events[t];return r?r.fn?1:r.length:0},o.prototype.emit=function(e,t,r,n,a,s){var o=i?i+e:e;if(!this._events[o])return!1;var l,d,h=this._events[o],u=arguments.length;if(h.fn){switch(h.once&&this.removeListener(e,h.fn,void 0,!0),u){case 1:return h.fn.call(h.context),!0;case 2:return h.fn.call(h.context,t),!0;case 3:return h.fn.call(h.context,t,r),!0;case 4:return h.fn.call(h.context,t,r,n),!0;case 5:return h.fn.call(h.context,t,r,n,a),!0;case 6:return h.fn.call(h.context,t,r,n,a,s),!0}for(d=1,l=new Array(u-1);d<u;d++)l[d-1]=arguments[d];h.fn.apply(h.context,l)}else{var c,p=h.length;for(d=0;d<p;d++)switch(h[d].once&&this.removeListener(e,h[d].fn,void 0,!0),u){case 1:h[d].fn.call(h[d].context);break;case 2:h[d].fn.call(h[d].context,t);break;case 3:h[d].fn.call(h[d].context,t,r);break;case 4:h[d].fn.call(h[d].context,t,r,n);break;default:if(!l)for(c=1,l=new Array(u-1);c<u;c++)l[c-1]=arguments[c];h[d].fn.apply(h[d].context,l)}}return!0},o.prototype.on=function(e,t,i){return a(this,e,t,i,!1)},o.prototype.once=function(e,t,i){return a(this,e,t,i,!0)},o.prototype.removeListener=function(e,t,r,n){var a=i?i+e:e;if(!this._events[a])return this;if(!t)return s(this,a),this;var o=this._events[a];if(o.fn)o.fn!==t||n&&!o.once||r&&o.context!==r||s(this,a);else{for(var l=0,d=[],h=o.length;l<h;l++)(o[l].fn!==t||n&&!o[l].once||r&&o[l].context!==r)&&d.push(o[l]);d.length?this._events[a]=1===d.length?d[0]:d:s(this,a)}return this},o.prototype.removeAllListeners=function(e){var t;return e?(t=i?i+e:e,this._events[t]&&s(this,t)):(this._events=new r,this._eventsCount=0),this},o.prototype.off=o.prototype.removeListener,o.prototype.addListener=o.prototype.on,o.prefixed=i,o.EventEmitter=o,e.exports=o}(le);class de{constructor(){this._emitter=new le.exports.EventEmitter}emit(e,t){return this._emitter.emit(e,t)}listenerCount(e){return this._emitter.listenerCount(e)}listeners(e){return this._emitter.listeners(e)}on(e,t,i=this){this._emitter.on(e,t,i)}once(e,t,i=this){this._emitter.once(e,t,i)}removeAllListeners(e){this._emitter.removeAllListeners(e)}off(e,t,i=this,r){this._emitter.off(e,t,i,r)}}(oe=se||(se={})).Trace="trace",oe.Debug="debug",oe.Log="log",oe.Warn="warn",oe.Info="info",oe.Error="error";const he=function(){},ue={trace:he,debug:he,log:he,warn:he,info:he,error:he};let ce=ue;function pe(e,...t){!1!==e&&t.forEach((function(t){ce[t]="object"==typeof e&&e[t]?e[t].bind(e):function(e){const t=self.console[e];return t?t.bind(self.console,`[vlog ${e}] >`):he}(t)}))}function fe(e){if(self.console&&!0===e||"object"==typeof e){pe(e,se.Debug,se.Log,se.Info,se.Warn,se.Error);try{ce.log()}catch(t){ce=ue}}else ce=ue}const ge=ce;class me{constructor(e,t){this.playedTime=0,this.playBackRate=1,this.isPaused=!0,this.url="",this.cacheUrl="",this.autoPlayed=!1,this.options=e,this.context=t,this.video=this.initVideo(e,l("#"+e.videoNode)),this.registerListeners()}initVideo(e,t=document.body){let i={playsinline:!0,"webkit-playsinline":!0,"x5-playsinline":!0,"mtt-playsinline":!0},r=o("video",{autoplay:!!e.autoplay,controls:"native"===e.controls,muted:!!e.muted},__spreadValues(__spreadValues({width:"100%",height:"100%",crossOrigin:"anonymous","z-index":0},i),e.poster?{poster:e.poster}:{}));return t.style.position="relative",t.appendChild(r),r}checkUrl(e,t=!1){return e?this.url!==e||t?(this.cacheUrl||(this.cacheUrl=e),!0):(ge.warn("BasePlayer checkUrl - url 未改变"),!1):(ge.warn("BasePlayer checkUrl - url 未提供"),!1)}setUrl(e){var t;null==(t=this.context)||t.emit(ne.LINE_CHANGED,{old:this.url,new:e}),this.url=e,this.cacheUrl=""}recordPlayStatus(e){ge.info("BasePlayer change line old => ",this.url),ge.info("BasePlayer change line new => ",e),this.playedTime=this.video.currentTime,this.playBackRate=this.video.playbackRate,this.isPaused=this.video.paused}recoverPlayStatus(){ge.info("BasePlayer 还原切线前播放状态:"),"vod"===this.options.type&&(ge.info("BasePlayer playedTime:",this.playedTime),this.video.currentTime=this.playedTime),ge.info("BasePlayer playBackRate:",this.playBackRate),this.video.playbackRate=this.playBackRate,this.isPaused||this.video.play()}registerListeners(){this.video.addEventListener("play",(e=>{var t;null==(t=this.context)||t.emit(ne.Play,e)})),this.video.addEventListener("pause",(e=>{var t;null==(t=this.context)||t.emit(ne.Pause,e)})),this.video.addEventListener("canplay",(e=>{var t;null==(t=this.context)||t.emit(ne.Canplay,e)})),this.video.addEventListener("waiting",(e=>{var t;null==(t=this.context)||t.emit(ne.Waiting,e)})),this.video.addEventListener("ended",(e=>{var t;null==(t=this.context)||t.emit(ne.Ended,e)})),this.video.addEventListener("error",(e=>{var t;null==(t=this.context)||t.emit(ne.Error,e),ge.error(`BasePlayer video error, type: ${e.type}; details: ${e.details}`);let i=e.target&&e.target.error;i&&ge.error(`BasePlayer video error, code: ${i.code}; details: ${i.message}`)})),this.video.addEventListener("stalled",(e=>{var t;null==(t=this.context)||t.emit(ne.Stalled,e)})),this.video.addEventListener("loadeddata",(e=>{var t;null==(t=this.context)||t.emit(ne.Loaded,e)})),this.video.addEventListener("ratechange",(e=>{var t;ge.info("BasePlayer video ratechange",this.video.playbackRate),null==(t=this.context)||t.emit(ne.Ratechange,e)})),this.video.addEventListener("volumechange",(e=>{var t;null==(t=this.context)||t.emit(ne.Volumechange,e)})),this.video.addEventListener("canplaythrough",(e=>{this.options.autoplay&&!this.autoPlayed&&this.video.paused&&(this.autoPlayed=!0,this.video.play().catch((e=>{var t;ge.warn("BasePlayer - not support autoplay"),null==(t=this.context)||t.emit(ne.AUTOPLAY_FAILED,e)})))}))}}class ye extends me{constructor(e,t="flv",i){super(e,i),this.cacheInfo={},ge.info(`FlvPlayer - 创建 ${t} player`),this.type=t}load(e,t=!1){return this.checkUrl(e,t)?(this.nPlayer&&this.recordPlayStatus(e),new Promise((t=>{this.createInstance({type:this.type,isLive:"live"===this.options.type,url:e},{enableWorker:!0,statisticsInfoReportInterval:3e3}).then((i=>{i&&this.nPlayer.on(n.default.Events.METADATA_ARRIVED,(()=>{this.video.onloadedmetadata=()=>{this.recoverPlayStatus()}})),this.registerFlvListeners(),this.nPlayer.on(n.default.Events.METADATA_ARRIVED,(()=>{this.setUrl(e)})),this.nPlayer.attachMediaElement(this.video),this.nPlayer.load(),t(!0)}))}))):Promise.reject(!1)}reload(){return this.load(this.cacheUrl||this.url,!0)}async createInstance(e,t){if("flv"===this.type&&!n.default.isSupported())throw ge.error("FlvPlayer createInstance - flv not supported!"),Error("flv not supported!");const i=!!this.nPlayer;return await this.destroy(),this.nPlayer=n.default.createPlayer(e,t),i}destroy(){var e;return null==(e=this.nPlayer)||e.destroy(),Promise.resolve(!0)}registerFlvListeners(){this.nPlayer.on(n.default.Events.ERROR,((e,...t)=>{var i;ge.error("FlvPlayer Events.ERROR",e,t),e===n.default.ErrorTypes.NETWORK_ERROR&&(t[0]===n.default.ErrorDetails.NETWORK_STATUS_CODE_INVALID&&404===t[1].code||t[0]===n.default.ErrorDetails.NETWORK_TIMEOUT||void 0===t[1].code)&&(null==(i=this.context)||i.emit(ne.PULL_STREAM_FAILED,this.url))})),this.nPlayer.on(n.default.Events.LOADING_COMPLETE,(e=>{var t;ge.info("FlvPlayer Events.LOADING_COMPLETE",e),null==(t=this.context)||t.emit(ne.PULL_STREAM_FAILED,this.url)})),this.nPlayer.on(n.default.Events.STATISTICS_INFO,(e=>{this.cacheInfo=e}))}getBandwidthEstimate(){return this.cacheInfo.speed||0}}ye.Events=n.default.Events;class ve extends me{constructor(e,t){super(e,t),ge.info("HlsPlayer - 创建 HlsPlayer")}load(e,t=!1){return this.checkUrl(e,t)?(this.nPlayer&&this.recordPlayStatus(e),new Promise((t=>{this.createHlsInstance().then((i=>{i&&(this.video.onloadedmetadata=()=>{this.recoverPlayStatus()}),this.registerHlsListeners(),this.nPlayer.on(a.default.Events.MANIFEST_LOADED,(()=>{this.setUrl(e)})),this.nPlayer.loadSource(e),this.nPlayer.attachMedia(this.video),t(!0)}))}))):Promise.reject(!1)}reload(){return this.load(this.cacheUrl||this.url,!0)}async createHlsInstance(){if(!a.default.isSupported())throw ge.error("HlsPlayer - hls not supported"),Error("hls not supported");let e=await this.destroy();return this.nPlayer=new a.default({debug:!1,levelLoadingMaxRetry:-1,fLoader:window.peer5&&window.peer5.HlsJsFragmentLoader,pLoader:window.peer5&&window.peer5.HlsJsPlaylistLoader}),e}destroy(){return new Promise((e=>{this.nPlayer?(this.nPlayer.once(a.default.Events.MEDIA_DETACHED,(()=>{e(!0)})),this.nPlayer.destroy()):e(!1)}))}registerHlsListeners(){this.nPlayer.on(a.default.Events.ERROR,((e,t)=>{var i;ge.error("HlsPlayer Events.ERROR",e,t);let{details:r,type:n}=t;n===a.default.ErrorTypes.NETWORK_ERROR&&(r!==a.default.ErrorDetails.MANIFEST_LOAD_ERROR&&r!==a.default.ErrorDetails.MANIFEST_LOAD_TIMEOUT&&r!==a.default.ErrorDetails.LEVEL_LOAD_ERROR&&r!==a.default.ErrorDetails.LEVEL_LOAD_TIMEOUT||null==(i=this.context)||i.emit(ne.PULL_STREAM_FAILED,this.url))}))}getBandwidthEstimate(){return this.nPlayer.bandwidthEstimate/8192}}ve.Events=a.default.Events;class be extends me{constructor(e,t){super(e,t),ge.info("DashPlayer - 创建 DashPlayer")}load(e,t){return this.checkUrl(e,t)?(this.nPlayer&&this.recordPlayStatus(e),new Promise((t=>{this.createHlsInstance().then((r=>{r&&(this.video.onloadedmetadata=()=>{this.recoverPlayStatus()}),this.registerHlsListeners(),this.nPlayer.on(i.MediaPlayer.events.MANIFEST_LOADED,(()=>{this.setUrl(e)})),this.nPlayer.initialize(this.video,e,!0),t(!0)}))}))):Promise.reject(!1)}async createHlsInstance(){if(!i.supportsMediaSource())throw ge.error("DashPlayer - dash not supported"),Error("dash not supported");let e=await this.destroy();return this.nPlayer=i.MediaPlayer().create(),e}registerHlsListeners(){}reload(){return this.load(this.cacheUrl||this.url,!0)}destroy(){return new Promise((e=>{this.nPlayer?(this.nPlayer.destroy(),e(!0)):e(!1)}))}getBandwidthEstimate(){return 0}}be.Events=i.MediaPlayer.events;const we={timeWait:5e3,timeLazy:15e3,timesReached:-1,timesMax:-1,isInterval:!0};class Se{constructor(e=we){this.times=0,this.timer=0,this.executing=!1;let t=Object.assign({},we,e);ge.info("TaskLoop config",t),this.timeWait=t.timeWait,this.timeLazy=t.timeLazy,this.timesReached=t.timesReached,this.timesMax=t.timesMax,this.isInterval=t.isInterval}setCallback(e){return this.fn=e,this}setIsInterval(e){return this.isInterval=e,this}setTimeWait(e){this.isInterval?clearInterval(this.timer):clearTimeout(this.timer),this.timeWait=e}setInterval(){this.timer=window.setInterval((()=>{this.checkTimesReached()||(this.fn(),this.times+=1)}),this.timeWait)}checkTimesReached(){return-1!==this.timesMax&&this.times>=this.timesMax?(this.destroy(),ge.warn("TaskLoop checkTimesReached - Interval Reach the top, stopped"),!0):(-1!==this.timesReached&&this.timeWait!==this.timeLazy&&this.times>=this.timesReached&&(ge.warn("TaskLoop checkTimesReached - Interval Reach the top, set lazy"),this.setTimeWait(this.timeLazy),this.isInterval&&this.setInterval()),!1)}execute(){if(!this.executing){if(this.isInterval)this.setInterval();else{if(this.checkTimesReached())return;this.timer=window.setTimeout(this.fn,this.timeWait),this.times+=1}this.executing=!0}}destroy(){this.isInterval?clearInterval(this.timer):clearTimeout(this.timer),this.times=0,this.executing=!1}}const Te={length:0,start:()=>0,end:()=>0};function Ee(e){try{return e.buffered}catch(t){return ge.warn("failed to get media.buffered",t),Te}}function _e(e){try{let t=Ee(e);return t.length?t.end(t.length-1):0}catch(t){return ge.warn("failed to get last media.buffered",t),0}}var ke,Pe,Ae,Le;(Pe=ke||(ke={})).ManifestLoading="ManifestLoading",Pe.ManifestLoaded="ManifestLoaded",Pe.ManifestParsed="ManifestParsed",Pe.TsLoading="TsLoading",Pe.TsLoaded="TsLoaded",Pe.Muxed="Muxed",Pe.Play="play",Pe.Pause="pause",Pe.Ratechange="ratechange",Pe.Stalled="stalled",(Le=Ae||(Ae={})).Idle="Idle",Le.TsLoading="TsLoading",Le.TsLoaded="TsLoaded",Le.Ended="Ended";class Oe{constructor(e){this.stats=Ae.Idle,this.segmentTracker={},this.isSeeking=!1,this.nextSegmentIndex=0,this.onMediaSourceOpen=()=>{var e;const{ms:t,hls:i}=this;let r=t.addSourceBuffer('video/mp4; codecs="avc1.42E01E, mp4a.40.2"');r.addEventListener("updateend",this.updateEnd),this.sourceBuffer=r,null==(e=i.loader.m3u8Promise)||e.then((e=>{e.endList&&(t.duration=e.totalDuration),this.taskLoop=new Se({timeWait:500}),this.taskLoop.setCallback(this.tick).execute()}))},this.onMediaSourceEnded=()=>{ge.info("onMediaSourceEnded")},this.onMediaSourceClose=()=>{ge.info("onMediaSourceClose")},this.onSeeking=()=>{this.isSeeking=!0;let{video:e}=this,t=_e(e);console.log("ana onSeeking",e.currentTime,t),this.nextSegmentIndex=this.findSegmentIndex(e.currentTime)},this.onSeeked=()=>{this.isSeeking=!1;let{video:e}=this,t=Ee(e);console.log("ana onSeeked",e.currentTime,t.end(0))},this.tick=()=>{switch(this.stats){case Ae.Idle:this.checkFetchNextSegment()}},this.updateEnd=()=>{const{ms:e,hls:t}=this;let{playManifest:i,segmentIndex:r}=t.loader;if(!this.sourceBuffer.updating&&"open"===e.readyState&&r===i.segments.length-1)return this.stats=Ae.Ended,this.taskLoop.destroy(),void e.endOfStream();this.stats=Ae.Idle},this.hls=e,this.register()}register(){this.hls.on(ke.ManifestParsed,(e=>{ge.info("Events.ManifestParsed",e),this.playManifest=e})),this.hls.on(ke.TsLoading,(e=>{this.stats=Ae.TsLoading})),this.hls.on(ke.TsLoaded,(e=>{this.stats=Ae.TsLoaded,this.segmentTracker[e.segment.index]=!0})),this.hls.on(ke.Muxed,(e=>{ge.info("getBufferedLast",_e(this.sourceBuffer)),this.sourceBuffer.appendBuffer(e)}))}attachMedia(e){const t=this.video=e,i=this.ms=new MediaSource;i.addEventListener("sourceopen",this.onMediaSourceOpen),i.addEventListener("sourceended",this.onMediaSourceEnded),i.addEventListener("sourceclose",this.onMediaSourceClose),e.addEventListener("seeking",this.onSeeking),e.addEventListener("seeked",this.onSeeked),t.src=self.URL.createObjectURL(i),this.objectUrl=t.src}checkFetchNextSegment(){let{hls:e,video:t}=this,i=_e(t);ge.info("buffered",t.currentTime,i),this.nextSegmentIndex?(this.checkBuffered(this.nextSegmentIndex)||e.loader.getTsData(this.nextSegmentIndex),this.nextSegmentIndex=0):t.currentTime>=i-(t.paused?60:10)&&e.loader.getTsData()}findSegmentIndex(e){let t,{playManifest:i}=this,r=0,n=Math.floor(e/i.avgDuration),a=n<10?0:n-10,s=i.segments.length;for(;a<s;a++)if(t=i.segments[a],r+=t.duration,r>=e)return t.index;return 0}checkBuffered(e){return this.segmentTracker[e]}}var Ce=function(){this.init=function(){var e={};this.on=function(t,i){e[t]||(e[t]=[]),e[t]=e[t].concat(i)},this.off=function(t,i){var r;return!!e[t]&&(r=e[t].indexOf(i),e[t]=e[t].slice(),e[t].splice(r,1),r>-1)},this.trigger=function(t){var i,r,n,a;if(i=e[t])if(2===arguments.length)for(n=i.length,r=0;r<n;++r)i[r].call(this,arguments[1]);else{for(a=[],r=arguments.length,r=1;r<arguments.length;++r)a.push(arguments[r]);for(n=i.length,r=0;r<n;++r)i[r].apply(this,a)}},this.dispose=function(){e={}}}};Ce.prototype.pipe=function(e){return this.on("data",(function(t){e.push(t)})),this.on("done",(function(t){e.flush(t)})),this.on("partialdone",(function(t){e.partialFlush(t)})),this.on("endedtimeline",(function(t){e.endTimeline(t)})),this.on("reset",(function(t){e.reset(t)})),e},Ce.prototype.push=function(e){this.trigger("data",e)},Ce.prototype.flush=function(e){this.trigger("done",e)},Ce.prototype.partialFlush=function(e){this.trigger("partialdone",e)},Ce.prototype.endTimeline=function(e){this.trigger("endedtimeline",e)},Ce.prototype.reset=function(e){this.trigger("reset",e)};var Re,Ie,xe,De,Ue,Me,Ne,Fe=Ce,Be=9e4;Ue=function(e,t){return Re(De(e,t))},Me=function(e,t){return Ie(xe(e),t)},Ne=function(e,t,i){return xe(i?e:e-t)};var Ve,je={ONE_SECOND_IN_TS:Be,secondsToVideoTs:Re=function(e){return e*Be},secondsToAudioTs:Ie=function(e,t){return e*t},videoTsToSeconds:xe=function(e){return e/Be},audioTsToSeconds:De=function(e,t){return e/t},audioTsToVideoTs:Ue,videoTsToAudioTs:Me,metadataTsToSeconds:Ne},ze=je.ONE_SECOND_IN_TS,qe=[96e3,88200,64e3,48e3,44100,32e3,24e3,22050,16e3,12e3,11025,8e3,7350];(Ve=function(e){var t,i=0;Ve.prototype.init.call(this),this.skipWarn_=function(e,t){this.trigger("log",{level:"warn",message:"adts skiping bytes "+e+" to "+t+" in frame "+i+" outside syncword"})},this.push=function(r){var n,a,s,o,l,d=0;if(e||(i=0),"audio"===r.type){var h;for(t&&t.length?(s=t,(t=new Uint8Array(s.byteLength+r.data.byteLength)).set(s),t.set(r.data,s.byteLength)):t=r.data;d+7<t.length;)if(255===t[d]&&240==(246&t[d+1])){if("number"==typeof h&&(this.skipWarn_(h,d),h=null),a=2*(1&~t[d+1]),n=(3&t[d+3])<<11|t[d+4]<<3|(224&t[d+5])>>5,l=(o=1024*(1+(3&t[d+6])))*ze/qe[(60&t[d+2])>>>2],t.byteLength-d<n)break;this.trigger("data",{pts:r.pts+i*l,dts:r.dts+i*l,sampleCount:o,audioobjecttype:1+(t[d+2]>>>6&3),channelcount:(1&t[d+2])<<2|(192&t[d+3])>>>6,samplerate:qe[(60&t[d+2])>>>2],samplingfrequencyindex:(60&t[d+2])>>>2,samplesize:16,data:t.subarray(d+7+a,d+n)}),i++,d+=n}else"number"!=typeof h&&(h=d),d++;"number"==typeof h&&(this.skipWarn_(h,d),h=null),t=t.subarray(d)}},this.flush=function(){i=0,this.trigger("done")},this.reset=function(){t=void 0,this.trigger("reset")},this.endTimeline=function(){t=void 0,this.trigger("endedtimeline")}}).prototype=new Fe;var Ge,He,We,$e=Ve,Xe=Fe,Qe=function(e){var t=e.byteLength,i=0,r=0;this.length=function(){return 8*t},this.bitsAvailable=function(){return 8*t+r},this.loadWord=function(){var n=e.byteLength-t,a=new Uint8Array(4),s=Math.min(4,t);if(0===s)throw new Error("no bytes available");a.set(e.subarray(n,n+s)),i=new DataView(a.buffer).getUint32(0),r=8*s,t-=s},this.skipBits=function(e){var n;r>e?(i<<=e,r-=e):(e-=r,e-=8*(n=Math.floor(e/8)),t-=n,this.loadWord(),i<<=e,r-=e)},this.readBits=function(e){var n=Math.min(r,e),a=i>>>32-n;return(r-=n)>0?i<<=n:t>0&&this.loadWord(),(n=e-n)>0?a<<n|this.readBits(n):a},this.skipLeadingZeros=function(){var e;for(e=0;e<r;++e)if(0!=(i&2147483648>>>e))return i<<=e,r-=e,e;return this.loadWord(),e+this.skipLeadingZeros()},this.skipUnsignedExpGolomb=function(){this.skipBits(1+this.skipLeadingZeros())},this.skipExpGolomb=function(){this.skipBits(1+this.skipLeadingZeros())},this.readUnsignedExpGolomb=function(){var e=this.skipLeadingZeros();return this.readBits(e+1)-1},this.readExpGolomb=function(){var e=this.readUnsignedExpGolomb();return 1&e?1+e>>>1:-1*(e>>>1)},this.readBoolean=function(){return 1===this.readBits(1)},this.readUnsignedByte=function(){return this.readBits(8)},this.loadWord()};(He=function(){var e,t,i=0;He.prototype.init.call(this),this.push=function(r){var n;t?((n=new Uint8Array(t.byteLength+r.data.byteLength)).set(t),n.set(r.data,t.byteLength),t=n):t=r.data;for(var a=t.byteLength;i<a-3;i++)if(1===t[i+2]){e=i+5;break}for(;e<a;)switch(t[e]){case 0:if(0!==t[e-1]){e+=2;break}if(0!==t[e-2]){e++;break}i+3!==e-2&&this.trigger("data",t.subarray(i+3,e-2));do{e++}while(1!==t[e]&&e<a);i=e-2,e+=3;break;case 1:if(0!==t[e-1]||0!==t[e-2]){e+=3;break}this.trigger("data",t.subarray(i+3,e-2)),i=e-2,e+=3;break;default:e+=3}t=t.subarray(i),e-=i,i=0},this.reset=function(){t=null,i=0,this.trigger("reset")},this.flush=function(){t&&t.byteLength>3&&this.trigger("data",t.subarray(i+3)),t=null,i=0,this.trigger("done")},this.endTimeline=function(){this.flush(),this.trigger("endedtimeline")}}).prototype=new Xe,We={100:!0,110:!0,122:!0,244:!0,44:!0,83:!0,86:!0,118:!0,128:!0,138:!0,139:!0,134:!0},(Ge=function(){var e,t,i,r,n,a,s,o=new He;Ge.prototype.init.call(this),e=this,this.push=function(e){"video"===e.type&&(t=e.trackId,i=e.pts,r=e.dts,o.push(e))},o.on("data",(function(s){var o={trackId:t,pts:i,dts:r,data:s,nalUnitTypeCode:31&s[0]};switch(o.nalUnitTypeCode){case 5:o.nalUnitType="slice_layer_without_partitioning_rbsp_idr";break;case 6:o.nalUnitType="sei_rbsp",o.escapedRBSP=n(s.subarray(1));break;case 7:o.nalUnitType="seq_parameter_set_rbsp",o.escapedRBSP=n(s.subarray(1)),o.config=a(o.escapedRBSP);break;case 8:o.nalUnitType="pic_parameter_set_rbsp";break;case 9:o.nalUnitType="access_unit_delimiter_rbsp"}e.trigger("data",o)})),o.on("done",(function(){e.trigger("done")})),o.on("partialdone",(function(){e.trigger("partialdone")})),o.on("reset",(function(){e.trigger("reset")})),o.on("endedtimeline",(function(){e.trigger("endedtimeline")})),this.flush=function(){o.flush()},this.partialFlush=function(){o.partialFlush()},this.reset=function(){o.reset()},this.endTimeline=function(){o.endTimeline()},s=function(e,t){var i,r=8,n=8;for(i=0;i<e;i++)0!==n&&(n=(r+t.readExpGolomb()+256)%256),r=0===n?r:n},n=function(e){for(var t,i,r=e.byteLength,n=[],a=1;a<r-2;)0===e[a]&&0===e[a+1]&&3===e[a+2]?(n.push(a+2),a+=2):a++;if(0===n.length)return e;t=r-n.length,i=new Uint8Array(t);var s=0;for(a=0;a<t;s++,a++)s===n[0]&&(s++,n.shift()),i[a]=e[s];return i},a=function(e){var t,i,r,n,a,o,l,d,h,u,c,p,f=0,g=0,m=0,y=0,v=[1,1];if(i=(t=new Qe(e)).readUnsignedByte(),n=t.readUnsignedByte(),r=t.readUnsignedByte(),t.skipUnsignedExpGolomb(),We[i]&&(3===(a=t.readUnsignedExpGolomb())&&t.skipBits(1),t.skipUnsignedExpGolomb(),t.skipUnsignedExpGolomb(),t.skipBits(1),t.readBoolean()))for(c=3!==a?8:12,p=0;p<c;p++)t.readBoolean()&&s(p<6?16:64,t);if(t.skipUnsignedExpGolomb(),0===(o=t.readUnsignedExpGolomb()))t.readUnsignedExpGolomb();else if(1===o)for(t.skipBits(1),t.skipExpGolomb(),t.skipExpGolomb(),l=t.readUnsignedExpGolomb(),p=0;p<l;p++)t.skipExpGolomb();if(t.skipUnsignedExpGolomb(),t.skipBits(1),d=t.readUnsignedExpGolomb(),h=t.readUnsignedExpGolomb(),0===(u=t.readBits(1))&&t.skipBits(1),t.skipBits(1),t.readBoolean()&&(f=t.readUnsignedExpGolomb(),g=t.readUnsignedExpGolomb(),m=t.readUnsignedExpGolomb(),y=t.readUnsignedExpGolomb()),t.readBoolean()&&t.readBoolean()){switch(t.readUnsignedByte()){case 1:v=[1,1];break;case 2:v=[12,11];break;case 3:v=[10,11];break;case 4:v=[16,11];break;case 5:v=[40,33];break;case 6:v=[24,11];break;case 7:v=[20,11];break;case 8:v=[32,11];break;case 9:v=[80,33];break;case 10:v=[18,11];break;case 11:v=[15,11];break;case 12:v=[64,33];break;case 13:v=[160,99];break;case 14:v=[4,3];break;case 15:v=[3,2];break;case 16:v=[2,1];break;case 255:v=[t.readUnsignedByte()<<8|t.readUnsignedByte(),t.readUnsignedByte()<<8|t.readUnsignedByte()]}v&&(v[0],v[1])}return{profileIdc:i,levelIdc:r,profileCompatibility:n,width:16*(d+1)-2*f-2*g,height:(2-u)*(h+1)*16-2*m-2*y,sarRatio:v}}}).prototype=new Xe;var Ye,Ke,Ze,Je,et,tt,it,rt,nt,at,st,ot,lt,dt,ht,ut,ct,pt,ft,gt,mt,yt,vt,bt,wt,St,Tt,Et,_t,kt,Pt,At,Lt,Ot,Ct,Rt,It,xt,Dt,Ut,Mt={H264Stream:Ge,NalByteStream:He},Nt={Adts:$e,h264:Mt},Ft=Math.pow(2,32)-1;!function(){var e;if(yt={avc1:[],avcC:[],btrt:[],dinf:[],dref:[],esds:[],ftyp:[],hdlr:[],mdat:[],mdhd:[],mdia:[],mfhd:[],minf:[],moof:[],moov:[],mp4a:[],mvex:[],mvhd:[],pasp:[],sdtp:[],smhd:[],stbl:[],stco:[],stsc:[],stsd:[],stsz:[],stts:[],styp:[],tfdt:[],tfhd:[],traf:[],trak:[],trun:[],trex:[],tkhd:[],vmhd:[]},"undefined"!=typeof Uint8Array){for(e in yt)yt.hasOwnProperty(e)&&(yt[e]=[e.charCodeAt(0),e.charCodeAt(1),e.charCodeAt(2),e.charCodeAt(3)]);vt=new Uint8Array(["i".charCodeAt(0),"s".charCodeAt(0),"o".charCodeAt(0),"m".charCodeAt(0)]),wt=new Uint8Array(["a".charCodeAt(0),"v".charCodeAt(0),"c".charCodeAt(0),"1".charCodeAt(0)]),bt=new Uint8Array([0,0,0,1]),St=new Uint8Array([0,0,0,0,0,0,0,0,118,105,100,101,0,0,0,0,0,0,0,0,0,0,0,0,86,105,100,101,111,72,97,110,100,108,101,114,0]),Tt=new Uint8Array([0,0,0,0,0,0,0,0,115,111,117,110,0,0,0,0,0,0,0,0,0,0,0,0,83,111,117,110,100,72,97,110,100,108,101,114,0]),Et={video:St,audio:Tt},Pt=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,12,117,114,108,32,0,0,0,1]),kt=new Uint8Array([0,0,0,0,0,0,0,0]),At=new Uint8Array([0,0,0,0,0,0,0,0]),Lt=At,Ot=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0]),Ct=At,_t=new Uint8Array([0,0,0,1,0,0,0,0,0,0,0,0])}}(),Ye=function(e){var t,i,r=[],n=0;for(t=1;t<arguments.length;t++)r.push(arguments[t]);for(t=r.length;t--;)n+=r[t].byteLength;for(i=new Uint8Array(n+8),new DataView(i.buffer,i.byteOffset,i.byteLength).setUint32(0,i.byteLength),i.set(e,4),t=0,n=8;t<r.length;t++)i.set(r[t],n),n+=r[t].byteLength;return i},Ke=function(){return Ye(yt.dinf,Ye(yt.dref,Pt))},Ze=function(e){return Ye(yt.esds,new Uint8Array([0,0,0,0,3,25,0,0,0,4,17,64,21,0,6,0,0,0,218,192,0,0,218,192,5,2,e.audioobjecttype<<3|e.samplingfrequencyindex>>>1,e.samplingfrequencyindex<<7|e.channelcount<<3,6,1,2]))},ht=function(e){return Ye(yt.hdlr,Et[e])},dt=function(e){var t=new Uint8Array([0,0,0,0,0,0,0,2,0,0,0,3,0,1,95,144,e.duration>>>24&255,e.duration>>>16&255,e.duration>>>8&255,255&e.duration,85,196,0,0]);return e.samplerate&&(t[12]=e.samplerate>>>24&255,t[13]=e.samplerate>>>16&255,t[14]=e.samplerate>>>8&255,t[15]=255&e.samplerate),Ye(yt.mdhd,t)},lt=function(e){return Ye(yt.mdia,dt(e),ht(e.type),tt(e))},et=function(e){return Ye(yt.mfhd,new Uint8Array([0,0,0,0,(4278190080&e)>>24,(16711680&e)>>16,(65280&e)>>8,255&e]))},tt=function(e){return Ye(yt.minf,"video"===e.type?Ye(yt.vmhd,_t):Ye(yt.smhd,kt),Ke(),ct(e))},it=function(e,t){for(var i=[],r=t.length;r--;)i[r]=ft(t[r]);return Ye.apply(null,[yt.moof,et(e)].concat(i))},rt=function(e){for(var t=e.length,i=[];t--;)i[t]=st(e[t]);return Ye.apply(null,[yt.moov,at(4294967295)].concat(i).concat(nt(e)))},nt=function(e){for(var t=e.length,i=[];t--;)i[t]=gt(e[t]);return Ye.apply(null,[yt.mvex].concat(i))},at=function(e){var t=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,2,0,1,95,144,(4278190080&e)>>24,(16711680&e)>>16,(65280&e)>>8,255&e,0,1,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,255,255,255,255]);return Ye(yt.mvhd,t)},ut=function(e){var t,i,r=e.samples||[],n=new Uint8Array(4+r.length);for(i=0;i<r.length;i++)t=r[i].flags,n[i+4]=t.dependsOn<<4|t.isDependedOn<<2|t.hasRedundancy;return Ye(yt.sdtp,n)},ct=function(e){return Ye(yt.stbl,pt(e),Ye(yt.stts,Ct),Ye(yt.stsc,Lt),Ye(yt.stsz,Ot),Ye(yt.stco,At))},pt=function(e){return Ye(yt.stsd,new Uint8Array([0,0,0,0,0,0,0,1]),"video"===e.type?Rt(e):It(e))},Rt=function(e){var t,i,r=e.sps||[],n=e.pps||[],a=[],s=[];for(t=0;t<r.length;t++)a.push((65280&r[t].byteLength)>>>8),a.push(255&r[t].byteLength),a=a.concat(Array.prototype.slice.call(r[t]));for(t=0;t<n.length;t++)s.push((65280&n[t].byteLength)>>>8),s.push(255&n[t].byteLength),s=s.concat(Array.prototype.slice.call(n[t]));if(i=[yt.avc1,new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,(65280&e.width)>>8,255&e.width,(65280&e.height)>>8,255&e.height,0,72,0,0,0,72,0,0,0,0,0,0,0,1,19,118,105,100,101,111,106,115,45,99,111,110,116,114,105,98,45,104,108,115,0,0,0,0,0,0,0,0,0,0,0,0,0,24,17,17]),Ye(yt.avcC,new Uint8Array([1,e.profileIdc,e.profileCompatibility,e.levelIdc,255].concat([r.length],a,[n.length],s))),Ye(yt.btrt,new Uint8Array([0,28,156,128,0,45,198,192,0,45,198,192]))],e.sarRatio){var o=e.sarRatio[0],l=e.sarRatio[1];i.push(Ye(yt.pasp,new Uint8Array([(4278190080&o)>>24,(16711680&o)>>16,(65280&o)>>8,255&o,(4278190080&l)>>24,(16711680&l)>>16,(65280&l)>>8,255&l])))}return Ye.apply(null,i)},It=function(e){return Ye(yt.mp4a,new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,(65280&e.channelcount)>>8,255&e.channelcount,(65280&e.samplesize)>>8,255&e.samplesize,0,0,0,0,(65280&e.samplerate)>>8,255&e.samplerate,0,0]),Ze(e))},ot=function(e){var t=new Uint8Array([0,0,0,7,0,0,0,0,0,0,0,0,(4278190080&e.id)>>24,(16711680&e.id)>>16,(65280&e.id)>>8,255&e.id,0,0,0,0,(4278190080&e.duration)>>24,(16711680&e.duration)>>16,(65280&e.duration)>>8,255&e.duration,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,(65280&e.width)>>8,255&e.width,0,0,(65280&e.height)>>8,255&e.height,0,0]);return Ye(yt.tkhd,t)},ft=function(e){var t,i,r,n,a,s;return t=Ye(yt.tfhd,new Uint8Array([0,0,0,58,(4278190080&e.id)>>24,(16711680&e.id)>>16,(65280&e.id)>>8,255&e.id,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0])),a=Math.floor(e.baseMediaDecodeTime/(Ft+1)),s=Math.floor(e.baseMediaDecodeTime%(Ft+1)),i=Ye(yt.tfdt,new Uint8Array([1,0,0,0,a>>>24&255,a>>>16&255,a>>>8&255,255&a,s>>>24&255,s>>>16&255,s>>>8&255,255&s])),92,"audio"===e.type?(r=mt(e,92),Ye(yt.traf,t,i,r)):(n=ut(e),r=mt(e,n.length+92),Ye(yt.traf,t,i,r,n))},st=function(e){return e.duration=e.duration||4294967295,Ye(yt.trak,ot(e),lt(e))},gt=function(e){var t=new Uint8Array([0,0,0,0,(4278190080&e.id)>>24,(16711680&e.id)>>16,(65280&e.id)>>8,255&e.id,0,0,0,1,0,0,0,0,0,0,0,0,0,1,0,1]);return"video"!==e.type&&(t[t.length-1]=0),Ye(yt.trex,t)},Ut=function(e,t){var i=0,r=0,n=0,a=0;return e.length&&(void 0!==e[0].duration&&(i=1),void 0!==e[0].size&&(r=2),void 0!==e[0].flags&&(n=4),void 0!==e[0].compositionTimeOffset&&(a=8)),[0,0,i|r|n|a,1,(4278190080&e.length)>>>24,(16711680&e.length)>>>16,(65280&e.length)>>>8,255&e.length,(4278190080&t)>>>24,(16711680&t)>>>16,(65280&t)>>>8,255&t]},Dt=function(e,t){var i,r,n,a,s,o;for(t+=20+16*(a=e.samples||[]).length,n=Ut(a,t),(r=new Uint8Array(n.length+16*a.length)).set(n),i=n.length,o=0;o<a.length;o++)s=a[o],r[i++]=(4278190080&s.duration)>>>24,r[i++]=(16711680&s.duration)>>>16,r[i++]=(65280&s.duration)>>>8,r[i++]=255&s.duration,r[i++]=(4278190080&s.size)>>>24,r[i++]=(16711680&s.size)>>>16,r[i++]=(65280&s.size)>>>8,r[i++]=255&s.size,r[i++]=s.flags.isLeading<<2|s.flags.dependsOn,r[i++]=s.flags.isDependedOn<<6|s.flags.hasRedundancy<<4|s.flags.paddingValue<<1|s.flags.isNonSyncSample,r[i++]=61440&s.flags.degradationPriority,r[i++]=15&s.flags.degradationPriority,r[i++]=(4278190080&s.compositionTimeOffset)>>>24,r[i++]=(16711680&s.compositionTimeOffset)>>>16,r[i++]=(65280&s.compositionTimeOffset)>>>8,r[i++]=255&s.compositionTimeOffset;return Ye(yt.trun,r)},xt=function(e,t){var i,r,n,a,s,o;for(t+=20+8*(a=e.samples||[]).length,n=Ut(a,t),(i=new Uint8Array(n.length+8*a.length)).set(n),r=n.length,o=0;o<a.length;o++)s=a[o],i[r++]=(4278190080&s.duration)>>>24,i[r++]=(16711680&s.duration)>>>16,i[r++]=(65280&s.duration)>>>8,i[r++]=255&s.duration,i[r++]=(4278190080&s.size)>>>24,i[r++]=(16711680&s.size)>>>16,i[r++]=(65280&s.size)>>>8,i[r++]=255&s.size;return Ye(yt.trun,i)},mt=function(e,t){return"audio"===e.type?xt(e,t):Dt(e,t)};var Bt,Vt,jt,zt,qt,Gt,Ht={ftyp:Je=function(){return Ye(yt.ftyp,vt,bt,vt,wt)},mdat:function(e){return Ye(yt.mdat,e)},moof:it,moov:rt,initSegment:function(e){var t,i=Je(),r=rt(e);return(t=new Uint8Array(i.byteLength+r.byteLength)).set(i),t.set(r,i.byteLength),t}},Wt=function(e){return e>>>0},$t=function(e){var t="";return t+=String.fromCharCode(e[0]),t+=String.fromCharCode(e[1]),t+=String.fromCharCode(e[2]),t+=String.fromCharCode(e[3])},Xt=Wt,Qt=$t,Yt=function e(t,i){var r,n,a,s,o,l=[];if(!i.length)return null;for(r=0;r<t.byteLength;)n=Xt(t[r]<<24|t[r+1]<<16|t[r+2]<<8|t[r+3]),a=Qt(t.subarray(r+4,r+8)),s=n>1?r+n:t.byteLength,a===i[0]&&(1===i.length?l.push(t.subarray(r+8,s)):(o=e(t.subarray(r+8,s),i.slice(1))).length&&(l=l.concat(o))),r=s;return l},Kt=function(e){var t,i=new DataView(e.buffer,e.byteOffset,e.byteLength),r={version:e[0],flags:new Uint8Array(e.subarray(1,4)),trackId:i.getUint32(4)},n=1&r.flags[2],a=2&r.flags[2],s=8&r.flags[2],o=16&r.flags[2],l=32&r.flags[2],d=65536&r.flags[0],h=131072&r.flags[0];return t=8,n&&(t+=4,r.baseDataOffset=i.getUint32(12),t+=4),a&&(r.sampleDescriptionIndex=i.getUint32(t),t+=4),s&&(r.defaultSampleDuration=i.getUint32(t),t+=4),o&&(r.defaultSampleSize=i.getUint32(t),t+=4),l&&(r.defaultSampleFlags=i.getUint32(t)),d&&(r.durationIsEmpty=!0),!n&&h&&(r.baseDataOffsetIsMoof=!0),r},Zt=function(e){return{isLeading:(12&e[0])>>>2,dependsOn:3&e[0],isDependedOn:(192&e[1])>>>6,hasRedundancy:(48&e[1])>>>4,paddingValue:(14&e[1])>>>1,isNonSyncSample:1&e[1],degradationPriority:e[2]<<8|e[3]}},Jt=function(e){var t,i={version:e[0],flags:new Uint8Array(e.subarray(1,4)),samples:[]},r=new DataView(e.buffer,e.byteOffset,e.byteLength),n=1&i.flags[2],a=4&i.flags[2],s=1&i.flags[1],o=2&i.flags[1],l=4&i.flags[1],d=8&i.flags[1],h=r.getUint32(4),u=8;for(n&&(i.dataOffset=r.getInt32(u),u+=4),a&&h&&(t={flags:Zt(e.subarray(u,u+4))},u+=4,s&&(t.duration=r.getUint32(u),u+=4),o&&(t.size=r.getUint32(u),u+=4),d&&(1===i.version?t.compositionTimeOffset=r.getInt32(u):t.compositionTimeOffset=r.getUint32(u),u+=4),i.samples.push(t),h--);h--;)t={},s&&(t.duration=r.getUint32(u),u+=4),o&&(t.size=r.getUint32(u),u+=4),l&&(t.flags=Zt(e.subarray(u,u+4)),u+=4),d&&(1===i.version?t.compositionTimeOffset=r.getInt32(u):t.compositionTimeOffset=r.getUint32(u),u+=4),i.samples.push(t);return i},ei=Wt,ti=function(e){var t={version:e[0],flags:new Uint8Array(e.subarray(1,4)),baseMediaDecodeTime:ei(e[4]<<24|e[5]<<16|e[6]<<8|e[7])};return 1===t.version&&(t.baseMediaDecodeTime*=Math.pow(2,32),t.baseMediaDecodeTime+=ei(e[8]<<24|e[9]<<16|e[10]<<8|e[11])),t},ii=Wt,ri=function(e){return("00"+e.toString(16)).slice(-2)},ni=Yt,ai=$t,si=Kt,oi=Jt,li=ti;Bt=function(e){return ni(e,["moov","trak"]).reduce((function(e,t){var i,r,n,a,s;return(i=ni(t,["tkhd"])[0])?(r=i[0],a=ii(i[n=0===r?12:20]<<24|i[n+1]<<16|i[n+2]<<8|i[n+3]),(s=ni(t,["mdia","mdhd"])[0])?(n=0===(r=s[0])?12:20,e[a]=ii(s[n]<<24|s[n+1]<<16|s[n+2]<<8|s[n+3]),e):null):null}),{})},Vt=function(e,t){var i,r,n;return i=ni(t,["moof","traf"]),r=[].concat.apply([],i.map((function(t){return ni(t,["tfhd"]).map((function(i){var r,n,a;return r=ii(i[4]<<24|i[5]<<16|i[6]<<8|i[7]),n=e[r]||9e4,(a="number"!=typeof(a=ni(t,["tfdt"]).map((function(e){var t,i;return t=e[0],i=ii(e[4]<<24|e[5]<<16|e[6]<<8|e[7]),1===t&&(i*=Math.pow(2,32),i+=ii(e[8]<<24|e[9]<<16|e[10]<<8|e[11])),i}))[0])||isNaN(a)?1/0:a)/n}))}))),n=Math.min.apply(null,r),isFinite(n)?n:0},jt=function(e,t){var i,r=ni(t,["moof","traf"]),n=0,a=0;if(r&&r.length){var s=ni(r[0],["tfhd"])[0],o=ni(r[0],["trun"])[0],l=ni(r[0],["tfdt"])[0];if(s)i=si(s).trackId;if(l)n=li(l).baseMediaDecodeTime;if(o){var d=oi(o);d.samples&&d.samples.length&&(a=d.samples[0].compositionTimeOffset||0)}}return(n+a)/(e[i]||9e4)},zt=function(e){var t=ni(e,["moov","trak"]),i=[];return t.forEach((function(e){var t=ni(e,["mdia","hdlr"]),r=ni(e,["tkhd"]);t.forEach((function(e,t){var n,a,s=ai(e.subarray(8,12)),o=r[t];"vide"===s&&(a=0===(n=new DataView(o.buffer,o.byteOffset,o.byteLength)).getUint8(0)?n.getUint32(12):n.getUint32(20),i.push(a))}))})),i},qt=function(e){var t=ni(e,["moov","trak"]),i=[];return t.forEach((function(e){var t,r,n={},a=ni(e,["tkhd"])[0];a&&(r=(t=new DataView(a.buffer,a.byteOffset,a.byteLength)).getUint8(0),n.id=0===r?t.getUint32(12):t.getUint32(20));var s=ni(e,["mdia","hdlr"])[0];if(s){var o=ai(s.subarray(8,12));n.type="vide"===o?"video":"soun"===o?"audio":o}var l=ni(e,["mdia","minf","stbl","stsd"])[0];if(l){var d=l.subarray(8);n.codec=ai(d.subarray(4,8));var h,u=ni(d,[n.codec])[0];u&&(/^[asm]vc[1-9]$/i.test(n.codec)?(h=u.subarray(78),"avcC"===ai(h.subarray(4,8))&&h.length>11?(n.codec+=".",n.codec+=ri(h[9]),n.codec+=ri(h[10]),n.codec+=ri(h[11])):n.codec="avc1.4d400d"):/^mp4[a,v]$/i.test(n.codec)?(h=u.subarray(28),"esds"===ai(h.subarray(4,8))&&h.length>20&&0!==h[19]?(n.codec+="."+ri(h[19]),n.codec+="."+ri(h[20]>>>2&63).replace(/^0/,"")):n.codec="mp4a.40.2"):n.codec=n.codec.toLowerCase())}var c=ni(e,["mdia","mdhd"])[0];c&&(n.timescale=Gt(c)),i.push(n)})),i};var di,hi={findBox:ni,parseType:ai,timescale:Bt,startTime:Vt,compositionStartTime:jt,videoTrackIds:zt,tracks:qt,getTimescaleFromMediaHeader:Gt=function(e){var t=0===e[0]?12:20;return ii(e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3])}},ui=function(e,t){var i={size:0,flags:{isLeading:0,dependsOn:1,isDependedOn:0,hasRedundancy:0,degradationPriority:0,isNonSyncSample:1}};return i.dataOffset=t,i.compositionTimeOffset=e.pts-e.dts,i.duration=e.duration,i.size=4*e.length,i.size+=e.byteLength,e.keyFrame&&(i.flags.dependsOn=2,i.flags.isNonSyncSample=0),i},ci={groupNalsIntoFrames:function(e){var t,i,r=[],n=[];for(n.byteLength=0,n.nalCount=0,n.duration=0,r.byteLength=0,t=0;t<e.length;t++)"access_unit_delimiter_rbsp"===(i=e[t]).nalUnitType?(r.length&&(r.duration=i.dts-r.dts,n.byteLength+=r.byteLength,n.nalCount+=r.length,n.duration+=r.duration,n.push(r)),(r=[i]).byteLength=i.data.byteLength,r.pts=i.pts,r.dts=i.dts):("slice_layer_without_partitioning_rbsp_idr"===i.nalUnitType&&(r.keyFrame=!0),r.duration=i.dts-r.dts,r.byteLength+=i.data.byteLength,r.push(i));return n.length&&(!r.duration||r.duration<=0)&&(r.duration=n[n.length-1].duration),n.byteLength+=r.byteLength,n.nalCount+=r.length,n.duration+=r.duration,n.push(r),n},groupFramesIntoGops:function(e){var t,i,r=[],n=[];for(r.byteLength=0,r.nalCount=0,r.duration=0,r.pts=e[0].pts,r.dts=e[0].dts,n.byteLength=0,n.nalCount=0,n.duration=0,n.pts=e[0].pts,n.dts=e[0].dts,t=0;t<e.length;t++)(i=e[t]).keyFrame?(r.length&&(n.push(r),n.byteLength+=r.byteLength,n.nalCount+=r.nalCount,n.duration+=r.duration),(r=[i]).nalCount=i.length,r.byteLength=i.byteLength,r.pts=i.pts,r.dts=i.dts,r.duration=i.duration):(r.duration+=i.duration,r.nalCount+=i.length,r.byteLength+=i.byteLength,r.push(i));return n.length&&r.duration<=0&&(r.duration=n[n.length-1].duration),n.byteLength+=r.byteLength,n.nalCount+=r.nalCount,n.duration+=r.duration,n.push(r),n},extendFirstKeyFrame:function(e){var t;return!e[0][0].keyFrame&&e.length>1&&(t=e.shift(),e.byteLength-=t.byteLength,e.nalCount-=t.nalCount,e[0][0].dts=t.dts,e[0][0].pts=t.pts,e[0][0].duration+=t.duration),e},generateSampleTable:function(e,t){var i,r,n,a,s,o=t||0,l=[];for(i=0;i<e.length;i++)for(a=e[i],r=0;r<a.length;r++)s=a[r],o+=(n=ui(s,o)).size,l.push(n);return l},concatenateNalData:function(e){var t,i,r,n,a,s,o=0,l=e.byteLength,d=e.nalCount,h=new Uint8Array(l+4*d),u=new DataView(h.buffer);for(t=0;t<e.length;t++)for(n=e[t],i=0;i<n.length;i++)for(a=n[i],r=0;r<a.length;r++)s=a[r],u.setUint32(o,s.data.byteLength),o+=4,h.set(s.data,o),o+=s.data.byteLength;return h},generateSampleTableForFrame:function(e,t){var i,r=[];return i=ui(e,t||0),r.push(i),r},concatenateNalDataForFrame:function(e){var t,i,r=0,n=e.byteLength,a=e.length,s=new Uint8Array(n+4*a),o=new DataView(s.buffer);for(t=0;t<e.length;t++)i=e[t],o.setUint32(r,i.data.byteLength),r+=4,s.set(i.data,r),r+=i.data.byteLength;return s}},pi=[33,16,5,32,164,27],fi=[33,65,108,84,1,2,4,8,168,2,4,8,17,191,252],gi=function(e){for(var t=[];e--;)t.push(0);return t},mi=function(){if(!di){var e={96e3:[pi,[227,64],gi(154),[56]],88200:[pi,[231],gi(170),[56]],64e3:[pi,[248,192],gi(240),[56]],48e3:[pi,[255,192],gi(268),[55,148,128],gi(54),[112]],44100:[pi,[255,192],gi(268),[55,163,128],gi(84),[112]],32e3:[pi,[255,192],gi(268),[55,234],gi(226),[112]],24e3:[pi,[255,192],gi(268),[55,255,128],gi(268),[111,112],gi(126),[224]],16e3:[pi,[255,192],gi(268),[55,255,128],gi(268),[111,255],gi(269),[223,108],gi(195),[1,192]],12e3:[fi,gi(268),[3,127,248],gi(268),[6,255,240],gi(268),[13,255,224],gi(268),[27,253,128],gi(259),[56]],11025:[fi,gi(268),[3,127,248],gi(268),[6,255,240],gi(268),[13,255,224],gi(268),[27,255,192],gi(268),[55,175,128],gi(108),[112]],8e3:[fi,gi(268),[3,121,16],gi(47),[7]]};t=e,di=Object.keys(t).reduce((function(e,i){return e[i]=new Uint8Array(t[i].reduce((function(e,t){return e.concat(t)}),[])),e}),{})}var t;return di},yi=je,vi={prefixWithSilence:function(e,t,i,r){var n,a,s,o,l,d=0,h=0,u=0;if(t.length&&(n=yi.audioTsToVideoTs(e.baseMediaDecodeTime,e.samplerate),a=Math.ceil(yi.ONE_SECOND_IN_TS/(e.samplerate/1024)),i&&r&&(d=n-Math.max(i,r),u=(h=Math.floor(d/a))*a),!(h<1||u>yi.ONE_SECOND_IN_TS/2))){for((s=mi()[e.samplerate])||(s=t[0].data),o=0;o<h;o++)l=t[0],t.splice(0,0,{data:s,dts:l.dts-a,pts:l.pts-a});return e.baseMediaDecodeTime-=Math.floor(yi.videoTsToAudioTs(u,e.samplerate)),u}},trimAdtsFramesByEarliestDts:function(e,t,i){return t.minSegmentDts>=i?e:(t.minSegmentDts=1/0,e.filter((function(e){return e.dts>=i&&(t.minSegmentDts=Math.min(t.minSegmentDts,e.dts),t.minSegmentPts=t.minSegmentDts,!0)})))},generateSampleTable:function(e){var t,i,r=[];for(t=0;t<e.length;t++)i=e[t],r.push({size:i.data.byteLength,duration:1024});return r},concatenateFrameData:function(e){var t,i,r=0,n=new Uint8Array(function(e){var t,i=0;for(t=0;t<e.length;t++)i+=e[t].data.byteLength;return i}(e));for(t=0;t<e.length;t++)i=e[t],n.set(i.data,r),r+=i.data.byteLength;return n}},bi=je.ONE_SECOND_IN_TS,wi={clearDtsInfo:function(e){delete e.minSegmentDts,delete e.maxSegmentDts,delete e.minSegmentPts,delete e.maxSegmentPts},calculateTrackBaseMediaDecodeTime:function(e,t){var i,r=e.minSegmentDts;return t||(r-=e.timelineStartInfo.dts),i=e.timelineStartInfo.baseMediaDecodeTime,i+=r,i=Math.max(0,i),"audio"===e.type&&(i*=e.samplerate/bi,i=Math.floor(i)),i},collectDtsInfo:function(e,t){"number"==typeof t.pts&&(void 0===e.timelineStartInfo.pts&&(e.timelineStartInfo.pts=t.pts),void 0===e.minSegmentPts?e.minSegmentPts=t.pts:e.minSegmentPts=Math.min(e.minSegmentPts,t.pts),void 0===e.maxSegmentPts?e.maxSegmentPts=t.pts:e.maxSegmentPts=Math.max(e.maxSegmentPts,t.pts)),"number"==typeof t.dts&&(void 0===e.timelineStartInfo.dts&&(e.timelineStartInfo.dts=t.dts),void 0===e.minSegmentDts?e.minSegmentDts=t.dts:e.minSegmentDts=Math.min(e.minSegmentDts,t.dts),void 0===e.maxSegmentDts?e.maxSegmentDts=t.dts:e.maxSegmentDts=Math.max(e.maxSegmentDts,t.dts))}},Si={parseSei:function(e){for(var t=0,i={payloadType:-1,payloadSize:0},r=0,n=0;t<e.byteLength&&128!==e[t];){for(;255===e[t];)r+=255,t++;for(r+=e[t++];255===e[t];)n+=255,t++;if(n+=e[t++],!i.payload&&4===r){if("GA94"===String.fromCharCode(e[t+3],e[t+4],e[t+5],e[t+6])){i.payloadType=r,i.payloadSize=n,i.payload=e.subarray(t,t+n);break}i.payload=void 0}t+=n,r=0,n=0}return i},parseUserData:function(e){return 181!==e.payload[0]||49!=(e.payload[1]<<8|e.payload[2])||"GA94"!==String.fromCharCode(e.payload[3],e.payload[4],e.payload[5],e.payload[6])||3!==e.payload[7]?null:e.payload.subarray(8,e.payload.length-1)},parseCaptionPackets:function(e,t){var i,r,n,a,s=[];if(!(64&t[0]))return s;for(r=31&t[0],i=0;i<r;i++)a={type:3&t[(n=3*i)+2],pts:e},4&t[n+2]&&(a.ccData=t[n+3]<<8|t[n+4],s.push(a));return s},discardEmulationPreventionBytes:function(e){for(var t,i,r=e.byteLength,n=[],a=1;a<r-2;)0===e[a]&&0===e[a+1]&&3===e[a+2]?(n.push(a+2),a+=2):a++;if(0===n.length)return e;t=r-n.length,i=new Uint8Array(t);var s=0;for(a=0;a<t;s++,a++)s===n[0]&&(s++,n.shift()),i[a]=e[s];return i},USER_DATA_REGISTERED_ITU_T_T35:4},Ti=Fe,Ei=Si,_i=function e(t){t=t||{},e.prototype.init.call(this),this.parse708captions_="boolean"!=typeof t.parse708captions||t.parse708captions,this.captionPackets_=[],this.ccStreams_=[new Di(0,0),new Di(0,1),new Di(1,0),new Di(1,1)],this.parse708captions_&&(this.cc708Stream_=new Oi({captionServices:t.captionServices})),this.reset(),this.ccStreams_.forEach((function(e){e.on("data",this.trigger.bind(this,"data")),e.on("partialdone",this.trigger.bind(this,"partialdone")),e.on("done",this.trigger.bind(this,"done"))}),this),this.parse708captions_&&(this.cc708Stream_.on("data",this.trigger.bind(this,"data")),this.cc708Stream_.on("partialdone",this.trigger.bind(this,"partialdone")),this.cc708Stream_.on("done",this.trigger.bind(this,"done")))};(_i.prototype=new Ti).push=function(e){var t,i,r;if("sei_rbsp"===e.nalUnitType&&(t=Ei.parseSei(e.escapedRBSP)).payload&&t.payloadType===Ei.USER_DATA_REGISTERED_ITU_T_T35&&(i=Ei.parseUserData(t)))if(e.dts<this.latestDts_)this.ignoreNextEqualDts_=!0;else{if(e.dts===this.latestDts_&&this.ignoreNextEqualDts_)return this.numSameDts_--,void(this.numSameDts_||(this.ignoreNextEqualDts_=!1));r=Ei.parseCaptionPackets(e.pts,i),this.captionPackets_=this.captionPackets_.concat(r),this.latestDts_!==e.dts&&(this.numSameDts_=0),this.numSameDts_++,this.latestDts_=e.dts}},_i.prototype.flushCCStreams=function(e){this.ccStreams_.forEach((function(t){return"flush"===e?t.flush():t.partialFlush()}),this)},_i.prototype.flushStream=function(e){this.captionPackets_.length?(this.captionPackets_.forEach((function(e,t){e.presortIndex=t})),this.captionPackets_.sort((function(e,t){return e.pts===t.pts?e.presortIndex-t.presortIndex:e.pts-t.pts})),this.captionPackets_.forEach((function(e){e.type<2?this.dispatchCea608Packet(e):this.dispatchCea708Packet(e)}),this),this.captionPackets_.length=0,this.flushCCStreams(e)):this.flushCCStreams(e)},_i.prototype.flush=function(){return this.flushStream("flush")},_i.prototype.partialFlush=function(){return this.flushStream("partialFlush")},_i.prototype.reset=function(){this.latestDts_=null,this.ignoreNextEqualDts_=!1,this.numSameDts_=0,this.activeCea608Channel_=[null,null],this.ccStreams_.forEach((function(e){e.reset()}))},_i.prototype.dispatchCea608Packet=function(e){this.setsTextOrXDSActive(e)?this.activeCea608Channel_[e.type]=null:this.setsChannel1Active(e)?this.activeCea608Channel_[e.type]=0:this.setsChannel2Active(e)&&(this.activeCea608Channel_[e.type]=1),null!==this.activeCea608Channel_[e.type]&&this.ccStreams_[(e.type<<1)+this.activeCea608Channel_[e.type]].push(e)},_i.prototype.setsChannel1Active=function(e){return 4096==(30720&e.ccData)},_i.prototype.setsChannel2Active=function(e){return 6144==(30720&e.ccData)},_i.prototype.setsTextOrXDSActive=function(e){return 256==(28928&e.ccData)||4138==(30974&e.ccData)||6186==(30974&e.ccData)},_i.prototype.dispatchCea708Packet=function(e){this.parse708captions_&&this.cc708Stream_.push(e)};var ki={127:9834,4128:32,4129:160,4133:8230,4138:352,4140:338,4144:9608,4145:8216,4146:8217,4147:8220,4148:8221,4149:8226,4153:8482,4154:353,4156:339,4157:8480,4159:376,4214:8539,4215:8540,4216:8541,4217:8542,4218:9168,4219:9124,4220:9123,4221:9135,4222:9126,4223:9121,4256:12600},Pi=function(e){return 32<=e&&e<=127||160<=e&&e<=255},Ai=function(e){this.windowNum=e,this.reset()};Ai.prototype.reset=function(){this.clearText(),this.pendingNewLine=!1,this.winAttr={},this.penAttr={},this.penLoc={},this.penColor={},this.visible=0,this.rowLock=0,this.columnLock=0,this.priority=0,this.relativePositioning=0,this.anchorVertical=0,this.anchorHorizontal=0,this.anchorPoint=0,this.rowCount=1,this.virtualRowCount=this.rowCount+1,this.columnCount=41,this.windowStyle=0,this.penStyle=0},Ai.prototype.getText=function(){return this.rows.join("\n")},Ai.prototype.clearText=function(){this.rows=[""],this.rowIdx=0},Ai.prototype.newLine=function(e){for(this.rows.length>=this.virtualRowCount&&"function"==typeof this.beforeRowOverflow&&this.beforeRowOverflow(e),this.rows.length>0&&(this.rows.push(""),this.rowIdx++);this.rows.length>this.virtualRowCount;)this.rows.shift(),this.rowIdx--},Ai.prototype.isEmpty=function(){return 0===this.rows.length||1===this.rows.length&&""===this.rows[0]},Ai.prototype.addText=function(e){this.rows[this.rowIdx]+=e},Ai.prototype.backspace=function(){if(!this.isEmpty()){var e=this.rows[this.rowIdx];this.rows[this.rowIdx]=e.substr(0,e.length-1)}};var Li=function(e,t,i){this.serviceNum=e,this.text="",this.currentWindow=new Ai(-1),this.windows=[],this.stream=i,"string"==typeof t&&this.createTextDecoder(t)};Li.prototype.init=function(e,t){this.startPts=e;for(var i=0;i<8;i++)this.windows[i]=new Ai(i),"function"==typeof t&&(this.windows[i].beforeRowOverflow=t)},Li.prototype.setCurrentWindow=function(e){this.currentWindow=this.windows[e]},Li.prototype.createTextDecoder=function(e){if("undefined"==typeof TextDecoder)this.stream.trigger("log",{level:"warn",message:"The `encoding` option is unsupported without TextDecoder support"});else try{this.textDecoder_=new TextDecoder(e)}catch(t){this.stream.trigger("log",{level:"warn",message:"TextDecoder could not be created with "+e+" encoding. "+t})}};var Oi=function e(t){t=t||{},e.prototype.init.call(this);var i,r=this,n=t.captionServices||{},a={};Object.keys(n).forEach((function(e){i=n[e],/^SERVICE/.test(e)&&(a[e]=i.encoding)})),this.serviceEncodings=a,this.current708Packet=null,this.services={},this.push=function(e){3===e.type?(r.new708Packet(),r.add708Bytes(e)):(null===r.current708Packet&&r.new708Packet(),r.add708Bytes(e))}};Oi.prototype=new Ti,Oi.prototype.new708Packet=function(){null!==this.current708Packet&&this.push708Packet(),this.current708Packet={data:[],ptsVals:[]}},Oi.prototype.add708Bytes=function(e){var t=e.ccData,i=t>>>8,r=255&t;this.current708Packet.ptsVals.push(e.pts),this.current708Packet.data.push(i),this.current708Packet.data.push(r)},Oi.prototype.push708Packet=function(){var e=this.current708Packet,t=e.data,i=null,r=null,n=0,a=t[n++];for(e.seq=a>>6,e.sizeCode=63&a;n<t.length;n++)r=31&(a=t[n++]),7===(i=a>>5)&&r>0&&(i=a=t[n++]),this.pushServiceBlock(i,n,r),r>0&&(n+=r-1)},Oi.prototype.pushServiceBlock=function(e,t,i){var r,n=t,a=this.current708Packet.data,s=this.services[e];for(s||(s=this.initService(e,n));n<t+i&&n<a.length;n++)r=a[n],Pi(r)?n=this.handleText(n,s):24===r?n=this.multiByteCharacter(n,s):16===r?n=this.extendedCommands(n,s):128<=r&&r<=135?n=this.setCurrentWindow(n,s):152<=r&&r<=159?n=this.defineWindow(n,s):136===r?n=this.clearWindows(n,s):140===r?n=this.deleteWindows(n,s):137===r?n=this.displayWindows(n,s):138===r?n=this.hideWindows(n,s):139===r?n=this.toggleWindows(n,s):151===r?n=this.setWindowAttributes(n,s):144===r?n=this.setPenAttributes(n,s):145===r?n=this.setPenColor(n,s):146===r?n=this.setPenLocation(n,s):143===r?s=this.reset(n,s):8===r?s.currentWindow.backspace():12===r?s.currentWindow.clearText():13===r?s.currentWindow.pendingNewLine=!0:14===r?s.currentWindow.clearText():141===r&&n++},Oi.prototype.extendedCommands=function(e,t){var i=this.current708Packet.data[++e];return Pi(i)&&(e=this.handleText(e,t,{isExtended:!0})),e},Oi.prototype.getPts=function(e){return this.current708Packet.ptsVals[Math.floor(e/2)]},Oi.prototype.initService=function(e,t){var i,r,n=this;return(i="SERVICE"+e)in this.serviceEncodings&&(r=this.serviceEncodings[i]),this.services[e]=new Li(e,r,n),this.services[e].init(this.getPts(t),(function(t){n.flushDisplayed(t,n.services[e])})),this.services[e]},Oi.prototype.handleText=function(e,t,i){var r,n,a,s,o=i&&i.isExtended,l=i&&i.isMultiByte,d=this.current708Packet.data,h=o?4096:0,u=d[e],c=d[e+1],p=t.currentWindow;return t.textDecoder_&&!o?(l?(n=[u,c],e++):n=[u],r=t.textDecoder_.decode(new Uint8Array(n))):(s=ki[a=h|u]||a,r=4096&a&&a===s?"":String.fromCharCode(s)),p.pendingNewLine&&!p.isEmpty()&&p.newLine(this.getPts(e)),p.pendingNewLine=!1,p.addText(r),e},Oi.prototype.multiByteCharacter=function(e,t){var i=this.current708Packet.data,r=i[e+1],n=i[e+2];return Pi(r)&&Pi(n)&&(e=this.handleText(++e,t,{isMultiByte:!0})),e},Oi.prototype.setCurrentWindow=function(e,t){var i=7&this.current708Packet.data[e];return t.setCurrentWindow(i),e},Oi.prototype.defineWindow=function(e,t){var i=this.current708Packet.data,r=i[e],n=7&r;t.setCurrentWindow(n);var a=t.currentWindow;return r=i[++e],a.visible=(32&r)>>5,a.rowLock=(16&r)>>4,a.columnLock=(8&r)>>3,a.priority=7&r,r=i[++e],a.relativePositioning=(128&r)>>7,a.anchorVertical=127&r,r=i[++e],a.anchorHorizontal=r,r=i[++e],a.anchorPoint=(240&r)>>4,a.rowCount=15&r,r=i[++e],a.columnCount=63&r,r=i[++e],a.windowStyle=(56&r)>>3,a.penStyle=7&r,a.virtualRowCount=a.rowCount+1,e},Oi.prototype.setWindowAttributes=function(e,t){var i=this.current708Packet.data,r=i[e],n=t.currentWindow.winAttr;return r=i[++e],n.fillOpacity=(192&r)>>6,n.fillRed=(48&r)>>4,n.fillGreen=(12&r)>>2,n.fillBlue=3&r,r=i[++e],n.borderType=(192&r)>>6,n.borderRed=(48&r)>>4,n.borderGreen=(12&r)>>2,n.borderBlue=3&r,r=i[++e],n.borderType+=(128&r)>>5,n.wordWrap=(64&r)>>6,n.printDirection=(48&r)>>4,n.scrollDirection=(12&r)>>2,n.justify=3&r,r=i[++e],n.effectSpeed=(240&r)>>4,n.effectDirection=(12&r)>>2,n.displayEffect=3&r,e},Oi.prototype.flushDisplayed=function(e,t){for(var i=[],r=0;r<8;r++)t.windows[r].visible&&!t.windows[r].isEmpty()&&i.push(t.windows[r].getText());t.endPts=e,t.text=i.join("\n\n"),this.pushCaption(t),t.startPts=e},Oi.prototype.pushCaption=function(e){""!==e.text&&(this.trigger("data",{startPts:e.startPts,endPts:e.endPts,text:e.text,stream:"cc708_"+e.serviceNum}),e.text="",e.startPts=e.endPts)},Oi.prototype.displayWindows=function(e,t){var i=this.current708Packet.data[++e],r=this.getPts(e);this.flushDisplayed(r,t);for(var n=0;n<8;n++)i&1<<n&&(t.windows[n].visible=1);return e},Oi.prototype.hideWindows=function(e,t){var i=this.current708Packet.data[++e],r=this.getPts(e);this.flushDisplayed(r,t);for(var n=0;n<8;n++)i&1<<n&&(t.windows[n].visible=0);return e},Oi.prototype.toggleWindows=function(e,t){var i=this.current708Packet.data[++e],r=this.getPts(e);this.flushDisplayed(r,t);for(var n=0;n<8;n++)i&1<<n&&(t.windows[n].visible^=1);return e},Oi.prototype.clearWindows=function(e,t){var i=this.current708Packet.data[++e],r=this.getPts(e);this.flushDisplayed(r,t);for(var n=0;n<8;n++)i&1<<n&&t.windows[n].clearText();return e},Oi.prototype.deleteWindows=function(e,t){var i=this.current708Packet.data[++e],r=this.getPts(e);this.flushDisplayed(r,t);for(var n=0;n<8;n++)i&1<<n&&t.windows[n].reset();return e},Oi.prototype.setPenAttributes=function(e,t){var i=this.current708Packet.data,r=i[e],n=t.currentWindow.penAttr;return r=i[++e],n.textTag=(240&r)>>4,n.offset=(12&r)>>2,n.penSize=3&r,r=i[++e],n.italics=(128&r)>>7,n.underline=(64&r)>>6,n.edgeType=(56&r)>>3,n.fontStyle=7&r,e},Oi.prototype.setPenColor=function(e,t){var i=this.current708Packet.data,r=i[e],n=t.currentWindow.penColor;return r=i[++e],n.fgOpacity=(192&r)>>6,n.fgRed=(48&r)>>4,n.fgGreen=(12&r)>>2,n.fgBlue=3&r,r=i[++e],n.bgOpacity=(192&r)>>6,n.bgRed=(48&r)>>4,n.bgGreen=(12&r)>>2,n.bgBlue=3&r,r=i[++e],n.edgeRed=(48&r)>>4,n.edgeGreen=(12&r)>>2,n.edgeBlue=3&r,e},Oi.prototype.setPenLocation=function(e,t){var i=this.current708Packet.data,r=i[e],n=t.currentWindow.penLoc;return t.currentWindow.pendingNewLine=!0,r=i[++e],n.row=15&r,r=i[++e],n.column=63&r,e},Oi.prototype.reset=function(e,t){var i=this.getPts(e);return this.flushDisplayed(i,t),this.initService(t.serviceNum,e)};var Ci={42:225,92:233,94:237,95:243,96:250,123:231,124:247,125:209,126:241,127:9608,304:174,305:176,306:189,307:191,308:8482,309:162,310:163,311:9834,312:224,313:160,314:232,315:226,316:234,317:238,318:244,319:251,544:193,545:201,546:211,547:218,548:220,549:252,550:8216,551:161,552:42,553:39,554:8212,555:169,556:8480,557:8226,558:8220,559:8221,560:192,561:194,562:199,563:200,564:202,565:203,566:235,567:206,568:207,569:239,570:212,571:217,572:249,573:219,574:171,575:187,800:195,801:227,802:205,803:204,804:236,805:210,806:242,807:213,808:245,809:123,810:125,811:92,812:94,813:95,814:124,815:126,816:196,817:228,818:214,819:246,820:223,821:165,822:164,823:9474,824:197,825:229,826:216,827:248,828:9484,829:9488,830:9492,831:9496},Ri=function(e){return null===e?"":(e=Ci[e]||e,String.fromCharCode(e))},Ii=[4352,4384,4608,4640,5376,5408,5632,5664,5888,5920,4096,4864,4896,5120,5152],xi=function(){for(var e=[],t=15;t--;)e.push("");return e},Di=function e(t,i){e.prototype.init.call(this),this.field_=t||0,this.dataChannel_=i||0,this.name_="CC"+(1+(this.field_<<1|this.dataChannel_)),this.setConstants(),this.reset(),this.push=function(e){var t,i,r,n,a;if((t=32639&e.ccData)!==this.lastControlCode_){if(4096==(61440&t)?this.lastControlCode_=t:t!==this.PADDING_&&(this.lastControlCode_=null),r=t>>>8,n=255&t,t!==this.PADDING_)if(t===this.RESUME_CAPTION_LOADING_)this.mode_="popOn";else if(t===this.END_OF_CAPTION_)this.mode_="popOn",this.clearFormatting(e.pts),this.flushDisplayed(e.pts),i=this.displayed_,this.displayed_=this.nonDisplayed_,this.nonDisplayed_=i,this.startPts_=e.pts;else if(t===this.ROLL_UP_2_ROWS_)this.rollUpRows_=2,this.setRollUp(e.pts);else if(t===this.ROLL_UP_3_ROWS_)this.rollUpRows_=3,this.setRollUp(e.pts);else if(t===this.ROLL_UP_4_ROWS_)this.rollUpRows_=4,this.setRollUp(e.pts);else if(t===this.CARRIAGE_RETURN_)this.clearFormatting(e.pts),this.flushDisplayed(e.pts),this.shiftRowsUp_(),this.startPts_=e.pts;else if(t===this.BACKSPACE_)"popOn"===this.mode_?this.nonDisplayed_[this.row_]=this.nonDisplayed_[this.row_].slice(0,-1):this.displayed_[this.row_]=this.displayed_[this.row_].slice(0,-1);else if(t===this.ERASE_DISPLAYED_MEMORY_)this.flushDisplayed(e.pts),this.displayed_=xi();else if(t===this.ERASE_NON_DISPLAYED_MEMORY_)this.nonDisplayed_=xi();else if(t===this.RESUME_DIRECT_CAPTIONING_)"paintOn"!==this.mode_&&(this.flushDisplayed(e.pts),this.displayed_=xi()),this.mode_="paintOn",this.startPts_=e.pts;else if(this.isSpecialCharacter(r,n))a=Ri((r=(3&r)<<8)|n),this[this.mode_](e.pts,a),this.column_++;else if(this.isExtCharacter(r,n))"popOn"===this.mode_?this.nonDisplayed_[this.row_]=this.nonDisplayed_[this.row_].slice(0,-1):this.displayed_[this.row_]=this.displayed_[this.row_].slice(0,-1),a=Ri((r=(3&r)<<8)|n),this[this.mode_](e.pts,a),this.column_++;else if(this.isMidRowCode(r,n))this.clearFormatting(e.pts),this[this.mode_](e.pts," "),this.column_++,14==(14&n)&&this.addFormatting(e.pts,["i"]),1==(1&n)&&this.addFormatting(e.pts,["u"]);else if(this.isOffsetControlCode(r,n))this.column_+=3&n;else if(this.isPAC(r,n)){var s=Ii.indexOf(7968&t);"rollUp"===this.mode_&&(s-this.rollUpRows_+1<0&&(s=this.rollUpRows_-1),this.setRollUp(e.pts,s)),s!==this.row_&&(this.clearFormatting(e.pts),this.row_=s),1&n&&-1===this.formatting_.indexOf("u")&&this.addFormatting(e.pts,["u"]),16==(16&t)&&(this.column_=4*((14&t)>>1)),this.isColorPAC(n)&&14==(14&n)&&this.addFormatting(e.pts,["i"])}else this.isNormalChar(r)&&(0===n&&(n=null),a=Ri(r),a+=Ri(n),this[this.mode_](e.pts,a),this.column_+=a.length)}else this.lastControlCode_=null}};Di.prototype=new Ti,Di.prototype.flushDisplayed=function(e){var t=this.displayed_.map((function(e,t){try{return e.trim()}catch(i){return this.trigger("log",{level:"warn",message:"Skipping a malformed 608 caption at index "+t+"."}),""}}),this).join("\n").replace(/^\n+|\n+$/g,"");t.length&&this.trigger("data",{startPts:this.startPts_,endPts:e,text:t,stream:this.name_})},Di.prototype.reset=function(){this.mode_="popOn",this.topRow_=0,this.startPts_=0,this.displayed_=xi(),this.nonDisplayed_=xi(),this.lastControlCode_=null,this.column_=0,this.row_=14,this.rollUpRows_=2,this.formatting_=[]},Di.prototype.setConstants=function(){0===this.dataChannel_?(this.BASE_=16,this.EXT_=17,this.CONTROL_=(20|this.field_)<<8,this.OFFSET_=23):1===this.dataChannel_&&(this.BASE_=24,this.EXT_=25,this.CONTROL_=(28|this.field_)<<8,this.OFFSET_=31),this.PADDING_=0,this.RESUME_CAPTION_LOADING_=32|this.CONTROL_,this.END_OF_CAPTION_=47|this.CONTROL_,this.ROLL_UP_2_ROWS_=37|this.CONTROL_,this.ROLL_UP_3_ROWS_=38|this.CONTROL_,this.ROLL_UP_4_ROWS_=39|this.CONTROL_,this.CARRIAGE_RETURN_=45|this.CONTROL_,this.RESUME_DIRECT_CAPTIONING_=41|this.CONTROL_,this.BACKSPACE_=33|this.CONTROL_,this.ERASE_DISPLAYED_MEMORY_=44|this.CONTROL_,this.ERASE_NON_DISPLAYED_MEMORY_=46|this.CONTROL_},Di.prototype.isSpecialCharacter=function(e,t){return e===this.EXT_&&t>=48&&t<=63},Di.prototype.isExtCharacter=function(e,t){return(e===this.EXT_+1||e===this.EXT_+2)&&t>=32&&t<=63},Di.prototype.isMidRowCode=function(e,t){return e===this.EXT_&&t>=32&&t<=47},Di.prototype.isOffsetControlCode=function(e,t){return e===this.OFFSET_&&t>=33&&t<=35},Di.prototype.isPAC=function(e,t){return e>=this.BASE_&&e<this.BASE_+8&&t>=64&&t<=127},Di.prototype.isColorPAC=function(e){return e>=64&&e<=79||e>=96&&e<=127},Di.prototype.isNormalChar=function(e){return e>=32&&e<=127},Di.prototype.setRollUp=function(e,t){if("rollUp"!==this.mode_&&(this.row_=14,this.mode_="rollUp",this.flushDisplayed(e),this.nonDisplayed_=xi(),this.displayed_=xi()),void 0!==t&&t!==this.row_)for(var i=0;i<this.rollUpRows_;i++)this.displayed_[t-i]=this.displayed_[this.row_-i],this.displayed_[this.row_-i]="";void 0===t&&(t=this.row_),this.topRow_=t-this.rollUpRows_+1},Di.prototype.addFormatting=function(e,t){this.formatting_=this.formatting_.concat(t);var i=t.reduce((function(e,t){return e+"<"+t+">"}),"");this[this.mode_](e,i)},Di.prototype.clearFormatting=function(e){if(this.formatting_.length){var t=this.formatting_.reverse().reduce((function(e,t){return e+"</"+t+">"}),"");this.formatting_=[],this[this.mode_](e,t)}},Di.prototype.popOn=function(e,t){var i=this.nonDisplayed_[this.row_];i+=t,this.nonDisplayed_[this.row_]=i},Di.prototype.rollUp=function(e,t){var i=this.displayed_[this.row_];i+=t,this.displayed_[this.row_]=i},Di.prototype.shiftRowsUp_=function(){var e;for(e=0;e<this.topRow_;e++)this.displayed_[e]="";for(e=this.row_+1;e<15;e++)this.displayed_[e]="";for(e=this.topRow_;e<this.row_;e++)this.displayed_[e]=this.displayed_[e+1];this.displayed_[this.row_]=""},Di.prototype.paintOn=function(e,t){var i=this.displayed_[this.row_];i+=t,this.displayed_[this.row_]=i};var Ui={CaptionStream:_i,Cea608Stream:Di,Cea708Stream:Oi},Mi={H264_STREAM_TYPE:27,ADTS_STREAM_TYPE:15,METADATA_STREAM_TYPE:21},Ni="shared",Fi=function(e,t){var i=1;for(e>t&&(i=-1);Math.abs(t-e)>4294967296;)e+=8589934592*i;return e},Bi=function e(t){var i,r;e.prototype.init.call(this),this.type_=t||Ni,this.push=function(e){this.type_!==Ni&&e.type!==this.type_||(void 0===r&&(r=e.dts),e.dts=Fi(e.dts,r),e.pts=Fi(e.pts,r),i=e.dts,this.trigger("data",e))},this.flush=function(){r=i,this.trigger("done")},this.endTimeline=function(){this.flush(),this.trigger("endedtimeline")},this.discontinuity=function(){r=void 0,i=void 0},this.reset=function(){this.discontinuity(),this.trigger("reset")}};Bi.prototype=new Fe;var Vi,ji=Bi,zi=Fi,qi=Mi,Gi=function(e,t,i){var r,n="";for(r=t;r<i;r++)n+="%"+("00"+e[r].toString(16)).slice(-2);return n},Hi=function(e,t,i){return decodeURIComponent(Gi(e,t,i))},Wi=function(e){return e[0]<<21|e[1]<<14|e[2]<<7|e[3]},$i={TXXX:function(e){var t;if(3===e.data[0]){for(t=1;t<e.data.length;t++)if(0===e.data[t]){e.description=Hi(e.data,1,t),e.value=Hi(e.data,t+1,e.data.length).replace(/\0*$/,"");break}e.data=e.value}},WXXX:function(e){var t;if(3===e.data[0])for(t=1;t<e.data.length;t++)if(0===e.data[t]){e.description=Hi(e.data,1,t),e.url=Hi(e.data,t+1,e.data.length);break}},PRIV:function(e){var t,i;for(t=0;t<e.data.length;t++)if(0===e.data[t]){e.owner=(i=e.data,unescape(Gi(i,0,t)));break}e.privateData=e.data.subarray(t+1),e.data=e.privateData}};(Vi=function(e){var t,i={descriptor:e&&e.descriptor},r=0,n=[],a=0;if(Vi.prototype.init.call(this),this.dispatchType=qi.METADATA_STREAM_TYPE.toString(16),i.descriptor)for(t=0;t<i.descriptor.length;t++)this.dispatchType+=("00"+i.descriptor[t].toString(16)).slice(-2);this.push=function(e){var t,i,s,o,l;if("timed-metadata"===e.type)if(e.dataAlignmentIndicator&&(a=0,n.length=0),0===n.length&&(e.data.length<10||e.data[0]!=="I".charCodeAt(0)||e.data[1]!=="D".charCodeAt(0)||e.data[2]!=="3".charCodeAt(0)))this.trigger("log",{level:"warn",message:"Skipping unrecognized metadata packet"});else if(n.push(e),a+=e.data.byteLength,1===n.length&&(r=Wi(e.data.subarray(6,10)),r+=10),!(a<r)){for(t={data:new Uint8Array(r),frames:[],pts:n[0].pts,dts:n[0].dts},l=0;l<r;)t.data.set(n[0].data.subarray(0,r-l),l),l+=n[0].data.byteLength,a-=n[0].data.byteLength,n.shift();i=10,64&t.data[5]&&(i+=4,i+=Wi(t.data.subarray(10,14)),r-=Wi(t.data.subarray(16,20)));do{if((s=Wi(t.data.subarray(i+4,i+8)))<1)return void this.trigger("log",{level:"warn",message:"Malformed ID3 frame encountered. Skipping metadata parsing."});if((o={id:String.fromCharCode(t.data[i],t.data[i+1],t.data[i+2],t.data[i+3]),data:t.data.subarray(i+10,i+s+10)}).key=o.id,$i[o.id]&&($i[o.id](o),"com.apple.streaming.transportStreamTimestamp"===o.owner)){var d=o.data,h=(1&d[3])<<30|d[4]<<22|d[5]<<14|d[6]<<6|d[7]>>>2;h*=4,h+=3&d[7],o.timeStamp=h,void 0===t.pts&&void 0===t.dts&&(t.pts=o.timeStamp,t.dts=o.timeStamp),this.trigger("timestamp",o)}t.frames.push(o),i+=10,i+=s}while(i<r);this.trigger("data",t)}}}).prototype=new Fe;var Xi,Qi,Yi,Ki=Vi,Zi=Fe,Ji=Ui,er=Mi,tr=ji,ir=188;(Xi=function(){var e=new Uint8Array(ir),t=0;Xi.prototype.init.call(this),this.push=function(i){var r,n=0,a=ir;for(t?((r=new Uint8Array(i.byteLength+t)).set(e.subarray(0,t)),r.set(i,t),t=0):r=i;a<r.byteLength;)71!==r[n]||71!==r[a]?(n++,a++):(this.trigger("data",r.subarray(n,a)),n+=ir,a+=ir);n<r.byteLength&&(e.set(r.subarray(n),0),t=r.byteLength-n)},this.flush=function(){t===ir&&71===e[0]&&(this.trigger("data",e),t=0),this.trigger("done")},this.endTimeline=function(){this.flush(),this.trigger("endedtimeline")},this.reset=function(){t=0,this.trigger("reset")}}).prototype=new Zi,(Qi=function(){var e,t,i,r;Qi.prototype.init.call(this),r=this,this.packetsWaitingForPmt=[],this.programMapTable=void 0,e=function(e,r){var n=0;r.payloadUnitStartIndicator&&(n+=e[n]+1),"pat"===r.type?t(e.subarray(n),r):i(e.subarray(n),r)},t=function(e,t){t.section_number=e[7],t.last_section_number=e[8],r.pmtPid=(31&e[10])<<8|e[11],t.pmtPid=r.pmtPid},i=function(e,t){var i,n;if(1&e[5]){for(r.programMapTable={video:null,audio:null,"timed-metadata":{}},i=3+((15&e[1])<<8|e[2])-4,n=12+((15&e[10])<<8|e[11]);n<i;){var a=e[n],s=(31&e[n+1])<<8|e[n+2];a===er.H264_STREAM_TYPE&&null===r.programMapTable.video?r.programMapTable.video=s:a===er.ADTS_STREAM_TYPE&&null===r.programMapTable.audio?r.programMapTable.audio=s:a===er.METADATA_STREAM_TYPE&&(r.programMapTable["timed-metadata"][s]=a),n+=5+((15&e[n+3])<<8|e[n+4])}t.programMapTable=r.programMapTable}},this.push=function(t){var i={},r=4;if(i.payloadUnitStartIndicator=!!(64&t[1]),i.pid=31&t[1],i.pid<<=8,i.pid|=t[2],(48&t[3])>>>4>1&&(r+=t[r]+1),0===i.pid)i.type="pat",e(t.subarray(r),i),this.trigger("data",i);else if(i.pid===this.pmtPid)for(i.type="pmt",e(t.subarray(r),i),this.trigger("data",i);this.packetsWaitingForPmt.length;)this.processPes_.apply(this,this.packetsWaitingForPmt.shift());else void 0===this.programMapTable?this.packetsWaitingForPmt.push([t,r,i]):this.processPes_(t,r,i)},this.processPes_=function(e,t,i){i.pid===this.programMapTable.video?i.streamType=er.H264_STREAM_TYPE:i.pid===this.programMapTable.audio?i.streamType=er.ADTS_STREAM_TYPE:i.streamType=this.programMapTable["timed-metadata"][i.pid],i.type="pes",i.data=e.subarray(t),this.trigger("data",i)}}).prototype=new Zi,Qi.STREAM_TYPES={h264:27,adts:15},(Yi=function(){var e,t=this,i=!1,r={data:[],size:0},n={data:[],size:0},a={data:[],size:0},s=function(e,i,r){var n,a,s=new Uint8Array(e.size),o={type:i},l=0,d=0;if(e.data.length&&!(e.size<9)){for(o.trackId=e.data[0].pid,l=0;l<e.data.length;l++)a=e.data[l],s.set(a.data,d),d+=a.data.byteLength;var h,u,c,p;u=o,p=(h=s)[0]<<16|h[1]<<8|h[2],u.data=new Uint8Array,1===p&&(u.packetLength=6+(h[4]<<8|h[5]),u.dataAlignmentIndicator=0!=(4&h[6]),192&(c=h[7])&&(u.pts=(14&h[9])<<27|(255&h[10])<<20|(254&h[11])<<12|(255&h[12])<<5|(254&h[13])>>>3,u.pts*=4,u.pts+=(6&h[13])>>>1,u.dts=u.pts,64&c&&(u.dts=(14&h[14])<<27|(255&h[15])<<20|(254&h[16])<<12|(255&h[17])<<5|(254&h[18])>>>3,u.dts*=4,u.dts+=(6&h[18])>>>1)),u.data=h.subarray(9+h[8])),n="video"===i||o.packetLength<=e.size,(r||n)&&(e.size=0,e.data.length=0),n&&t.trigger("data",o)}};Yi.prototype.init.call(this),this.push=function(o){({pat:function(){},pes:function(){var e,t;switch(o.streamType){case er.H264_STREAM_TYPE:e=r,t="video";break;case er.ADTS_STREAM_TYPE:e=n,t="audio";break;case er.METADATA_STREAM_TYPE:e=a,t="timed-metadata";break;default:return}o.payloadUnitStartIndicator&&s(e,t,!0),e.data.push(o),e.size+=o.data.byteLength},pmt:function(){var r={type:"metadata",tracks:[]};null!==(e=o.programMapTable).video&&r.tracks.push({timelineStartInfo:{baseMediaDecodeTime:0},id:+e.video,codec:"avc",type:"video"}),null!==e.audio&&r.tracks.push({timelineStartInfo:{baseMediaDecodeTime:0},id:+e.audio,codec:"adts",type:"audio"}),i=!0,t.trigger("data",r)}})[o.type]()},this.reset=function(){r.size=0,r.data.length=0,n.size=0,n.data.length=0,this.trigger("reset")},this.flushStreams_=function(){s(r,"video"),s(n,"audio"),s(a,"timed-metadata")},this.flush=function(){if(!i&&e){var r={type:"metadata",tracks:[]};null!==e.video&&r.tracks.push({timelineStartInfo:{baseMediaDecodeTime:0},id:+e.video,codec:"avc",type:"video"}),null!==e.audio&&r.tracks.push({timelineStartInfo:{baseMediaDecodeTime:0},id:+e.audio,codec:"adts",type:"audio"}),t.trigger("data",r)}i=!1,this.flushStreams_(),this.trigger("done")}}).prototype=new Zi;var rr={PAT_PID:0,MP2T_PACKET_LENGTH:ir,TransportPacketStream:Xi,TransportParseStream:Qi,ElementaryStream:Yi,TimestampRolloverStream:tr,CaptionStream:Ji.CaptionStream,Cea608Stream:Ji.Cea608Stream,Cea708Stream:Ji.Cea708Stream,MetadataStream:Ki};for(var nr in er)er.hasOwnProperty(nr)&&(rr[nr]=er[nr]);var ar,sr=rr,or=[96e3,88200,64e3,48e3,44100,32e3,24e3,22050,16e3,12e3,11025,8e3,7350],lr=function(e,t){var i=e[t+6]<<21|e[t+7]<<14|e[t+8]<<7|e[t+9];return i=i>=0?i:0,(16&e[t+5])>>4?i+20:i+10},dr=function e(t,i){return t.length-i<10||t[i]!=="I".charCodeAt(0)||t[i+1]!=="D".charCodeAt(0)||t[i+2]!=="3".charCodeAt(0)?i:e(t,i+=lr(t,i))},hr=function(e){return e[0]<<21|e[1]<<14|e[2]<<7|e[3]},ur={isLikelyAacData:function(e){var t=dr(e,0);return e.length>=t+2&&255==(255&e[t])&&240==(240&e[t+1])&&16==(22&e[t+1])},parseId3TagSize:lr,parseAdtsSize:function(e,t){var i=(224&e[t+5])>>5,r=e[t+4]<<3;return 6144&e[t+3]|r|i},parseType:function(e,t){return e[t]==="I".charCodeAt(0)&&e[t+1]==="D".charCodeAt(0)&&e[t+2]==="3".charCodeAt(0)?"timed-metadata":!0&e[t]&&240==(240&e[t+1])?"audio":null},parseSampleRate:function(e){for(var t=0;t+5<e.length;){if(255===e[t]&&240==(246&e[t+1]))return or[(60&e[t+2])>>>2];t++}return null},parseAacTimestamp:function(e){var t,i,r;t=10,64&e[5]&&(t+=4,t+=hr(e.subarray(10,14)));do{if((i=hr(e.subarray(t+4,t+8)))<1)return null;if("PRIV"===String.fromCharCode(e[t],e[t+1],e[t+2],e[t+3])){r=e.subarray(t+10,t+i+10);for(var n=0;n<r.byteLength;n++)if(0===r[n]){if("com.apple.streaming.transportStreamTimestamp"===unescape(function(e,t,i){var r,n="";for(r=t;r<i;r++)n+="%"+("00"+e[r].toString(16)).slice(-2);return n}(r,0,n))){var a=r.subarray(n+1),s=(1&a[3])<<30|a[4]<<22|a[5]<<14|a[6]<<6|a[7]>>>2;return s*=4,s+=3&a[7]}break}}t+=10,t+=i}while(t<e.byteLength);return null}},cr=ur;(ar=function(){var e=new Uint8Array,t=0;ar.prototype.init.call(this),this.setTimestamp=function(e){t=e},this.push=function(i){var r,n,a,s,o=0,l=0;for(e.length?(s=e.length,(e=new Uint8Array(i.byteLength+s)).set(e.subarray(0,s)),e.set(i,s)):e=i;e.length-l>=3;)if(e[l]!=="I".charCodeAt(0)||e[l+1]!=="D".charCodeAt(0)||e[l+2]!=="3".charCodeAt(0))if(255!=(255&e[l])||240!=(240&e[l+1]))l++;else{if(e.length-l<7)break;if(l+(o=cr.parseAdtsSize(e,l))>e.length)break;a={type:"audio",data:e.subarray(l,l+o),pts:t,dts:t},this.trigger("data",a),l+=o}else{if(e.length-l<10)break;if(l+(o=cr.parseId3TagSize(e,l))>e.length)break;n={type:"timed-metadata",data:e.subarray(l,l+o)},this.trigger("data",n),l+=o}r=e.length-l,e=r>0?e.subarray(l):new Uint8Array},this.reset=function(){e=new Uint8Array,this.trigger("reset")},this.endTimeline=function(){e=new Uint8Array,this.trigger("endedtimeline")}}).prototype=new Fe;var pr,fr,gr,mr,yr=ar,vr=["audioobjecttype","channelcount","samplerate","samplingfrequencyindex","samplesize"],br=["width","height","profileIdc","levelIdc","profileCompatibility","sarRatio"],wr=Fe,Sr=Ht,Tr=ci,Er=vi,_r=wi,kr=sr,Pr=je,Ar=$e,Lr=Mt.H264Stream,Or=yr,Cr=ur.isLikelyAacData,Rr=je.ONE_SECOND_IN_TS,Ir=vr,xr=br,Dr=function(e,t){t.stream=e,this.trigger("log",t)},Ur=function(e,t){for(var i=Object.keys(t),r=0;r<i.length;r++){var n=i[r];"headOfPipeline"!==n&&t[n].on&&t[n].on("log",Dr.bind(e,n))}},Mr=function(e,t){var i;if(e.length!==t.length)return!1;for(i=0;i<e.length;i++)if(e[i]!==t[i])return!1;return!0},Nr=function(e,t,i,r,n,a){return{start:{dts:e,pts:e+(i-t)},end:{dts:e+(r-t),pts:e+(n-i)},prependedContentDuration:a,baseMediaDecodeTime:e}};(fr=function(e,t){var i,r=[],n=0,a=0,s=1/0;i=(t=t||{}).firstSequenceNumber||0,fr.prototype.init.call(this),this.push=function(t){_r.collectDtsInfo(e,t),e&&Ir.forEach((function(i){e[i]=t[i]})),r.push(t)},this.setEarliestDts=function(e){n=e},this.setVideoBaseMediaDecodeTime=function(e){s=e},this.setAudioAppendStart=function(e){a=e},this.flush=function(){var o,l,d,h,u,c,p;0!==r.length?(o=Er.trimAdtsFramesByEarliestDts(r,e,n),e.baseMediaDecodeTime=_r.calculateTrackBaseMediaDecodeTime(e,t.keepOriginalTimestamps),p=Er.prefixWithSilence(e,o,a,s),e.samples=Er.generateSampleTable(o),d=Sr.mdat(Er.concatenateFrameData(o)),r=[],l=Sr.moof(i,[e]),h=new Uint8Array(l.byteLength+d.byteLength),i++,h.set(l),h.set(d,l.byteLength),_r.clearDtsInfo(e),u=Math.ceil(1024*Rr/e.samplerate),o.length&&(c=o.length*u,this.trigger("segmentTimingInfo",Nr(Pr.audioTsToVideoTs(e.baseMediaDecodeTime,e.samplerate),o[0].dts,o[0].pts,o[0].dts+c,o[0].pts+c,p||0)),this.trigger("timingInfo",{start:o[0].pts,end:o[0].pts+c})),this.trigger("data",{track:e,boxes:h}),this.trigger("done","AudioSegmentStream")):this.trigger("done","AudioSegmentStream")},this.reset=function(){_r.clearDtsInfo(e),r=[],this.trigger("reset")}}).prototype=new wr,(pr=function(e,t){var i,r,n,a=[],s=[];i=(t=t||{}).firstSequenceNumber||0,pr.prototype.init.call(this),delete e.minPTS,this.gopCache_=[],this.push=function(t){_r.collectDtsInfo(e,t),"seq_parameter_set_rbsp"!==t.nalUnitType||r||(r=t.config,e.sps=[t.data],xr.forEach((function(t){e[t]=r[t]}),this)),"pic_parameter_set_rbsp"!==t.nalUnitType||n||(n=t.data,e.pps=[t.data]),a.push(t)},this.flush=function(){for(var r,n,o,l,d,h,u,c,p=0;a.length&&"access_unit_delimiter_rbsp"!==a[0].nalUnitType;)a.shift();if(0===a.length)return this.resetStream_(),void this.trigger("done","VideoSegmentStream");if(r=Tr.groupNalsIntoFrames(a),(o=Tr.groupFramesIntoGops(r))[0][0].keyFrame||((n=this.getGopForFusion_(a[0],e))?(p=n.duration,o.unshift(n),o.byteLength+=n.byteLength,o.nalCount+=n.nalCount,o.pts=n.pts,o.dts=n.dts,o.duration+=n.duration):o=Tr.extendFirstKeyFrame(o)),s.length){var f;if(!(f=t.alignGopsAtEnd?this.alignGopsAtEnd_(o):this.alignGopsAtStart_(o)))return this.gopCache_.unshift({gop:o.pop(),pps:e.pps,sps:e.sps}),this.gopCache_.length=Math.min(6,this.gopCache_.length),a=[],this.resetStream_(),void this.trigger("done","VideoSegmentStream");_r.clearDtsInfo(e),o=f}_r.collectDtsInfo(e,o),e.samples=Tr.generateSampleTable(o),d=Sr.mdat(Tr.concatenateNalData(o)),e.baseMediaDecodeTime=_r.calculateTrackBaseMediaDecodeTime(e,t.keepOriginalTimestamps),this.trigger("processedGopsInfo",o.map((function(e){return{pts:e.pts,dts:e.dts,byteLength:e.byteLength}}))),u=o[0],c=o[o.length-1],this.trigger("segmentTimingInfo",Nr(e.baseMediaDecodeTime,u.dts,u.pts,c.dts+c.duration,c.pts+c.duration,p)),this.trigger("timingInfo",{start:o[0].pts,end:o[o.length-1].pts+o[o.length-1].duration}),this.gopCache_.unshift({gop:o.pop(),pps:e.pps,sps:e.sps}),this.gopCache_.length=Math.min(6,this.gopCache_.length),a=[],this.trigger("baseMediaDecodeTime",e.baseMediaDecodeTime),this.trigger("timelineStartInfo",e.timelineStartInfo),l=Sr.moof(i,[e]),h=new Uint8Array(l.byteLength+d.byteLength),i++,h.set(l),h.set(d,l.byteLength),this.trigger("data",{track:e,boxes:h}),this.resetStream_(),this.trigger("done","VideoSegmentStream")},this.reset=function(){this.resetStream_(),a=[],this.gopCache_.length=0,s.length=0,this.trigger("reset")},this.resetStream_=function(){_r.clearDtsInfo(e),r=void 0,n=void 0},this.getGopForFusion_=function(t){var i,r,n,a,s,o=1/0;for(s=0;s<this.gopCache_.length;s++)n=(a=this.gopCache_[s]).gop,e.pps&&Mr(e.pps[0],a.pps[0])&&e.sps&&Mr(e.sps[0],a.sps[0])&&(n.dts<e.timelineStartInfo.dts||(i=t.dts-n.dts-n.duration)>=-1e4&&i<=45e3&&(!r||o>i)&&(r=a,o=i));return r?r.gop:null},this.alignGopsAtStart_=function(e){var t,i,r,n,a,o,l,d;for(a=e.byteLength,o=e.nalCount,l=e.duration,t=i=0;t<s.length&&i<e.length&&(r=s[t],n=e[i],r.pts!==n.pts);)n.pts>r.pts?t++:(i++,a-=n.byteLength,o-=n.nalCount,l-=n.duration);return 0===i?e:i===e.length?null:((d=e.slice(i)).byteLength=a,d.duration=l,d.nalCount=o,d.pts=d[0].pts,d.dts=d[0].dts,d)},this.alignGopsAtEnd_=function(e){var t,i,r,n,a,o,l;for(t=s.length-1,i=e.length-1,a=null,o=!1;t>=0&&i>=0;){if(r=s[t],n=e[i],r.pts===n.pts){o=!0;break}r.pts>n.pts?t--:(t===s.length-1&&(a=i),i--)}if(!o&&null===a)return null;if(0===(l=o?i:a))return e;var d=e.slice(l),h=d.reduce((function(e,t){return e.byteLength+=t.byteLength,e.duration+=t.duration,e.nalCount+=t.nalCount,e}),{byteLength:0,duration:0,nalCount:0});return d.byteLength=h.byteLength,d.duration=h.duration,d.nalCount=h.nalCount,d.pts=d[0].pts,d.dts=d[0].dts,d},this.alignGopsWith=function(e){s=e}}).prototype=new wr,(mr=function(e,t){this.numberOfTracks=0,this.metadataStream=t,void 0!==(e=e||{}).remux?this.remuxTracks=!!e.remux:this.remuxTracks=!0,"boolean"==typeof e.keepOriginalTimestamps?this.keepOriginalTimestamps=e.keepOriginalTimestamps:this.keepOriginalTimestamps=!1,this.pendingTracks=[],this.videoTrack=null,this.pendingBoxes=[],this.pendingCaptions=[],this.pendingMetadata=[],this.pendingBytes=0,this.emittedTracks=0,mr.prototype.init.call(this),this.push=function(e){return e.text?this.pendingCaptions.push(e):e.frames?this.pendingMetadata.push(e):(this.pendingTracks.push(e.track),this.pendingBytes+=e.boxes.byteLength,"video"===e.track.type&&(this.videoTrack=e.track,this.pendingBoxes.push(e.boxes)),void("audio"===e.track.type&&(this.audioTrack=e.track,this.pendingBoxes.unshift(e.boxes))))}}).prototype=new wr,mr.prototype.flush=function(e){var t,i,r,n,a=0,s={captions:[],captionStreams:{},metadata:[],info:{}},o=0;if(this.pendingTracks.length<this.numberOfTracks){if("VideoSegmentStream"!==e&&"AudioSegmentStream"!==e)return;if(this.remuxTracks)return;if(0===this.pendingTracks.length)return this.emittedTracks++,void(this.emittedTracks>=this.numberOfTracks&&(this.trigger("done"),this.emittedTracks=0))}if(this.videoTrack?(o=this.videoTrack.timelineStartInfo.pts,xr.forEach((function(e){s.info[e]=this.videoTrack[e]}),this)):this.audioTrack&&(o=this.audioTrack.timelineStartInfo.pts,Ir.forEach((function(e){s.info[e]=this.audioTrack[e]}),this)),this.videoTrack||this.audioTrack){for(1===this.pendingTracks.length?s.type=this.pendingTracks[0].type:s.type="combined",this.emittedTracks+=this.pendingTracks.length,r=Sr.initSegment(this.pendingTracks),s.initSegment=new Uint8Array(r.byteLength),s.initSegment.set(r),s.data=new Uint8Array(this.pendingBytes),n=0;n<this.pendingBoxes.length;n++)s.data.set(this.pendingBoxes[n],a),a+=this.pendingBoxes[n].byteLength;for(n=0;n<this.pendingCaptions.length;n++)(t=this.pendingCaptions[n]).startTime=Pr.metadataTsToSeconds(t.startPts,o,this.keepOriginalTimestamps),t.endTime=Pr.metadataTsToSeconds(t.endPts,o,this.keepOriginalTimestamps),s.captionStreams[t.stream]=!0,s.captions.push(t);for(n=0;n<this.pendingMetadata.length;n++)(i=this.pendingMetadata[n]).cueTime=Pr.metadataTsToSeconds(i.pts,o,this.keepOriginalTimestamps),s.metadata.push(i);for(s.metadata.dispatchType=this.metadataStream.dispatchType,this.pendingTracks.length=0,this.videoTrack=null,this.pendingBoxes.length=0,this.pendingCaptions.length=0,this.pendingBytes=0,this.pendingMetadata.length=0,this.trigger("data",s),n=0;n<s.captions.length;n++)t=s.captions[n],this.trigger("caption",t);for(n=0;n<s.metadata.length;n++)i=s.metadata[n],this.trigger("id3Frame",i)}this.emittedTracks>=this.numberOfTracks&&(this.trigger("done"),this.emittedTracks=0)},mr.prototype.setRemux=function(e){this.remuxTracks=e},(gr=function(e){var t,i,r=this,n=!0;gr.prototype.init.call(this),e=e||{},this.baseMediaDecodeTime=e.baseMediaDecodeTime||0,this.transmuxPipeline_={},this.setupAacPipeline=function(){var n={};this.transmuxPipeline_=n,n.type="aac",n.metadataStream=new kr.MetadataStream,n.aacStream=new Or,n.audioTimestampRolloverStream=new kr.TimestampRolloverStream("audio"),n.timedMetadataTimestampRolloverStream=new kr.TimestampRolloverStream("timed-metadata"),n.adtsStream=new Ar,n.coalesceStream=new mr(e,n.metadataStream),n.headOfPipeline=n.aacStream,n.aacStream.pipe(n.audioTimestampRolloverStream).pipe(n.adtsStream),n.aacStream.pipe(n.timedMetadataTimestampRolloverStream).pipe(n.metadataStream).pipe(n.coalesceStream),n.metadataStream.on("timestamp",(function(e){n.aacStream.setTimestamp(e.timeStamp)})),n.aacStream.on("data",(function(a){"timed-metadata"!==a.type&&"audio"!==a.type||n.audioSegmentStream||(i=i||{timelineStartInfo:{baseMediaDecodeTime:r.baseMediaDecodeTime},codec:"adts",type:"audio"},n.coalesceStream.numberOfTracks++,n.audioSegmentStream=new fr(i,e),n.audioSegmentStream.on("log",r.getLogTrigger_("audioSegmentStream")),n.audioSegmentStream.on("timingInfo",r.trigger.bind(r,"audioTimingInfo")),n.adtsStream.pipe(n.audioSegmentStream).pipe(n.coalesceStream),r.trigger("trackinfo",{hasAudio:!!i,hasVideo:!!t}))})),n.coalesceStream.on("data",this.trigger.bind(this,"data")),n.coalesceStream.on("done",this.trigger.bind(this,"done")),Ur(this,n)},this.setupTsPipeline=function(){var n={};this.transmuxPipeline_=n,n.type="ts",n.metadataStream=new kr.MetadataStream,n.packetStream=new kr.TransportPacketStream,n.parseStream=new kr.TransportParseStream,n.elementaryStream=new kr.ElementaryStream,n.timestampRolloverStream=new kr.TimestampRolloverStream,n.adtsStream=new Ar,n.h264Stream=new Lr,n.captionStream=new kr.CaptionStream(e),n.coalesceStream=new mr(e,n.metadataStream),n.headOfPipeline=n.packetStream,n.packetStream.pipe(n.parseStream).pipe(n.elementaryStream).pipe(n.timestampRolloverStream),n.timestampRolloverStream.pipe(n.h264Stream),n.timestampRolloverStream.pipe(n.adtsStream),n.timestampRolloverStream.pipe(n.metadataStream).pipe(n.coalesceStream),n.h264Stream.pipe(n.captionStream).pipe(n.coalesceStream),n.elementaryStream.on("data",(function(a){var s;if("metadata"===a.type){for(s=a.tracks.length;s--;)t||"video"!==a.tracks[s].type?i||"audio"!==a.tracks[s].type||((i=a.tracks[s]).timelineStartInfo.baseMediaDecodeTime=r.baseMediaDecodeTime):(t=a.tracks[s]).timelineStartInfo.baseMediaDecodeTime=r.baseMediaDecodeTime;t&&!n.videoSegmentStream&&(n.coalesceStream.numberOfTracks++,n.videoSegmentStream=new pr(t,e),n.videoSegmentStream.on("log",r.getLogTrigger_("videoSegmentStream")),n.videoSegmentStream.on("timelineStartInfo",(function(t){i&&!e.keepOriginalTimestamps&&(i.timelineStartInfo=t,n.audioSegmentStream.setEarliestDts(t.dts-r.baseMediaDecodeTime))})),n.videoSegmentStream.on("processedGopsInfo",r.trigger.bind(r,"gopInfo")),n.videoSegmentStream.on("segmentTimingInfo",r.trigger.bind(r,"videoSegmentTimingInfo")),n.videoSegmentStream.on("baseMediaDecodeTime",(function(e){i&&n.audioSegmentStream.setVideoBaseMediaDecodeTime(e)})),n.videoSegmentStream.on("timingInfo",r.trigger.bind(r,"videoTimingInfo")),n.h264Stream.pipe(n.videoSegmentStream).pipe(n.coalesceStream)),i&&!n.audioSegmentStream&&(n.coalesceStream.numberOfTracks++,n.audioSegmentStream=new fr(i,e),n.audioSegmentStream.on("log",r.getLogTrigger_("audioSegmentStream")),n.audioSegmentStream.on("timingInfo",r.trigger.bind(r,"audioTimingInfo")),n.audioSegmentStream.on("segmentTimingInfo",r.trigger.bind(r,"audioSegmentTimingInfo")),n.adtsStream.pipe(n.audioSegmentStream).pipe(n.coalesceStream)),r.trigger("trackinfo",{hasAudio:!!i,hasVideo:!!t})}})),n.coalesceStream.on("data",this.trigger.bind(this,"data")),n.coalesceStream.on("id3Frame",(function(e){e.dispatchType=n.metadataStream.dispatchType,r.trigger("id3Frame",e)})),n.coalesceStream.on("caption",this.trigger.bind(this,"caption")),n.coalesceStream.on("done",this.trigger.bind(this,"done")),Ur(this,n)},this.setBaseMediaDecodeTime=function(r){var n=this.transmuxPipeline_;e.keepOriginalTimestamps||(this.baseMediaDecodeTime=r),i&&(i.timelineStartInfo.dts=void 0,i.timelineStartInfo.pts=void 0,_r.clearDtsInfo(i),n.audioTimestampRolloverStream&&n.audioTimestampRolloverStream.discontinuity()),t&&(n.videoSegmentStream&&(n.videoSegmentStream.gopCache_=[]),t.timelineStartInfo.dts=void 0,t.timelineStartInfo.pts=void 0,_r.clearDtsInfo(t),n.captionStream.reset()),n.timestampRolloverStream&&n.timestampRolloverStream.discontinuity()},this.setAudioAppendStart=function(e){i&&this.transmuxPipeline_.audioSegmentStream.setAudioAppendStart(e)},this.setRemux=function(t){var i=this.transmuxPipeline_;e.remux=t,i&&i.coalesceStream&&i.coalesceStream.setRemux(t)},this.alignGopsWith=function(e){t&&this.transmuxPipeline_.videoSegmentStream&&this.transmuxPipeline_.videoSegmentStream.alignGopsWith(e)},this.getLogTrigger_=function(e){var t=this;return function(i){i.stream=e,t.trigger("log",i)}},this.push=function(e){if(n){var t=Cr(e);t&&"aac"!==this.transmuxPipeline_.type?this.setupAacPipeline():t||"ts"===this.transmuxPipeline_.type||this.setupTsPipeline(),n=!1}this.transmuxPipeline_.headOfPipeline.push(e)},this.flush=function(){n=!0,this.transmuxPipeline_.headOfPipeline.flush()},this.endTimeline=function(){this.transmuxPipeline_.headOfPipeline.endTimeline()},this.reset=function(){this.transmuxPipeline_.headOfPipeline&&this.transmuxPipeline_.headOfPipeline.reset()},this.resetCaptions=function(){this.transmuxPipeline_.captionStream&&this.transmuxPipeline_.captionStream.reset()}}).prototype=new wr;var Fr,Br={Transmuxer:gr,VideoSegmentStream:pr,AudioSegmentStream:fr,AUDIO_PROPERTIES:Ir,VIDEO_PROPERTIES:xr,generateSegmentTimingInfo:Nr},Vr=Si.discardEmulationPreventionBytes,jr=Ui.CaptionStream,zr=Yt,qr=ti,Gr=Jt,Hr=Kt,Wr=function(e,t){for(var i=e,r=0;r<t.length;r++){var n=t[r];if(i<n.size)return n;i-=n.size}return null},$r=function(e,t){var i=zr(e,["moof","traf"]),r=zr(e,["mdat"]),n={},a=[];return r.forEach((function(e,t){var r=i[t];a.push({mdat:e,traf:r})})),a.forEach((function(e){var i,r=e.mdat,a=e.traf,s=zr(a,["tfhd"]),o=Hr(s[0]),l=o.trackId,d=zr(a,["tfdt"]),h=d.length>0?qr(d[0]).baseMediaDecodeTime:0,u=zr(a,["trun"]);t===l&&u.length>0&&(i=function(e,t,i){var r,n,a,s,o=new DataView(e.buffer,e.byteOffset,e.byteLength),l={logs:[],seiNals:[]};for(n=0;n+4<e.length;n+=a)if(a=o.getUint32(n),n+=4,!(a<=0))switch(31&e[n]){case 6:var d=e.subarray(n+1,n+1+a),h=Wr(n,t);if(r={nalUnitType:"sei_rbsp",size:a,data:d,escapedRBSP:Vr(d),trackId:i},h)r.pts=h.pts,r.dts=h.dts,s=h;else{if(!s){l.logs.push({level:"warn",message:"We've encountered a nal unit without data at "+n+" for trackId "+i+". See mux.js#223."});break}r.pts=s.pts,r.dts=s.dts}l.seiNals.push(r)}return l}(r,function(e,t,i){var r=t,n=i.defaultSampleDuration||0,a=i.defaultSampleSize||0,s=i.trackId,o=[];return e.forEach((function(e){var t=Gr(e).samples;t.forEach((function(e){void 0===e.duration&&(e.duration=n),void 0===e.size&&(e.size=a),e.trackId=s,e.dts=r,void 0===e.compositionTimeOffset&&(e.compositionTimeOffset=0),e.pts=r+e.compositionTimeOffset,r+=e.duration})),o=o.concat(t)})),o}(u,h,o),l),n[l]||(n[l]={seiNals:[],logs:[]}),n[l].seiNals=n[l].seiNals.concat(i.seiNals),n[l].logs=n[l].logs.concat(i.logs))})),n},Xr={generator:Ht,probe:hi,Transmuxer:Br.Transmuxer,AudioSegmentStream:Br.AudioSegmentStream,VideoSegmentStream:Br.VideoSegmentStream,CaptionParser:function(){var e,t,i,r,n,a,s=!1;this.isInitialized=function(){return s},this.init=function(t){e=new jr,s=!0,a=!!t&&t.isPartial,e.on("data",(function(e){e.startTime=e.startPts/r,e.endTime=e.endPts/r,n.captions.push(e),n.captionStreams[e.stream]=!0})),e.on("log",(function(e){n.logs.push(e)}))},this.isNewInit=function(e,t){return!(e&&0===e.length||t&&"object"==typeof t&&0===Object.keys(t).length)&&(i!==e[0]||r!==t[i])},this.parse=function(e,a,s){var o;if(!this.isInitialized())return null;if(!a||!s)return null;if(this.isNewInit(a,s))i=a[0],r=s[i];else if(null===i||!r)return t.push(e),null;for(;t.length>0;){var l=t.shift();this.parse(l,a,s)}return(o=function(e,t,i){if(null===t)return null;var r=$r(e,t)[t]||{};return{seiNals:r.seiNals,logs:r.logs,timescale:i}}(e,i,r))&&o.logs&&(n.logs=n.logs.concat(o.logs)),null!==o&&o.seiNals?(this.pushNals(o.seiNals),this.flushStream(),n):n.logs.length?{logs:n.logs,captions:[],captionStreams:[]}:null},this.pushNals=function(t){if(!this.isInitialized()||!t||0===t.length)return null;t.forEach((function(t){e.push(t)}))},this.flushStream=function(){if(!this.isInitialized())return null;a?e.partialFlush():e.flush()},this.clearParsedCaptions=function(){n.captions=[],n.captionStreams={},n.logs=[]},this.resetCaptionStream=function(){if(!this.isInitialized())return null;e.reset()},this.clearAllCaptions=function(){this.clearParsedCaptions(),this.resetCaptionStream()},this.reset=function(){t=[],i=null,r=null,n?this.clearParsedCaptions():n={captions:[],captionStreams:{},logs:[]},this.resetCaptionStream()},this.reset()}};(Fr=function(e,t){var i,r=0,n=16384,a=function(e,t){var i,r=e.position+t;r<e.bytes.byteLength||((i=new Uint8Array(2*r)).set(e.bytes.subarray(0,e.position),0),e.bytes=i,e.view=new DataView(e.bytes.buffer))},s=Fr.widthBytes||new Uint8Array("width".length),o=Fr.heightBytes||new Uint8Array("height".length),l=Fr.videocodecidBytes||new Uint8Array("videocodecid".length);if(!Fr.widthBytes){for(i=0;i<"width".length;i++)s[i]="width".charCodeAt(i);for(i=0;i<"height".length;i++)o[i]="height".charCodeAt(i);for(i=0;i<"videocodecid".length;i++)l[i]="videocodecid".charCodeAt(i);Fr.widthBytes=s,Fr.heightBytes=o,Fr.videocodecidBytes=l}switch(this.keyFrame=!1,e){case Fr.VIDEO_TAG:this.length=16,n*=6;break;case Fr.AUDIO_TAG:this.length=13,this.keyFrame=!0;break;case Fr.METADATA_TAG:this.length=29,this.keyFrame=!0;break;default:throw new Error("Unknown FLV tag type")}this.bytes=new Uint8Array(n),this.view=new DataView(this.bytes.buffer),this.bytes[0]=e,this.position=this.length,this.keyFrame=t,this.pts=0,this.dts=0,this.writeBytes=function(e,t,i){var r,n=t||0;r=n+(i=i||e.byteLength),a(this,i),this.bytes.set(e.subarray(n,r),this.position),this.position+=i,this.length=Math.max(this.length,this.position)},this.writeByte=function(e){a(this,1),this.bytes[this.position]=e,this.position++,this.length=Math.max(this.length,this.position)},this.writeShort=function(e){a(this,2),this.view.setUint16(this.position,e),this.position+=2,this.length=Math.max(this.length,this.position)},this.negIndex=function(e){return this.bytes[this.length-e]},this.nalUnitSize=function(){return 0===r?0:this.length-(r+4)},this.startNalUnit=function(){if(r>0)throw new Error("Attempted to create new NAL wihout closing the old one");r=this.length,this.length+=4,this.position=this.length},this.endNalUnit=function(e){var t,i;this.length===r+4?this.length-=4:r>0&&(t=r+4,i=this.length-t,this.position=r,this.view.setUint32(this.position,i),this.position=this.length,e&&e.push(this.bytes.subarray(t,t+i))),r=0},this.writeMetaDataDouble=function(e,t){var i;if(a(this,2+e.length+9),this.view.setUint16(this.position,e.length),this.position+=2,"width"===e)this.bytes.set(s,this.position),this.position+=5;else if("height"===e)this.bytes.set(o,this.position),this.position+=6;else if("videocodecid"===e)this.bytes.set(l,this.position),this.position+=12;else for(i=0;i<e.length;i++)this.bytes[this.position]=e.charCodeAt(i),this.position++;this.position++,this.view.setFloat64(this.position,t),this.position+=8,this.length=Math.max(this.length,this.position),++r},this.writeMetaDataBoolean=function(e,t){var i;for(a(this,2),this.view.setUint16(this.position,e.length),this.position+=2,i=0;i<e.length;i++)a(this,1),this.bytes[this.position]=e.charCodeAt(i),this.position++;a(this,2),this.view.setUint8(this.position,1),this.position++,this.view.setUint8(this.position,t?1:0),this.position++,this.length=Math.max(this.length,this.position),++r},this.finalize=function(){var e,i;switch(this.bytes[0]){case Fr.VIDEO_TAG:this.bytes[11]=7|(this.keyFrame||t?16:32),this.bytes[12]=t?0:1,e=this.pts-this.dts,this.bytes[13]=(16711680&e)>>>16,this.bytes[14]=(65280&e)>>>8,this.bytes[15]=(255&e)>>>0;break;case Fr.AUDIO_TAG:this.bytes[11]=175,this.bytes[12]=t?0:1;break;case Fr.METADATA_TAG:this.position=11,this.view.setUint8(this.position,2),this.position++,this.view.setUint16(this.position,10),this.position+=2,this.bytes.set([111,110,77,101,116,97,68,97,116,97],this.position),this.position+=10,this.bytes[this.position]=8,this.position++,this.view.setUint32(this.position,r),this.position=this.length,this.bytes.set([0,0,9],this.position),this.position+=3,this.length=this.position}return i=this.length-11,this.bytes[1]=(16711680&i)>>>16,this.bytes[2]=(65280&i)>>>8,this.bytes[3]=(255&i)>>>0,this.bytes[4]=(16711680&this.dts)>>>16,this.bytes[5]=(65280&this.dts)>>>8,this.bytes[6]=(255&this.dts)>>>0,this.bytes[7]=(4278190080&this.dts)>>>24,this.bytes[8]=0,this.bytes[9]=0,this.bytes[10]=0,a(this,4),this.view.setUint32(this.length,this.length),this.length+=4,this.position+=4,this.bytes=this.bytes.subarray(0,this.length),this.frameTime=Fr.frameTime(this.bytes),this}}).AUDIO_TAG=8,Fr.VIDEO_TAG=9,Fr.METADATA_TAG=18,Fr.isAudioFrame=function(e){return Fr.AUDIO_TAG===e[0]},Fr.isVideoFrame=function(e){return Fr.VIDEO_TAG===e[0]},Fr.isMetaData=function(e){return Fr.METADATA_TAG===e[0]},Fr.isKeyFrame=function(e){return Fr.isVideoFrame(e)?23===e[11]:!!Fr.isAudioFrame(e)||!!Fr.isMetaData(e)},Fr.frameTime=function(e){var t=e[4]<<16;return t|=e[5]<<8,t|=e[6]<<0,t|=e[7]<<24};var Qr=Fr,Yr=function e(t){this.numberOfTracks=0,this.metadataStream=t.metadataStream,this.videoTags=[],this.audioTags=[],this.videoTrack=null,this.audioTrack=null,this.pendingCaptions=[],this.pendingMetadata=[],this.pendingTracks=0,this.processedTracks=0,e.prototype.init.call(this),this.push=function(e){return e.text?this.pendingCaptions.push(e):e.frames?this.pendingMetadata.push(e):("video"===e.track.type&&(this.videoTrack=e.track,this.videoTags=e.tags,this.pendingTracks++),void("audio"===e.track.type&&(this.audioTrack=e.track,this.audioTags=e.tags,this.pendingTracks++)))}};(Yr.prototype=new Fe).flush=function(e){var t,i,r,n,a={tags:{},captions:[],captionStreams:{},metadata:[]};if(this.pendingTracks<this.numberOfTracks){if("VideoSegmentStream"!==e&&"AudioSegmentStream"!==e)return;if(0===this.pendingTracks&&(this.processedTracks++,this.processedTracks<this.numberOfTracks))return}if(this.processedTracks+=this.pendingTracks,this.pendingTracks=0,!(this.processedTracks<this.numberOfTracks)){for(this.videoTrack?n=this.videoTrack.timelineStartInfo.pts:this.audioTrack&&(n=this.audioTrack.timelineStartInfo.pts),a.tags.videoTags=this.videoTags,a.tags.audioTags=this.audioTags,r=0;r<this.pendingCaptions.length;r++)(i=this.pendingCaptions[r]).startTime=i.startPts-n,i.startTime/=9e4,i.endTime=i.endPts-n,i.endTime/=9e4,a.captionStreams[i.stream]=!0,a.captions.push(i);for(r=0;r<this.pendingMetadata.length;r++)(t=this.pendingMetadata[r]).cueTime=t.pts-n,t.cueTime/=9e4,a.metadata.push(t);a.metadata.dispatchType=this.metadataStream.dispatchType,this.videoTrack=null,this.audioTrack=null,this.videoTags=[],this.audioTags=[],this.pendingCaptions.length=0,this.pendingMetadata.length=0,this.pendingTracks=0,this.processedTracks=0,this.trigger("data",a),this.trigger("done")}};var Kr,Zr,Jr,en,tn,rn,nn=Fe,an=Qr,sn=sr,on=$e,ln=Mt.H264Stream,dn=Yr,hn=function(){var e=this;this.list=[],this.push=function(e){this.list.push({bytes:e.bytes,dts:e.dts,pts:e.pts,keyFrame:e.keyFrame,metaDataTag:e.metaDataTag})},Object.defineProperty(this,"length",{get:function(){return e.list.length}})};en=function(e,t){"number"==typeof t.pts&&(void 0===e.timelineStartInfo.pts?e.timelineStartInfo.pts=t.pts:e.timelineStartInfo.pts=Math.min(e.timelineStartInfo.pts,t.pts)),"number"==typeof t.dts&&(void 0===e.timelineStartInfo.dts?e.timelineStartInfo.dts=t.dts:e.timelineStartInfo.dts=Math.min(e.timelineStartInfo.dts,t.dts))},tn=function(e,t){var i=new an(an.METADATA_TAG);return i.dts=t,i.pts=t,i.writeMetaDataDouble("videocodecid",7),i.writeMetaDataDouble("width",e.width),i.writeMetaDataDouble("height",e.height),i},rn=function(e,t){var i,r=new an(an.VIDEO_TAG,!0);for(r.dts=t,r.pts=t,r.writeByte(1),r.writeByte(e.profileIdc),r.writeByte(e.profileCompatibility),r.writeByte(e.levelIdc),r.writeByte(255),r.writeByte(225),r.writeShort(e.sps[0].length),r.writeBytes(e.sps[0]),r.writeByte(e.pps.length),i=0;i<e.pps.length;++i)r.writeShort(e.pps[i].length),r.writeBytes(e.pps[i]);return r},(Jr=function(e){var t,i=[],r=[];Jr.prototype.init.call(this),this.push=function(t){en(e,t),e&&(e.audioobjecttype=t.audioobjecttype,e.channelcount=t.channelcount,e.samplerate=t.samplerate,e.samplingfrequencyindex=t.samplingfrequencyindex,e.samplesize=t.samplesize,e.extraData=e.audioobjecttype<<11|e.samplingfrequencyindex<<7|e.channelcount<<3),t.pts=Math.round(t.pts/90),t.dts=Math.round(t.dts/90),i.push(t)},this.flush=function(){var n,a,s,o=new hn;if(0!==i.length){for(s=-1/0;i.length;)n=i.shift(),r.length&&n.pts>=r[0]&&(s=r.shift(),this.writeMetaDataTags(o,s)),(e.extraData!==t||n.pts-s>=1e3)&&(this.writeMetaDataTags(o,n.pts),t=e.extraData,s=n.pts),(a=new an(an.AUDIO_TAG)).pts=n.pts,a.dts=n.dts,a.writeBytes(n.data),o.push(a.finalize());r.length=0,t=null,this.trigger("data",{track:e,tags:o.list}),this.trigger("done","AudioSegmentStream")}else this.trigger("done","AudioSegmentStream")},this.writeMetaDataTags=function(t,i){var r;(r=new an(an.METADATA_TAG)).pts=i,r.dts=i,r.writeMetaDataDouble("audiocodecid",10),r.writeMetaDataBoolean("stereo",2===e.channelcount),r.writeMetaDataDouble("audiosamplerate",e.samplerate),r.writeMetaDataDouble("audiosamplesize",16),t.push(r.finalize()),(r=new an(an.AUDIO_TAG,!0)).pts=i,r.dts=i,r.view.setUint16(r.position,e.extraData),r.position+=2,r.length=Math.max(r.length,r.position),t.push(r.finalize())},this.onVideoKeyFrame=function(e){r.push(e)}}).prototype=new nn,(Zr=function(e){var t,i,r=[];Zr.prototype.init.call(this),this.finishFrame=function(r,n){if(n){if(t&&e&&e.newMetadata&&(n.keyFrame||0===r.length)){var a=tn(t,n.dts).finalize(),s=rn(e,n.dts).finalize();a.metaDataTag=s.metaDataTag=!0,r.push(a),r.push(s),e.newMetadata=!1,this.trigger("keyframe",n.dts)}n.endNalUnit(),r.push(n.finalize()),i=null}},this.push=function(t){en(e,t),t.pts=Math.round(t.pts/90),t.dts=Math.round(t.dts/90),r.push(t)},this.flush=function(){for(var n,a=new hn;r.length&&"access_unit_delimiter_rbsp"!==r[0].nalUnitType;)r.shift();if(0!==r.length){for(;r.length;)"seq_parameter_set_rbsp"===(n=r.shift()).nalUnitType?(e.newMetadata=!0,t=n.config,e.width=t.width,e.height=t.height,e.sps=[n.data],e.profileIdc=t.profileIdc,e.levelIdc=t.levelIdc,e.profileCompatibility=t.profileCompatibility,i.endNalUnit()):"pic_parameter_set_rbsp"===n.nalUnitType?(e.newMetadata=!0,e.pps=[n.data],i.endNalUnit()):"access_unit_delimiter_rbsp"===n.nalUnitType?(i&&this.finishFrame(a,i),(i=new an(an.VIDEO_TAG)).pts=n.pts,i.dts=n.dts):("slice_layer_without_partitioning_rbsp_idr"===n.nalUnitType&&(i.keyFrame=!0),i.endNalUnit()),i.startNalUnit(),i.writeBytes(n.data);i&&this.finishFrame(a,i),this.trigger("data",{track:e,tags:a.list}),this.trigger("done","VideoSegmentStream")}else this.trigger("done","VideoSegmentStream")}}).prototype=new nn,(Kr=function(e){var t,i,r,n,a,s,o,l,d,h,u,c,p=this;Kr.prototype.init.call(this),e=e||{},this.metadataStream=new sn.MetadataStream,e.metadataStream=this.metadataStream,t=new sn.TransportPacketStream,i=new sn.TransportParseStream,r=new sn.ElementaryStream,n=new sn.TimestampRolloverStream("video"),a=new sn.TimestampRolloverStream("audio"),s=new sn.TimestampRolloverStream("timed-metadata"),o=new on,l=new ln,c=new dn(e),t.pipe(i).pipe(r),r.pipe(n).pipe(l),r.pipe(a).pipe(o),r.pipe(s).pipe(this.metadataStream).pipe(c),u=new sn.CaptionStream(e),l.pipe(u).pipe(c),r.on("data",(function(e){var t,i,r;if("metadata"===e.type){for(t=e.tracks.length;t--;)"video"===e.tracks[t].type?i=e.tracks[t]:"audio"===e.tracks[t].type&&(r=e.tracks[t]);i&&!d&&(c.numberOfTracks++,d=new Zr(i),l.pipe(d).pipe(c)),r&&!h&&(c.numberOfTracks++,h=new Jr(r),o.pipe(h).pipe(c),d&&d.on("keyframe",h.onVideoKeyFrame))}})),this.push=function(e){t.push(e)},this.flush=function(){t.flush()},this.resetCaptions=function(){u.reset()},c.on("data",(function(e){p.trigger("data",e)})),c.on("done",(function(){p.trigger("done")}))}).prototype=new nn;var un=Qr,cn={tag:Qr,Transmuxer:Kr,getFlvHeader:function(e,t,i){var r,n,a,s=new Uint8Array(9),o=new DataView(s.buffer);return e=e||0,t=void 0===t||t,i=void 0===i||i,o.setUint8(0,70),o.setUint8(1,76),o.setUint8(2,86),o.setUint8(3,1),o.setUint8(4,(t?4:0)|(i?1:0)),o.setUint32(5,s.byteLength),e<=0?((n=new Uint8Array(s.byteLength+4)).set(s),n.set([0,0,0,0],s.byteLength),n):((r=new un(un.METADATA_TAG)).pts=r.dts=0,r.writeMetaDataDouble("duration",e),a=r.finalize().length,(n=new Uint8Array(s.byteLength+a)).set(s),n.set(o.byteLength,a),n)}},pn=sr,fn=Ht,gn=vi,mn=wi,yn=je.ONE_SECOND_IN_TS,vn=vr,bn=function e(t,i){var r=[],n=0,a=0,s=0,o=1/0,l=null,d=null;i=i||{},e.prototype.init.call(this),this.push=function(e){mn.collectDtsInfo(t,e),t&&vn.forEach((function(i){t[i]=e[i]})),r.push(e)},this.setEarliestDts=function(e){a=e},this.setVideoBaseMediaDecodeTime=function(e){o=e},this.setAudioAppendStart=function(e){s=e},this.processFrames_=function(){var e,h,u,c,p;0!==r.length&&0!==(e=gn.trimAdtsFramesByEarliestDts(r,t,a)).length&&(t.baseMediaDecodeTime=mn.calculateTrackBaseMediaDecodeTime(t,i.keepOriginalTimestamps),gn.prefixWithSilence(t,e,s,o),t.samples=gn.generateSampleTable(e),u=fn.mdat(gn.concatenateFrameData(e)),r=[],h=fn.moof(n,[t]),n++,t.initSegment=fn.initSegment([t]),(c=new Uint8Array(h.byteLength+u.byteLength)).set(h),c.set(u,h.byteLength),mn.clearDtsInfo(t),null===l&&(d=l=e[0].pts),d+=e.length*(1024*yn/t.samplerate),p={start:l},this.trigger("timingInfo",p),this.trigger("data",{track:t,boxes:c}))},this.flush=function(){this.processFrames_(),this.trigger("timingInfo",{start:l,end:d}),this.resetTiming_(),this.trigger("done","AudioSegmentStream")},this.partialFlush=function(){this.processFrames_(),this.trigger("partialdone","AudioSegmentStream")},this.endTimeline=function(){this.flush(),this.trigger("endedtimeline","AudioSegmentStream")},this.resetTiming_=function(){mn.clearDtsInfo(t),l=null,d=null},this.reset=function(){this.resetTiming_(),r=[],this.trigger("reset")}};bn.prototype=new Fe;var wn=bn,Sn=Ht,Tn=wi,En=ci,_n=br,kn=function e(t,i){var r,n,a,s=0,o=[],l=[],d=null,h=null,u=!0;i=i||{},e.prototype.init.call(this),this.push=function(e){Tn.collectDtsInfo(t,e),void 0===t.timelineStartInfo.dts&&(t.timelineStartInfo.dts=e.dts),"seq_parameter_set_rbsp"!==e.nalUnitType||r||(r=e.config,t.sps=[e.data],_n.forEach((function(e){t[e]=r[e]}),this)),"pic_parameter_set_rbsp"!==e.nalUnitType||n||(n=e.data,t.pps=[e.data]),o.push(e)},this.processNals_=function(e){var r;for(o=l.concat(o);o.length&&"access_unit_delimiter_rbsp"!==o[0].nalUnitType;)o.shift();if(0!==o.length){var n=En.groupNalsIntoFrames(o);if(n.length)if(l=n[n.length-1],e&&(n.pop(),n.duration-=l.duration,n.nalCount-=l.length,n.byteLength-=l.byteLength),n.length){if(this.trigger("timelineStartInfo",t.timelineStartInfo),u){if(!(a=En.groupFramesIntoGops(n))[0][0].keyFrame){if(!(a=En.extendFirstKeyFrame(a))[0][0].keyFrame)return o=[].concat.apply([],n).concat(l),void(l=[]);(n=[].concat.apply([],a)).duration=a.duration}u=!1}for(null===d&&(d=n[0].pts,h=d),h+=n.duration,this.trigger("timingInfo",{start:d,end:h}),r=0;r<n.length;r++){var c=n[r];t.samples=En.generateSampleTableForFrame(c);var p=Sn.mdat(En.concatenateNalDataForFrame(c));Tn.clearDtsInfo(t),Tn.collectDtsInfo(t,c),t.baseMediaDecodeTime=Tn.calculateTrackBaseMediaDecodeTime(t,i.keepOriginalTimestamps);var f=Sn.moof(s,[t]);s++,t.initSegment=Sn.initSegment([t]);var g=new Uint8Array(f.byteLength+p.byteLength);g.set(f),g.set(p,f.byteLength),this.trigger("data",{track:t,boxes:g,sequence:s,videoFrameDts:c.dts,videoFramePts:c.pts})}o=[]}else o=[]}},this.resetTimingAndConfig_=function(){r=void 0,n=void 0,d=null,h=null},this.partialFlush=function(){this.processNals_(!0),this.trigger("partialdone","VideoSegmentStream")},this.flush=function(){this.processNals_(!1),this.resetTimingAndConfig_(),this.trigger("done","VideoSegmentStream")},this.endTimeline=function(){this.flush(),this.trigger("endedtimeline","VideoSegmentStream")},this.reset=function(){this.resetTimingAndConfig_(),l=[],o=[],u=!0,this.trigger("reset")}};kn.prototype=new Fe;var Pn=Fe,An=sr,Ln=Nt,On=wn,Cn=kn,Rn=wi,In=ur.isLikelyAacData,xn=$e,Dn=yr,Un=je,Mn=function(e){return e.prototype=new Pn,e.prototype.init.call(e),e},Nn=function(e,t){e.on("data",t.trigger.bind(t,"data")),e.on("done",t.trigger.bind(t,"done")),e.on("partialdone",t.trigger.bind(t,"partialdone")),e.on("endedtimeline",t.trigger.bind(t,"endedtimeline")),e.on("audioTimingInfo",t.trigger.bind(t,"audioTimingInfo")),e.on("videoTimingInfo",t.trigger.bind(t,"videoTimingInfo")),e.on("trackinfo",t.trigger.bind(t,"trackinfo")),e.on("id3Frame",(function(i){i.dispatchType=e.metadataStream.dispatchType,i.cueTime=Un.videoTsToSeconds(i.pts),t.trigger("id3Frame",i)})),e.on("caption",(function(e){t.trigger("caption",e)}))},Fn=function e(t){var i=null,r=!0;t=t||{},e.prototype.init.call(this),t.baseMediaDecodeTime=t.baseMediaDecodeTime||0,this.push=function(e){if(r){var n=In(e);!n||i&&"aac"===i.type?n||i&&"ts"===i.type||(i=function(e){var t={type:"ts",tracks:{audio:null,video:null},packet:new An.TransportPacketStream,parse:new An.TransportParseStream,elementary:new An.ElementaryStream,timestampRollover:new An.TimestampRolloverStream,adts:new Ln.Adts,h264:new Ln.h264.H264Stream,captionStream:new An.CaptionStream(e),metadataStream:new An.MetadataStream};return t.headOfPipeline=t.packet,t.packet.pipe(t.parse).pipe(t.elementary).pipe(t.timestampRollover),t.timestampRollover.pipe(t.h264),t.h264.pipe(t.captionStream),t.timestampRollover.pipe(t.metadataStream),t.timestampRollover.pipe(t.adts),t.elementary.on("data",(function(i){if("metadata"===i.type){for(var r=0;r<i.tracks.length;r++)t.tracks[i.tracks[r].type]||(t.tracks[i.tracks[r].type]=i.tracks[r],t.tracks[i.tracks[r].type].timelineStartInfo.baseMediaDecodeTime=e.baseMediaDecodeTime);t.tracks.video&&!t.videoSegmentStream&&(t.videoSegmentStream=new Cn(t.tracks.video,e),t.videoSegmentStream.on("timelineStartInfo",(function(i){t.tracks.audio&&!e.keepOriginalTimestamps&&t.audioSegmentStream.setEarliestDts(i.dts-e.baseMediaDecodeTime)})),t.videoSegmentStream.on("timingInfo",t.trigger.bind(t,"videoTimingInfo")),t.videoSegmentStream.on("data",(function(e){t.trigger("data",{type:"video",data:e})})),t.videoSegmentStream.on("done",t.trigger.bind(t,"done")),t.videoSegmentStream.on("partialdone",t.trigger.bind(t,"partialdone")),t.videoSegmentStream.on("endedtimeline",t.trigger.bind(t,"endedtimeline")),t.h264.pipe(t.videoSegmentStream)),t.tracks.audio&&!t.audioSegmentStream&&(t.audioSegmentStream=new On(t.tracks.audio,e),t.audioSegmentStream.on("data",(function(e){t.trigger("data",{type:"audio",data:e})})),t.audioSegmentStream.on("done",t.trigger.bind(t,"done")),t.audioSegmentStream.on("partialdone",t.trigger.bind(t,"partialdone")),t.audioSegmentStream.on("endedtimeline",t.trigger.bind(t,"endedtimeline")),t.audioSegmentStream.on("timingInfo",t.trigger.bind(t,"audioTimingInfo")),t.adts.pipe(t.audioSegmentStream)),t.trigger("trackinfo",{hasAudio:!!t.tracks.audio,hasVideo:!!t.tracks.video})}})),t.captionStream.on("data",(function(i){var r;r=t.tracks.video&&t.tracks.video.timelineStartInfo.pts||0,i.startTime=Un.metadataTsToSeconds(i.startPts,r,e.keepOriginalTimestamps),i.endTime=Un.metadataTsToSeconds(i.endPts,r,e.keepOriginalTimestamps),t.trigger("caption",i)})),(t=Mn(t)).metadataStream.on("data",t.trigger.bind(t,"id3Frame")),t}(t),Nn(i,this)):(i=function(e){var t={type:"aac",tracks:{audio:null},metadataStream:new An.MetadataStream,aacStream:new Dn,audioRollover:new An.TimestampRolloverStream("audio"),timedMetadataRollover:new An.TimestampRolloverStream("timed-metadata"),adtsStream:new xn(!0)};return t.headOfPipeline=t.aacStream,t.aacStream.pipe(t.audioRollover).pipe(t.adtsStream),t.aacStream.pipe(t.timedMetadataRollover).pipe(t.metadataStream),t.metadataStream.on("timestamp",(function(e){t.aacStream.setTimestamp(e.timeStamp)})),t.aacStream.on("data",(function(i){"timed-metadata"!==i.type&&"audio"!==i.type||t.audioSegmentStream||(t.tracks.audio=t.tracks.audio||{timelineStartInfo:{baseMediaDecodeTime:e.baseMediaDecodeTime},codec:"adts",type:"audio"},t.audioSegmentStream=new On(t.tracks.audio,e),t.audioSegmentStream.on("data",(function(e){t.trigger("data",{type:"audio",data:e})})),t.audioSegmentStream.on("partialdone",t.trigger.bind(t,"partialdone")),t.audioSegmentStream.on("done",t.trigger.bind(t,"done")),t.audioSegmentStream.on("endedtimeline",t.trigger.bind(t,"endedtimeline")),t.audioSegmentStream.on("timingInfo",t.trigger.bind(t,"audioTimingInfo")),t.adtsStream.pipe(t.audioSegmentStream),t.trigger("trackinfo",{hasAudio:!!t.tracks.audio,hasVideo:!!t.tracks.video}))})),(t=Mn(t)).metadataStream.on("data",t.trigger.bind(t,"id3Frame")),t}(t),Nn(i,this)),r=!1}i.headOfPipeline.push(e)},this.flush=function(){i&&(r=!0,i.headOfPipeline.flush())},this.partialFlush=function(){i&&i.headOfPipeline.partialFlush()},this.endTimeline=function(){i&&i.headOfPipeline.endTimeline()},this.reset=function(){i&&i.headOfPipeline.reset()},this.setBaseMediaDecodeTime=function(e){t.keepOriginalTimestamps||(t.baseMediaDecodeTime=e),i&&(i.tracks.audio&&(i.tracks.audio.timelineStartInfo.dts=void 0,i.tracks.audio.timelineStartInfo.pts=void 0,Rn.clearDtsInfo(i.tracks.audio),i.audioRollover&&i.audioRollover.discontinuity()),i.tracks.video&&(i.videoSegmentStream&&(i.videoSegmentStream.gopCache_=[]),i.tracks.video.timelineStartInfo.dts=void 0,i.tracks.video.timelineStartInfo.pts=void 0,Rn.clearDtsInfo(i.tracks.video)),i.timestampRollover&&i.timestampRollover.discontinuity())},this.setRemux=function(e){t.remux=e,i&&i.coalesceStream&&i.coalesceStream.setRemux(e)},this.setAudioAppendStart=function(e){i&&i.tracks.audio&&i.audioSegmentStream&&i.audioSegmentStream.setAudioAppendStart(e)},this.alignGopsWith=function(e){}};Fn.prototype=new Pn;var Bn,Vn,jn={Transmuxer:Fn},zn=Math.pow(2,32),qn=function(e){var t=new DataView(e.buffer,e.byteOffset,e.byteLength),i={version:e[0],flags:new Uint8Array(e.subarray(1,4)),references:[],referenceId:t.getUint32(4),timescale:t.getUint32(8)},r=12;0===i.version?(i.earliestPresentationTime=t.getUint32(r),i.firstOffset=t.getUint32(r+4),r+=8):(i.earliestPresentationTime=t.getUint32(r)*zn+t.getUint32(r+4),i.firstOffset=t.getUint32(r+8)*zn+t.getUint32(r+12),r+=16),r+=2;var n=t.getUint16(r);for(r+=2;n>0;r+=12,n--)i.references.push({referenceType:(128&e[r])>>>7,referencedSize:2147483647&t.getUint32(r),subsegmentDuration:t.getUint32(r+4),startsWithSap:!!(128&e[r+8]),sapType:(112&e[r+8])>>>4,sapDeltaTime:268435455&t.getUint32(r+8)});return i},Gn=Math.pow(2,32),Hn=function(e){return new Date(1e3*e-20828448e5)},Wn=$t,$n=function(e){var t,i,r=new DataView(e.buffer,e.byteOffset,e.byteLength),n=[];for(t=0;t+4<e.length;t+=i)if(i=r.getUint32(t),t+=4,i<=0)n.push("<span style='color:red;'>MALFORMED DATA</span>");else switch(31&e[t]){case 1:n.push("slice_layer_without_partitioning_rbsp");break;case 5:n.push("slice_layer_without_partitioning_rbsp_idr");break;case 6:n.push("sei_rbsp");break;case 7:n.push("seq_parameter_set_rbsp");break;case 8:n.push("pic_parameter_set_rbsp");break;case 9:n.push("access_unit_delimiter_rbsp");break;default:n.push("UNKNOWN NAL - "+e[t]&31)}return n},Xn={avc1:function(e){var t=new DataView(e.buffer,e.byteOffset,e.byteLength);return{dataReferenceIndex:t.getUint16(6),width:t.getUint16(24),height:t.getUint16(26),horizresolution:t.getUint16(28)+t.getUint16(30)/16,vertresolution:t.getUint16(32)+t.getUint16(34)/16,frameCount:t.getUint16(40),depth:t.getUint16(74),config:Bn(e.subarray(78,e.byteLength))}},avcC:function(e){var t,i,r,n,a=new DataView(e.buffer,e.byteOffset,e.byteLength),s={configurationVersion:e[0],avcProfileIndication:e[1],profileCompatibility:e[2],avcLevelIndication:e[3],lengthSizeMinusOne:3&e[4],sps:[],pps:[]},o=31&e[5];for(r=6,n=0;n<o;n++)i=a.getUint16(r),r+=2,s.sps.push(new Uint8Array(e.subarray(r,r+i))),r+=i;for(t=e[r],r++,n=0;n<t;n++)i=a.getUint16(r),r+=2,s.pps.push(new Uint8Array(e.subarray(r,r+i))),r+=i;return s},btrt:function(e){var t=new DataView(e.buffer,e.byteOffset,e.byteLength);return{bufferSizeDB:t.getUint32(0),maxBitrate:t.getUint32(4),avgBitrate:t.getUint32(8)}},edts:function(e){return{boxes:Bn(e)}},elst:function(e){var t,i=new DataView(e.buffer,e.byteOffset,e.byteLength),r={version:i.getUint8(0),flags:new Uint8Array(e.subarray(1,4)),edits:[]},n=i.getUint32(4);for(t=8;n;n--)0===r.version?(r.edits.push({segmentDuration:i.getUint32(t),mediaTime:i.getInt32(t+4),mediaRate:i.getUint16(t+8)+i.getUint16(t+10)/65536}),t+=12):(r.edits.push({segmentDuration:i.getUint32(t)*Gn+i.getUint32(t+4),mediaTime:i.getUint32(t+8)*Gn+i.getUint32(t+12),mediaRate:i.getUint16(t+16)+i.getUint16(t+18)/65536}),t+=20);return r},esds:function(e){return{version:e[0],flags:new Uint8Array(e.subarray(1,4)),esId:e[6]<<8|e[7],streamPriority:31&e[8],decoderConfig:{objectProfileIndication:e[11],streamType:e[12]>>>2&63,bufferSize:e[13]<<16|e[14]<<8|e[15],maxBitrate:e[16]<<24|e[17]<<16|e[18]<<8|e[19],avgBitrate:e[20]<<24|e[21]<<16|e[22]<<8|e[23],decoderConfigDescriptor:{tag:e[24],length:e[25],audioObjectType:e[26]>>>3&31,samplingFrequencyIndex:(7&e[26])<<1|e[27]>>>7&1,channelConfiguration:e[27]>>>3&15}}}},ftyp:function(e){for(var t=new DataView(e.buffer,e.byteOffset,e.byteLength),i={majorBrand:Wn(e.subarray(0,4)),minorVersion:t.getUint32(4),compatibleBrands:[]},r=8;r<e.byteLength;)i.compatibleBrands.push(Wn(e.subarray(r,r+4))),r+=4;return i},dinf:function(e){return{boxes:Bn(e)}},dref:function(e){return{version:e[0],flags:new Uint8Array(e.subarray(1,4)),dataReferences:Bn(e.subarray(8))}},hdlr:function(e){var t={version:new DataView(e.buffer,e.byteOffset,e.byteLength).getUint8(0),flags:new Uint8Array(e.subarray(1,4)),handlerType:Wn(e.subarray(8,12)),name:""},i=8;for(i=24;i<e.byteLength;i++){if(0===e[i]){i++;break}t.name+=String.fromCharCode(e[i])}return t.name=decodeURIComponent(escape(t.name)),t},mdat:function(e){return{byteLength:e.byteLength,nals:$n(e)}},mdhd:function(e){var t,i=new DataView(e.buffer,e.byteOffset,e.byteLength),r=4,n={version:i.getUint8(0),flags:new Uint8Array(e.subarray(1,4)),language:""};return 1===n.version?(r+=4,n.creationTime=Hn(i.getUint32(r)),r+=8,n.modificationTime=Hn(i.getUint32(r)),r+=4,n.timescale=i.getUint32(r),r+=8,n.duration=i.getUint32(r)):(n.creationTime=Hn(i.getUint32(r)),r+=4,n.modificationTime=Hn(i.getUint32(r)),r+=4,n.timescale=i.getUint32(r),r+=4,n.duration=i.getUint32(r)),r+=4,t=i.getUint16(r),n.language+=String.fromCharCode(96+(t>>10)),n.language+=String.fromCharCode(96+((992&t)>>5)),n.language+=String.fromCharCode(96+(31&t)),n},mdia:function(e){return{boxes:Bn(e)}},mfhd:function(e){return{version:e[0],flags:new Uint8Array(e.subarray(1,4)),sequenceNumber:e[4]<<24|e[5]<<16|e[6]<<8|e[7]}},minf:function(e){return{boxes:Bn(e)}},mp4a:function(e){var t=new DataView(e.buffer,e.byteOffset,e.byteLength),i={dataReferenceIndex:t.getUint16(6),channelcount:t.getUint16(16),samplesize:t.getUint16(18),samplerate:t.getUint16(24)+t.getUint16(26)/65536};return e.byteLength>28&&(i.streamDescriptor=Bn(e.subarray(28))[0]),i},moof:function(e){return{boxes:Bn(e)}},moov:function(e){return{boxes:Bn(e)}},mvex:function(e){return{boxes:Bn(e)}},mvhd:function(e){var t=new DataView(e.buffer,e.byteOffset,e.byteLength),i=4,r={version:t.getUint8(0),flags:new Uint8Array(e.subarray(1,4))};return 1===r.version?(i+=4,r.creationTime=Hn(t.getUint32(i)),i+=8,r.modificationTime=Hn(t.getUint32(i)),i+=4,r.timescale=t.getUint32(i),i+=8,r.duration=t.getUint32(i)):(r.creationTime=Hn(t.getUint32(i)),i+=4,r.modificationTime=Hn(t.getUint32(i)),i+=4,r.timescale=t.getUint32(i),i+=4,r.duration=t.getUint32(i)),i+=4,r.rate=t.getUint16(i)+t.getUint16(i+2)/16,i+=4,r.volume=t.getUint8(i)+t.getUint8(i+1)/8,i+=2,i+=2,i+=8,r.matrix=new Uint32Array(e.subarray(i,i+36)),i+=36,i+=24,r.nextTrackId=t.getUint32(i),r},pdin:function(e){var t=new DataView(e.buffer,e.byteOffset,e.byteLength);return{version:t.getUint8(0),flags:new Uint8Array(e.subarray(1,4)),rate:t.getUint32(4),initialDelay:t.getUint32(8)}},sdtp:function(e){var t,i={version:e[0],flags:new Uint8Array(e.subarray(1,4)),samples:[]};for(t=4;t<e.byteLength;t++)i.samples.push({dependsOn:(48&e[t])>>4,isDependedOn:(12&e[t])>>2,hasRedundancy:3&e[t]});return i},sidx:qn,smhd:function(e){return{version:e[0],flags:new Uint8Array(e.subarray(1,4)),balance:e[4]+e[5]/256}},stbl:function(e){return{boxes:Bn(e)}},ctts:function(e){var t,i=new DataView(e.buffer,e.byteOffset,e.byteLength),r={version:i.getUint8(0),flags:new Uint8Array(e.subarray(1,4)),compositionOffsets:[]},n=i.getUint32(4);for(t=8;n;t+=8,n--)r.compositionOffsets.push({sampleCount:i.getUint32(t),sampleOffset:i[0===r.version?"getUint32":"getInt32"](t+4)});return r},stss:function(e){var t,i=new DataView(e.buffer,e.byteOffset,e.byteLength),r={version:i.getUint8(0),flags:new Uint8Array(e.subarray(1,4)),syncSamples:[]},n=i.getUint32(4);for(t=8;n;t+=4,n--)r.syncSamples.push(i.getUint32(t));return r},stco:function(e){var t,i=new DataView(e.buffer,e.byteOffset,e.byteLength),r={version:e[0],flags:new Uint8Array(e.subarray(1,4)),chunkOffsets:[]},n=i.getUint32(4);for(t=8;n;t+=4,n--)r.chunkOffsets.push(i.getUint32(t));return r},stsc:function(e){var t,i=new DataView(e.buffer,e.byteOffset,e.byteLength),r=i.getUint32(4),n={version:e[0],flags:new Uint8Array(e.subarray(1,4)),sampleToChunks:[]};for(t=8;r;t+=12,r--)n.sampleToChunks.push({firstChunk:i.getUint32(t),samplesPerChunk:i.getUint32(t+4),sampleDescriptionIndex:i.getUint32(t+8)});return n},stsd:function(e){return{version:e[0],flags:new Uint8Array(e.subarray(1,4)),sampleDescriptions:Bn(e.subarray(8))}},stsz:function(e){var t,i=new DataView(e.buffer,e.byteOffset,e.byteLength),r={version:e[0],flags:new Uint8Array(e.subarray(1,4)),sampleSize:i.getUint32(4),entries:[]};for(t=12;t<e.byteLength;t+=4)r.entries.push(i.getUint32(t));return r},stts:function(e){var t,i=new DataView(e.buffer,e.byteOffset,e.byteLength),r={version:e[0],flags:new Uint8Array(e.subarray(1,4)),timeToSamples:[]},n=i.getUint32(4);for(t=8;n;t+=8,n--)r.timeToSamples.push({sampleCount:i.getUint32(t),sampleDelta:i.getUint32(t+4)});return r},styp:function(e){return Xn.ftyp(e)},tfdt:ti,tfhd:Kt,tkhd:function(e){var t=new DataView(e.buffer,e.byteOffset,e.byteLength),i=4,r={version:t.getUint8(0),flags:new Uint8Array(e.subarray(1,4))};return 1===r.version?(i+=4,r.creationTime=Hn(t.getUint32(i)),i+=8,r.modificationTime=Hn(t.getUint32(i)),i+=4,r.trackId=t.getUint32(i),i+=4,i+=8,r.duration=t.getUint32(i)):(r.creationTime=Hn(t.getUint32(i)),i+=4,r.modificationTime=Hn(t.getUint32(i)),i+=4,r.trackId=t.getUint32(i),i+=4,i+=4,r.duration=t.getUint32(i)),i+=4,i+=8,r.layer=t.getUint16(i),i+=2,r.alternateGroup=t.getUint16(i),i+=2,r.volume=t.getUint8(i)+t.getUint8(i+1)/8,i+=2,i+=2,r.matrix=new Uint32Array(e.subarray(i,i+36)),i+=36,r.width=t.getUint16(i)+t.getUint16(i+2)/65536,i+=4,r.height=t.getUint16(i)+t.getUint16(i+2)/65536,r},traf:function(e){return{boxes:Bn(e)}},trak:function(e){return{boxes:Bn(e)}},trex:function(e){var t=new DataView(e.buffer,e.byteOffset,e.byteLength);return{version:e[0],flags:new Uint8Array(e.subarray(1,4)),trackId:t.getUint32(4),defaultSampleDescriptionIndex:t.getUint32(8),defaultSampleDuration:t.getUint32(12),defaultSampleSize:t.getUint32(16),sampleDependsOn:3&e[20],sampleIsDependedOn:(192&e[21])>>6,sampleHasRedundancy:(48&e[21])>>4,samplePaddingValue:(14&e[21])>>1,sampleIsDifferenceSample:!!(1&e[21]),sampleDegradationPriority:t.getUint16(22)}},trun:Jt,"url ":function(e){return{version:e[0],flags:new Uint8Array(e.subarray(1,4))}},vmhd:function(e){var t=new DataView(e.buffer,e.byteOffset,e.byteLength);return{version:e[0],flags:new Uint8Array(e.subarray(1,4)),graphicsmode:t.getUint16(4),opcolor:new Uint16Array([t.getUint16(6),t.getUint16(8),t.getUint16(10)])}}},Qn={inspect:Bn=function(e){for(var t,i,r,n,a,s=0,o=[],l=new ArrayBuffer(e.length),d=new Uint8Array(l),h=0;h<e.length;++h)d[h]=e[h];for(t=new DataView(l);s<e.byteLength;)i=t.getUint32(s),r=Wn(e.subarray(s+4,s+8)),n=i>1?s+i:e.byteLength,(a=(Xn[r]||function(e){return{data:e}})(e.subarray(s+8,n))).size=i,a.type=r,o.push(a),s=n;return o},textify:Vn=function(e,t){var i;return t=t||0,i=new Array(2*t+1).join(" "),e.map((function(e,r){return i+e.type+"\n"+Object.keys(e).filter((function(e){return"type"!==e&&"boxes"!==e})).map((function(t){var r=i+"  "+t+": ",n=e[t];if(n instanceof Uint8Array||n instanceof Uint32Array){var a=Array.prototype.slice.call(new Uint8Array(n.buffer,n.byteOffset,n.byteLength)).map((function(e){return" "+("00"+e.toString(16)).slice(-2)})).join("").match(/.{1,24}/g);return a?1===a.length?r+"<"+a.join("").slice(1)+">":r+"<\n"+a.map((function(e){return i+"  "+e})).join("\n")+"\n"+i+"  >":r+"<>"}return r+JSON.stringify(n,null,2).split("\n").map((function(e,t){return 0===t?e:i+"  "+e})).join("\n")})).join("\n")+(e.boxes?"\n"+Vn(e.boxes,t+1):"")})).join("\n")},parseType:Wn,findBox:Yt,parseTraf:Xn.traf,parseTfdt:Xn.tfdt,parseHdlr:Xn.hdlr,parseTfhd:Xn.tfhd,parseTrun:Xn.trun,parseSidx:Xn.sidx},Yn={8:"audio",9:"video",18:"metadata"},Kn=function(e){for(var t,i=[];e.byteLength>0;)t=0,i.push("0x"+("00"+e[t++].toString(16)).slice(-2).toUpperCase()),e=e.subarray(1);return i.join(" ")},Zn=function(e,t){var i=e[0]&parseInt("00001111",2);return(t=t||{}).frameType=["Unknown","Keyframe (for AVC, a seekable frame)","Inter frame (for AVC, a nonseekable frame)","Disposable inter frame (H.263 only)","Generated keyframe (reserved for server use only)","Video info/command frame"][(e[0]&parseInt("11110000",2))>>>4],t.codecID=i,7===i?function(e,t){var i=e[1]&parseInt("01111111",2)<<16|e[2]<<8|e[3];return(t=t||{}).avcPacketType=["AVC Sequence Header","AVC NALU","AVC End-of-Sequence"][e[0]],t.CompositionTime=e[1]&parseInt("10000000",2)?-i:i,1===e[0]?t.nalUnitTypeRaw=Kn(e.subarray(4,100)):t.data=Kn(e.subarray(4)),t}(e.subarray(1),t):t},Jn=function(e,t){var i=(e[0]&parseInt("11110000",2))>>>4;return(t=t||{}).soundFormat=["Linear PCM, platform endian","ADPCM","MP3","Linear PCM, little endian","Nellymoser 16-kHz mono","Nellymoser 8-kHz mono","Nellymoser","G.711 A-law logarithmic PCM","G.711 mu-law logarithmic PCM","reserved","AAC","Speex","MP3 8-Khz","Device-specific sound"][i],t.soundRate=["5.5-kHz","11-kHz","22-kHz","44-kHz"][(e[0]&parseInt("00001100",2))>>>2],t.soundSize=(e[0]&parseInt("00000010",2))>>>1?"16-bit":"8-bit",t.soundType=e[0]&parseInt("00000001",2)?"Stereo":"Mono",10===i?function(e,t){return(t=t||{}).aacPacketType=["AAC Sequence Header","AAC Raw"][e[0]],t.data=Kn(e.subarray(1)),t}(e.subarray(1),t):t},ea=function(e){var t=function(e){return{tagType:Yn[e[0]],dataSize:e[1]<<16|e[2]<<8|e[3],timestamp:e[7]<<24|e[4]<<16|e[5]<<8|e[6],streamID:e[8]<<16|e[9]<<8|e[10]}}(e);switch(e[0]){case 8:Jn(e.subarray(11),t);break;case 9:Zn(e.subarray(11),t)}return t},ta={inspectTag:ea,inspect:function(e){var t,i,r=9,n=[];for(r+=4;r<e.byteLength;)t=e[r+1]<<16,t|=e[r+2]<<8,t|=e[r+3],t+=11,i=e.subarray(r,r+t),n.push(ea(i)),r+=t+4;return n},textify:function(e){return JSON.stringify(e,null,2)}},ia=Mi,ra=function(e){var t=31&e[1];return t<<=8,t|=e[2]},na=function(e){return!!(64&e[1])},aa=function(e){var t=0;return(48&e[3])>>>4>1&&(t+=e[4]+1),t},sa=function(e){switch(e){case 5:return"slice_layer_without_partitioning_rbsp_idr";case 6:return"sei_rbsp";case 7:return"seq_parameter_set_rbsp";case 8:return"pic_parameter_set_rbsp";case 9:return"access_unit_delimiter_rbsp";default:return null}},oa={parseType:function(e,t){var i=ra(e);return 0===i?"pat":i===t?"pmt":t?"pes":null},parsePat:function(e){var t=na(e),i=4+aa(e);return t&&(i+=e[i]+1),(31&e[i+10])<<8|e[i+11]},parsePmt:function(e){var t={},i=na(e),r=4+aa(e);if(i&&(r+=e[r]+1),1&e[r+5]){var n;n=3+((15&e[r+1])<<8|e[r+2])-4;for(var a=12+((15&e[r+10])<<8|e[r+11]);a<n;){var s=r+a;t[(31&e[s+1])<<8|e[s+2]]=e[s],a+=5+((15&e[s+3])<<8|e[s+4])}return t}},parsePayloadUnitStartIndicator:na,parsePesType:function(e,t){switch(t[ra(e)]){case ia.H264_STREAM_TYPE:return"video";case ia.ADTS_STREAM_TYPE:return"audio";case ia.METADATA_STREAM_TYPE:return"timed-metadata";default:return null}},parsePesTime:function(e){if(!na(e))return null;var t=4+aa(e);if(t>=e.byteLength)return null;var i,r=null;return 192&(i=e[t+7])&&((r={}).pts=(14&e[t+9])<<27|(255&e[t+10])<<20|(254&e[t+11])<<12|(255&e[t+12])<<5|(254&e[t+13])>>>3,r.pts*=4,r.pts+=(6&e[t+13])>>>1,r.dts=r.pts,64&i&&(r.dts=(14&e[t+14])<<27|(255&e[t+15])<<20|(254&e[t+16])<<12|(255&e[t+17])<<5|(254&e[t+18])>>>3,r.dts*=4,r.dts+=(6&e[t+18])>>>1)),r},videoPacketContainsKeyFrame:function(e){for(var t=4+aa(e),i=e.subarray(t),r=0,n=0,a=!1;n<i.byteLength-3;n++)if(1===i[n+2]){r=n+5;break}for(;r<i.byteLength;)switch(i[r]){case 0:if(0!==i[r-1]){r+=2;break}if(0!==i[r-2]){r++;break}n+3!==r-2&&"slice_layer_without_partitioning_rbsp_idr"===sa(31&i[n+3])&&(a=!0);do{r++}while(1!==i[r]&&r<i.length);n=r-2,r+=3;break;case 1:if(0!==i[r-1]||0!==i[r-2]){r+=3;break}"slice_layer_without_partitioning_rbsp_idr"===sa(31&i[n+3])&&(a=!0),n=r-2,r+=3;break;default:r+=3}return i=i.subarray(n),r-=n,n=0,i&&i.byteLength>3&&"slice_layer_without_partitioning_rbsp_idr"===sa(31&i[n+3])&&(a=!0),a}},la=Mi,da=zi,ha={};ha.ts=oa,ha.aac=ur;var ua=je.ONE_SECOND_IN_TS,ca=188,pa=71,fa=function(e,t,i){for(var r,n,a,s,o=0,l=ca,d=!1;l<=e.byteLength;)if(e[o]!==pa||e[l]!==pa&&l!==e.byteLength)o++,l++;else{switch(r=e.subarray(o,l),ha.ts.parseType(r,t.pid)){case"pes":n=ha.ts.parsePesType(r,t.table),a=ha.ts.parsePayloadUnitStartIndicator(r),"audio"===n&&a&&(s=ha.ts.parsePesTime(r))&&(s.type="audio",i.audio.push(s),d=!0)}if(d)break;o+=ca,l+=ca}for(o=(l=e.byteLength)-ca,d=!1;o>=0;)if(e[o]!==pa||e[l]!==pa&&l!==e.byteLength)o--,l--;else{switch(r=e.subarray(o,l),ha.ts.parseType(r,t.pid)){case"pes":n=ha.ts.parsePesType(r,t.table),a=ha.ts.parsePayloadUnitStartIndicator(r),"audio"===n&&a&&(s=ha.ts.parsePesTime(r))&&(s.type="audio",i.audio.push(s),d=!0)}if(d)break;o-=ca,l-=ca}},ga=function(e,t,i){for(var r,n,a,s,o,l,d,h=0,u=ca,c=!1,p={data:[],size:0};u<e.byteLength;)if(e[h]!==pa||e[u]!==pa)h++,u++;else{switch(r=e.subarray(h,u),ha.ts.parseType(r,t.pid)){case"pes":if(n=ha.ts.parsePesType(r,t.table),a=ha.ts.parsePayloadUnitStartIndicator(r),"video"===n&&(a&&!c&&(s=ha.ts.parsePesTime(r))&&(s.type="video",i.video.push(s),c=!0),!i.firstKeyFrame)){if(a&&0!==p.size){for(o=new Uint8Array(p.size),l=0;p.data.length;)d=p.data.shift(),o.set(d,l),l+=d.byteLength;if(ha.ts.videoPacketContainsKeyFrame(o)){var f=ha.ts.parsePesTime(o);f?(i.firstKeyFrame=f,i.firstKeyFrame.type="video"):console.warn("Failed to extract PTS/DTS from PES at first keyframe. This could be an unusual TS segment, or else mux.js did not parse your TS segment correctly. If you know your TS segments do contain PTS/DTS on keyframes please file a bug report! You can try ffprobe to double check for yourself.")}p.size=0}p.data.push(r),p.size+=r.byteLength}}if(c&&i.firstKeyFrame)break;h+=ca,u+=ca}for(h=(u=e.byteLength)-ca,c=!1;h>=0;)if(e[h]!==pa||e[u]!==pa)h--,u--;else{switch(r=e.subarray(h,u),ha.ts.parseType(r,t.pid)){case"pes":n=ha.ts.parsePesType(r,t.table),a=ha.ts.parsePayloadUnitStartIndicator(r),"video"===n&&a&&(s=ha.ts.parsePesTime(r))&&(s.type="video",i.video.push(s),c=!0)}if(c)break;h-=ca,u-=ca}},ma=function(e){var t={pid:null,table:null},i={};for(var r in function(e,t){for(var i,r=0,n=ca;n<e.byteLength;)if(e[r]!==pa||e[n]!==pa)r++,n++;else{switch(i=e.subarray(r,n),ha.ts.parseType(i,t.pid)){case"pat":t.pid=ha.ts.parsePat(i);break;case"pmt":var a=ha.ts.parsePmt(i);t.table=t.table||{},Object.keys(a).forEach((function(e){t.table[e]=a[e]}))}r+=ca,n+=ca}}(e,t),t.table){if(t.table.hasOwnProperty(r))switch(t.table[r]){case la.H264_STREAM_TYPE:i.video=[],ga(e,t,i),0===i.video.length&&delete i.video;break;case la.ADTS_STREAM_TYPE:i.audio=[],fa(e,t,i),0===i.audio.length&&delete i.audio}}return i},ya={inspect:function(e,t){var i;return(i=ha.aac.isLikelyAacData(e)?function(e){for(var t,i=!1,r=0,n=null,a=null,s=0,o=0;e.length-o>=3;){switch(ha.aac.parseType(e,o)){case"timed-metadata":if(e.length-o<10){i=!0;break}if((s=ha.aac.parseId3TagSize(e,o))>e.length){i=!0;break}null===a&&(t=e.subarray(o,o+s),a=ha.aac.parseAacTimestamp(t)),o+=s;break;case"audio":if(e.length-o<7){i=!0;break}if((s=ha.aac.parseAdtsSize(e,o))>e.length){i=!0;break}null===n&&(t=e.subarray(o,o+s),n=ha.aac.parseSampleRate(t)),r++,o+=s;break;default:o++}if(i)return null}if(null===n||null===a)return null;var l=ua/n;return{audio:[{type:"audio",dts:a,pts:a},{type:"audio",dts:a+1024*r*l,pts:a+1024*r*l}]}}(e):ma(e))&&(i.audio||i.video)?(function(e,t){if(e.audio&&e.audio.length){var i=t;(void 0===i||isNaN(i))&&(i=e.audio[0].dts),e.audio.forEach((function(e){e.dts=da(e.dts,i),e.pts=da(e.pts,i),e.dtsTime=e.dts/ua,e.ptsTime=e.pts/ua}))}if(e.video&&e.video.length){var r=t;if((void 0===r||isNaN(r))&&(r=e.video[0].dts),e.video.forEach((function(e){e.dts=da(e.dts,r),e.pts=da(e.pts,r),e.dtsTime=e.dts/ua,e.ptsTime=e.pts/ua})),e.firstKeyFrame){var n=e.firstKeyFrame;n.dts=da(n.dts,r),n.pts=da(n.pts,r),n.dtsTime=n.dts/ua,n.ptsTime=n.pts/ua}}}(i,t),i):null},parseAudioPes_:fa},va={codecs:Nt,mp4:Xr,flv:cn,mp2t:pn,partial:jn};va.mp4.tools=Qn,va.flv.tools=ta,va.mp2t.tools=ya;var ba=va;class wa{constructor(e){this.remuxedSegments=[],this.remuxedInitSegment=null,this.translate=e=>{this.transmuxer.push(new Uint8Array(e.arrayBuffer)),this.transmuxer.flush()},this.onMuxedData=e=>{let t;this.remuxedSegments.push(e),this.remuxedInitSegment?t=new Uint8Array(e.data):(this.remuxedInitSegment=e.initSegment,t=new Uint8Array(e.initSegment.byteLength+e.data.byteLength),t.set(e.initSegment,0),t.set(e.data,e.initSegment.byteLength)),this.hls.emit(ke.Muxed,t)},this.hls=e,this.transmuxer=new ba.mp4.Transmuxer,this.transmuxer.on("data",this.onMuxedData),this.register()}register(){this.hls.on(ke.TsLoaded,this.translate)}}function Sa(e,t){return(Sa=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Ta(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,Sa(e,t)}var Ea=function(){function e(){this.listeners={}}var t=e.prototype;return t.on=function(e,t){this.listeners[e]||(this.listeners[e]=[]),this.listeners[e].push(t)},t.off=function(e,t){if(!this.listeners[e])return!1;var i=this.listeners[e].indexOf(t);return this.listeners[e]=this.listeners[e].slice(0),this.listeners[e].splice(i,1),i>-1},t.trigger=function(e){var t=this.listeners[e];if(t)if(2===arguments.length)for(var i=t.length,r=0;r<i;++r)t[r].call(this,arguments[1]);else for(var n=Array.prototype.slice.call(arguments,1),a=t.length,s=0;s<a;++s)t[s].apply(this,n)},t.dispose=function(){this.listeners={}},t.pipe=function(e){this.on("data",(function(t){e.push(t)}))},e}();function _a(){return(_a=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var r in i)Object.prototype.hasOwnProperty.call(i,r)&&(e[r]=i[r])}return e}).apply(this,arguments)}var ka="undefined"!=typeof window?window:void 0!==g?g:"undefined"!=typeof self?self:{};function Pa(e){for(var t,i=(t=e,ka.atob?ka.atob(t):Buffer.from(t,"base64").toString("binary")),r=new Uint8Array(i.length),n=0;n<i.length;n++)r[n]=i.charCodeAt(n);return r}
/*! @name m3u8-parser @version 4.7.0 @license Apache-2.0 */var Aa=function(e){function t(){var t;return(t=e.call(this)||this).buffer="",t}return Ta(t,e),t.prototype.push=function(e){var t;for(this.buffer+=e,t=this.buffer.indexOf("\n");t>-1;t=this.buffer.indexOf("\n"))this.trigger("data",this.buffer.substring(0,t)),this.buffer=this.buffer.substring(t+1)},t}(Ea),La=String.fromCharCode(9),Oa=function(e){var t=/([0-9.]*)?@?([0-9.]*)?/.exec(e||""),i={};return t[1]&&(i.length=parseInt(t[1],10)),t[2]&&(i.offset=parseInt(t[2],10)),i},Ca=function(e){for(var t,i=e.split(new RegExp('(?:^|,)((?:[^=]*)=(?:"[^"]*"|[^,]*))')),r={},n=i.length;n--;)""!==i[n]&&((t=/([^=]*)=(.*)/.exec(i[n]).slice(1))[0]=t[0].replace(/^\s+|\s+$/g,""),t[1]=t[1].replace(/^\s+|\s+$/g,""),t[1]=t[1].replace(/^['"](.*)['"]$/g,"$1"),r[t[0]]=t[1]);return r},Ra=function(e){function t(){var t;return(t=e.call(this)||this).customParsers=[],t.tagMappers=[],t}Ta(t,e);var i=t.prototype;return i.push=function(e){var t,i,r=this;0!==(e=e.trim()).length&&("#"===e[0]?this.tagMappers.reduce((function(t,i){var r=i(e);return r===e?t:t.concat([r])}),[e]).forEach((function(e){for(var n=0;n<r.customParsers.length;n++)if(r.customParsers[n].call(r,e))return;if(0===e.indexOf("#EXT"))if(e=e.replace("\r",""),t=/^#EXTM3U/.exec(e))r.trigger("data",{type:"tag",tagType:"m3u"});else{if(t=/^#EXTINF:?([0-9\.]*)?,?(.*)?$/.exec(e))return i={type:"tag",tagType:"inf"},t[1]&&(i.duration=parseFloat(t[1])),t[2]&&(i.title=t[2]),void r.trigger("data",i);if(t=/^#EXT-X-TARGETDURATION:?([0-9.]*)?/.exec(e))return i={type:"tag",tagType:"targetduration"},t[1]&&(i.duration=parseInt(t[1],10)),void r.trigger("data",i);if(t=/^#EXT-X-VERSION:?([0-9.]*)?/.exec(e))return i={type:"tag",tagType:"version"},t[1]&&(i.version=parseInt(t[1],10)),void r.trigger("data",i);if(t=/^#EXT-X-MEDIA-SEQUENCE:?(\-?[0-9.]*)?/.exec(e))return i={type:"tag",tagType:"media-sequence"},t[1]&&(i.number=parseInt(t[1],10)),void r.trigger("data",i);if(t=/^#EXT-X-DISCONTINUITY-SEQUENCE:?(\-?[0-9.]*)?/.exec(e))return i={type:"tag",tagType:"discontinuity-sequence"},t[1]&&(i.number=parseInt(t[1],10)),void r.trigger("data",i);if(t=/^#EXT-X-PLAYLIST-TYPE:?(.*)?$/.exec(e))return i={type:"tag",tagType:"playlist-type"},t[1]&&(i.playlistType=t[1]),void r.trigger("data",i);if(t=/^#EXT-X-BYTERANGE:?(.*)?$/.exec(e))return i=_a(Oa(t[1]),{type:"tag",tagType:"byterange"}),void r.trigger("data",i);if(t=/^#EXT-X-ALLOW-CACHE:?(YES|NO)?/.exec(e))return i={type:"tag",tagType:"allow-cache"},t[1]&&(i.allowed=!/NO/.test(t[1])),void r.trigger("data",i);if(t=/^#EXT-X-MAP:?(.*)$/.exec(e)){if(i={type:"tag",tagType:"map"},t[1]){var a=Ca(t[1]);a.URI&&(i.uri=a.URI),a.BYTERANGE&&(i.byterange=Oa(a.BYTERANGE))}r.trigger("data",i)}else if(t=/^#EXT-X-STREAM-INF:?(.*)$/.exec(e)){if(i={type:"tag",tagType:"stream-inf"},t[1]){if(i.attributes=Ca(t[1]),i.attributes.RESOLUTION){var s=i.attributes.RESOLUTION.split("x"),o={};s[0]&&(o.width=parseInt(s[0],10)),s[1]&&(o.height=parseInt(s[1],10)),i.attributes.RESOLUTION=o}i.attributes.BANDWIDTH&&(i.attributes.BANDWIDTH=parseInt(i.attributes.BANDWIDTH,10)),i.attributes["PROGRAM-ID"]&&(i.attributes["PROGRAM-ID"]=parseInt(i.attributes["PROGRAM-ID"],10))}r.trigger("data",i)}else{if(t=/^#EXT-X-MEDIA:?(.*)$/.exec(e))return i={type:"tag",tagType:"media"},t[1]&&(i.attributes=Ca(t[1])),void r.trigger("data",i);if(t=/^#EXT-X-ENDLIST/.exec(e))r.trigger("data",{type:"tag",tagType:"endlist"});else if(t=/^#EXT-X-DISCONTINUITY/.exec(e))r.trigger("data",{type:"tag",tagType:"discontinuity"});else{if(t=/^#EXT-X-PROGRAM-DATE-TIME:?(.*)$/.exec(e))return i={type:"tag",tagType:"program-date-time"},t[1]&&(i.dateTimeString=t[1],i.dateTimeObject=new Date(t[1])),void r.trigger("data",i);if(t=/^#EXT-X-KEY:?(.*)$/.exec(e))return i={type:"tag",tagType:"key"},t[1]&&(i.attributes=Ca(t[1]),i.attributes.IV&&("0x"===i.attributes.IV.substring(0,2).toLowerCase()&&(i.attributes.IV=i.attributes.IV.substring(2)),i.attributes.IV=i.attributes.IV.match(/.{8}/g),i.attributes.IV[0]=parseInt(i.attributes.IV[0],16),i.attributes.IV[1]=parseInt(i.attributes.IV[1],16),i.attributes.IV[2]=parseInt(i.attributes.IV[2],16),i.attributes.IV[3]=parseInt(i.attributes.IV[3],16),i.attributes.IV=new Uint32Array(i.attributes.IV))),void r.trigger("data",i);if(t=/^#EXT-X-START:?(.*)$/.exec(e))return i={type:"tag",tagType:"start"},t[1]&&(i.attributes=Ca(t[1]),i.attributes["TIME-OFFSET"]=parseFloat(i.attributes["TIME-OFFSET"]),i.attributes.PRECISE=/YES/.test(i.attributes.PRECISE)),void r.trigger("data",i);if(t=/^#EXT-X-CUE-OUT-CONT:?(.*)?$/.exec(e))return i={type:"tag",tagType:"cue-out-cont"},t[1]?i.data=t[1]:i.data="",void r.trigger("data",i);if(t=/^#EXT-X-CUE-OUT:?(.*)?$/.exec(e))return i={type:"tag",tagType:"cue-out"},t[1]?i.data=t[1]:i.data="",void r.trigger("data",i);if(t=/^#EXT-X-CUE-IN:?(.*)?$/.exec(e))return i={type:"tag",tagType:"cue-in"},t[1]?i.data=t[1]:i.data="",void r.trigger("data",i);if((t=/^#EXT-X-SKIP:(.*)$/.exec(e))&&t[1])return(i={type:"tag",tagType:"skip"}).attributes=Ca(t[1]),i.attributes.hasOwnProperty("SKIPPED-SEGMENTS")&&(i.attributes["SKIPPED-SEGMENTS"]=parseInt(i.attributes["SKIPPED-SEGMENTS"],10)),i.attributes.hasOwnProperty("RECENTLY-REMOVED-DATERANGES")&&(i.attributes["RECENTLY-REMOVED-DATERANGES"]=i.attributes["RECENTLY-REMOVED-DATERANGES"].split(La)),void r.trigger("data",i);if((t=/^#EXT-X-PART:(.*)$/.exec(e))&&t[1])return(i={type:"tag",tagType:"part"}).attributes=Ca(t[1]),["DURATION"].forEach((function(e){i.attributes.hasOwnProperty(e)&&(i.attributes[e]=parseFloat(i.attributes[e]))})),["INDEPENDENT","GAP"].forEach((function(e){i.attributes.hasOwnProperty(e)&&(i.attributes[e]=/YES/.test(i.attributes[e]))})),i.attributes.hasOwnProperty("BYTERANGE")&&(i.attributes.byterange=Oa(i.attributes.BYTERANGE)),void r.trigger("data",i);if((t=/^#EXT-X-SERVER-CONTROL:(.*)$/.exec(e))&&t[1])return(i={type:"tag",tagType:"server-control"}).attributes=Ca(t[1]),["CAN-SKIP-UNTIL","PART-HOLD-BACK","HOLD-BACK"].forEach((function(e){i.attributes.hasOwnProperty(e)&&(i.attributes[e]=parseFloat(i.attributes[e]))})),["CAN-SKIP-DATERANGES","CAN-BLOCK-RELOAD"].forEach((function(e){i.attributes.hasOwnProperty(e)&&(i.attributes[e]=/YES/.test(i.attributes[e]))})),void r.trigger("data",i);if((t=/^#EXT-X-PART-INF:(.*)$/.exec(e))&&t[1])return(i={type:"tag",tagType:"part-inf"}).attributes=Ca(t[1]),["PART-TARGET"].forEach((function(e){i.attributes.hasOwnProperty(e)&&(i.attributes[e]=parseFloat(i.attributes[e]))})),void r.trigger("data",i);if((t=/^#EXT-X-PRELOAD-HINT:(.*)$/.exec(e))&&t[1])return(i={type:"tag",tagType:"preload-hint"}).attributes=Ca(t[1]),["BYTERANGE-START","BYTERANGE-LENGTH"].forEach((function(e){if(i.attributes.hasOwnProperty(e)){i.attributes[e]=parseInt(i.attributes[e],10);var t="BYTERANGE-LENGTH"===e?"length":"offset";i.attributes.byterange=i.attributes.byterange||{},i.attributes.byterange[t]=i.attributes[e],delete i.attributes[e]}})),void r.trigger("data",i);if((t=/^#EXT-X-RENDITION-REPORT:(.*)$/.exec(e))&&t[1])return(i={type:"tag",tagType:"rendition-report"}).attributes=Ca(t[1]),["LAST-MSN","LAST-PART"].forEach((function(e){i.attributes.hasOwnProperty(e)&&(i.attributes[e]=parseInt(i.attributes[e],10))})),void r.trigger("data",i);r.trigger("data",{type:"tag",data:e.slice(4)})}}}else r.trigger("data",{type:"comment",text:e.slice(1)})})):this.trigger("data",{type:"uri",uri:e}))},i.addParser=function(e){var t=this,i=e.expression,r=e.customType,n=e.dataParser,a=e.segment;"function"!=typeof n&&(n=function(e){return e}),this.customParsers.push((function(e){if(i.exec(e))return t.trigger("data",{type:"custom",data:n(e),customType:r,segment:a}),!0}))},i.addTagMapper=function(e){var t=e.expression,i=e.map;this.tagMappers.push((function(e){return t.test(e)?i(e):e}))},t}(Ea),Ia=function(e){var t={};return Object.keys(e).forEach((function(i){var r;t[(r=i,r.toLowerCase().replace(/-(\w)/g,(function(e){return e[1].toUpperCase()})))]=e[i]})),t},xa=function(e){var t=e.serverControl,i=e.targetDuration,r=e.partTargetDuration;if(t){var n="#EXT-X-SERVER-CONTROL",a="holdBack",s="partHoldBack",o=i&&3*i,l=r&&2*r;i&&!t.hasOwnProperty(a)&&(t[a]=o,this.trigger("info",{message:n+" defaulting HOLD-BACK to targetDuration * 3 ("+o+")."})),o&&t[a]<o&&(this.trigger("warn",{message:n+" clamping HOLD-BACK ("+t[a]+") to targetDuration * 3 ("+o+")"}),t[a]=o),r&&!t.hasOwnProperty(s)&&(t[s]=3*r,this.trigger("info",{message:n+" defaulting PART-HOLD-BACK to partTargetDuration * 3 ("+t[s]+")."})),r&&t[s]<l&&(this.trigger("warn",{message:n+" clamping PART-HOLD-BACK ("+t[s]+") to partTargetDuration * 2 ("+l+")."}),t[s]=l)}},Da=function(e){function t(){var t;(t=e.call(this)||this).lineStream=new Aa,t.parseStream=new Ra,t.lineStream.pipe(t.parseStream);var i,r,n=function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(t),a=[],s={},o=!1,l=function(){},d={AUDIO:{},VIDEO:{},"CLOSED-CAPTIONS":{},SUBTITLES:{}},h=0;t.manifest={allowCache:!0,discontinuityStarts:[],segments:[]};var u=0,c=0;return t.on("end",(function(){s.uri||!s.parts&&!s.preloadHints||(!s.map&&i&&(s.map=i),!s.key&&r&&(s.key=r),s.timeline||"number"!=typeof h||(s.timeline=h),t.manifest.preloadSegment=s)})),t.parseStream.on("data",(function(e){var t,p;({tag:function(){({version:function(){e.version&&(this.manifest.version=e.version)},"allow-cache":function(){this.manifest.allowCache=e.allowed,"allowed"in e||(this.trigger("info",{message:"defaulting allowCache to YES"}),this.manifest.allowCache=!0)},byterange:function(){var t={};"length"in e&&(s.byterange=t,t.length=e.length,"offset"in e||(e.offset=u)),"offset"in e&&(s.byterange=t,t.offset=e.offset),u=t.offset+t.length},endlist:function(){this.manifest.endList=!0},inf:function(){"mediaSequence"in this.manifest||(this.manifest.mediaSequence=0,this.trigger("info",{message:"defaulting media sequence to zero"})),"discontinuitySequence"in this.manifest||(this.manifest.discontinuitySequence=0,this.trigger("info",{message:"defaulting discontinuity sequence to zero"})),e.duration>0&&(s.duration=e.duration),0===e.duration&&(s.duration=.01,this.trigger("info",{message:"updating zero segment duration to a small value"})),this.manifest.segments=a},key:function(){if(e.attributes)if("NONE"!==e.attributes.METHOD)if(e.attributes.URI){if("com.apple.streamingkeydelivery"===e.attributes.KEYFORMAT)return this.manifest.contentProtection=this.manifest.contentProtection||{},void(this.manifest.contentProtection["com.apple.fps.1_0"]={attributes:e.attributes});if("urn:uuid:edef8ba9-79d6-4ace-a3c8-27dcd51d21ed"===e.attributes.KEYFORMAT){return-1===["SAMPLE-AES","SAMPLE-AES-CTR","SAMPLE-AES-CENC"].indexOf(e.attributes.METHOD)?void this.trigger("warn",{message:"invalid key method provided for Widevine"}):("SAMPLE-AES-CENC"===e.attributes.METHOD&&this.trigger("warn",{message:"SAMPLE-AES-CENC is deprecated, please use SAMPLE-AES-CTR instead"}),"data:text/plain;base64,"!==e.attributes.URI.substring(0,23)?void this.trigger("warn",{message:"invalid key URI provided for Widevine"}):e.attributes.KEYID&&"0x"===e.attributes.KEYID.substring(0,2)?(this.manifest.contentProtection=this.manifest.contentProtection||{},void(this.manifest.contentProtection["com.widevine.alpha"]={attributes:{schemeIdUri:e.attributes.KEYFORMAT,keyId:e.attributes.KEYID.substring(2)},pssh:Pa(e.attributes.URI.split(",")[1])})):void this.trigger("warn",{message:"invalid key ID provided for Widevine"}))}e.attributes.METHOD||this.trigger("warn",{message:"defaulting key method to AES-128"}),r={method:e.attributes.METHOD||"AES-128",uri:e.attributes.URI},void 0!==e.attributes.IV&&(r.iv=e.attributes.IV)}else this.trigger("warn",{message:"ignoring key declaration without URI"});else r=null;else this.trigger("warn",{message:"ignoring key declaration without attribute list"})},"media-sequence":function(){isFinite(e.number)?this.manifest.mediaSequence=e.number:this.trigger("warn",{message:"ignoring invalid media sequence: "+e.number})},"discontinuity-sequence":function(){isFinite(e.number)?(this.manifest.discontinuitySequence=e.number,h=e.number):this.trigger("warn",{message:"ignoring invalid discontinuity sequence: "+e.number})},"playlist-type":function(){/VOD|EVENT/.test(e.playlistType)?this.manifest.playlistType=e.playlistType:this.trigger("warn",{message:"ignoring unknown playlist type: "+e.playlist})},map:function(){i={},e.uri&&(i.uri=e.uri),e.byterange&&(i.byterange=e.byterange),r&&(i.key=r)},"stream-inf":function(){this.manifest.playlists=a,this.manifest.mediaGroups=this.manifest.mediaGroups||d,e.attributes?(s.attributes||(s.attributes={}),_a(s.attributes,e.attributes)):this.trigger("warn",{message:"ignoring empty stream-inf attributes"})},media:function(){if(this.manifest.mediaGroups=this.manifest.mediaGroups||d,e.attributes&&e.attributes.TYPE&&e.attributes["GROUP-ID"]&&e.attributes.NAME){var i=this.manifest.mediaGroups[e.attributes.TYPE];i[e.attributes["GROUP-ID"]]=i[e.attributes["GROUP-ID"]]||{},t=i[e.attributes["GROUP-ID"]],(p={default:/yes/i.test(e.attributes.DEFAULT)}).default?p.autoselect=!0:p.autoselect=/yes/i.test(e.attributes.AUTOSELECT),e.attributes.LANGUAGE&&(p.language=e.attributes.LANGUAGE),e.attributes.URI&&(p.uri=e.attributes.URI),e.attributes["INSTREAM-ID"]&&(p.instreamId=e.attributes["INSTREAM-ID"]),e.attributes.CHARACTERISTICS&&(p.characteristics=e.attributes.CHARACTERISTICS),e.attributes.FORCED&&(p.forced=/yes/i.test(e.attributes.FORCED)),t[e.attributes.NAME]=p}else this.trigger("warn",{message:"ignoring incomplete or missing media group"})},discontinuity:function(){h+=1,s.discontinuity=!0,this.manifest.discontinuityStarts.push(a.length)},"program-date-time":function(){void 0===this.manifest.dateTimeString&&(this.manifest.dateTimeString=e.dateTimeString,this.manifest.dateTimeObject=e.dateTimeObject),s.dateTimeString=e.dateTimeString,s.dateTimeObject=e.dateTimeObject},targetduration:function(){!isFinite(e.duration)||e.duration<0?this.trigger("warn",{message:"ignoring invalid target duration: "+e.duration}):(this.manifest.targetDuration=e.duration,xa.call(this,this.manifest))},start:function(){e.attributes&&!isNaN(e.attributes["TIME-OFFSET"])?this.manifest.start={timeOffset:e.attributes["TIME-OFFSET"],precise:e.attributes.PRECISE}:this.trigger("warn",{message:"ignoring start declaration without appropriate attribute list"})},"cue-out":function(){s.cueOut=e.data},"cue-out-cont":function(){s.cueOutCont=e.data},"cue-in":function(){s.cueIn=e.data},skip:function(){this.manifest.skip=Ia(e.attributes),this.warnOnMissingAttributes_("#EXT-X-SKIP",e.attributes,["SKIPPED-SEGMENTS"])},part:function(){var t=this;o=!0;var i=this.manifest.segments.length,r=Ia(e.attributes);s.parts=s.parts||[],s.parts.push(r),r.byterange&&(r.byterange.hasOwnProperty("offset")||(r.byterange.offset=c),c=r.byterange.offset+r.byterange.length);var n=s.parts.length-1;this.warnOnMissingAttributes_("#EXT-X-PART #"+n+" for segment #"+i,e.attributes,["URI","DURATION"]),this.manifest.renditionReports&&this.manifest.renditionReports.forEach((function(e,i){e.hasOwnProperty("lastPart")||t.trigger("warn",{message:"#EXT-X-RENDITION-REPORT #"+i+" lacks required attribute(s): LAST-PART"})}))},"server-control":function(){var t=this.manifest.serverControl=Ia(e.attributes);t.hasOwnProperty("canBlockReload")||(t.canBlockReload=!1,this.trigger("info",{message:"#EXT-X-SERVER-CONTROL defaulting CAN-BLOCK-RELOAD to false"})),xa.call(this,this.manifest),t.canSkipDateranges&&!t.hasOwnProperty("canSkipUntil")&&this.trigger("warn",{message:"#EXT-X-SERVER-CONTROL lacks required attribute CAN-SKIP-UNTIL which is required when CAN-SKIP-DATERANGES is set"})},"preload-hint":function(){var t=this.manifest.segments.length,i=Ia(e.attributes),r=i.type&&"PART"===i.type;s.preloadHints=s.preloadHints||[],s.preloadHints.push(i),i.byterange&&(i.byterange.hasOwnProperty("offset")||(i.byterange.offset=r?c:0,r&&(c=i.byterange.offset+i.byterange.length)));var n=s.preloadHints.length-1;if(this.warnOnMissingAttributes_("#EXT-X-PRELOAD-HINT #"+n+" for segment #"+t,e.attributes,["TYPE","URI"]),i.type)for(var a=0;a<s.preloadHints.length-1;a++){var o=s.preloadHints[a];o.type&&(o.type===i.type&&this.trigger("warn",{message:"#EXT-X-PRELOAD-HINT #"+n+" for segment #"+t+" has the same TYPE "+i.type+" as preload hint #"+a}))}},"rendition-report":function(){var t=Ia(e.attributes);this.manifest.renditionReports=this.manifest.renditionReports||[],this.manifest.renditionReports.push(t);var i=this.manifest.renditionReports.length-1,r=["LAST-MSN","URI"];o&&r.push("LAST-PART"),this.warnOnMissingAttributes_("#EXT-X-RENDITION-REPORT #"+i,e.attributes,r)},"part-inf":function(){this.manifest.partInf=Ia(e.attributes),this.warnOnMissingAttributes_("#EXT-X-PART-INF",e.attributes,["PART-TARGET"]),this.manifest.partInf.partTarget&&(this.manifest.partTargetDuration=this.manifest.partInf.partTarget),xa.call(this,this.manifest)}}[e.tagType]||l).call(n)},uri:function(){s.uri=e.uri,a.push(s),this.manifest.targetDuration&&!("duration"in s)&&(this.trigger("warn",{message:"defaulting segment duration to the target duration"}),s.duration=this.manifest.targetDuration),r&&(s.key=r),s.timeline=h,i&&(s.map=i),c=0,s={}},comment:function(){},custom:function(){e.segment?(s.custom=s.custom||{},s.custom[e.customType]=e.data):(this.manifest.custom=this.manifest.custom||{},this.manifest.custom[e.customType]=e.data)}})[e.type].call(n)})),t}Ta(t,e);var i=t.prototype;return i.warnOnMissingAttributes_=function(e,t,i){var r=[];i.forEach((function(e){t.hasOwnProperty(e)||r.push(e)})),r.length&&this.trigger("warn",{message:e+" lacks required attribute(s): "+r.join(", ")})},i.push=function(e){this.lineStream.push(e)},i.end=function(){this.lineStream.push("\n"),this.trigger("end")},i.addParser=function(e){this.parseStream.addParser(e)},i.addTagMapper=function(e){this.parseStream.addTagMapper(e)},t}(Ea);class Ua{constructor(e){this.segmentIndex=-1,this.origin="",this.hls=e,this.parser=new Da}getM3u8Data(e){if(this.origin=new window.URL(e).origin,!this.origin){let t=`资源地址错误: ${e}`;return ge.warn("Loader getM3u8Data error",t),Promise.reject(t)}let t=new Promise(((t,i)=>{this.hls.emit(ke.ManifestLoading),fetch(e,{}).then((e=>{if(e.ok&&200===e.status)return e.text();i("response not 200")})).then((e=>{this.hls.emit(ke.ManifestLoaded,e),this.parser.push(e),this.parser.end(),this.playManifest=this.parser.manifest,this.setTotalDuration(),this.hls.emit(ke.ManifestParsed,this.parser.manifest),t(this.parser.manifest)}))}));return this.m3u8Promise=t,t}getTsData(e){this.segmentIndex=void 0===e?this.segmentIndex+1:e;let t=this.playManifest.segments[this.segmentIndex],i=this.origin+t.uri;i?(this.hls.emit(ke.TsLoading,t),fetch(i,{}).then((e=>{if(e.ok&&200===e.status)return e.arrayBuffer()})).then((e=>{this.hls.emit(ke.TsLoaded,{segment:t,arrayBuffer:e})}))):ge.warn(`Loader getTsData - TS Url not found, index: ${this.segmentIndex}`)}setTotalDuration(){let e=0,t=0;for(let i of this.playManifest.segments)e+=i.duration,i.index=t++;this.playManifest.totalDuration=e,this.playManifest.avgDuration=Number((e/t).toFixed(2))}}const Ma=class extends de{constructor(){super(),this.mseController=new Oe(this),this.loader=new Ua(this),this.muxer=new wa(this)}loadSource(e){this.loader.getM3u8Data(e)}attachMedia(e){this.mseController.attachMedia(e)}destroy(){}};class Na extends me{constructor(e,t){super(e,t),ge.info("HlsLitePlayer - 创建 HlsLitePlayer")}load(e,t=!1){return this.checkUrl(e,t)?(this.nPlayer&&this.recordPlayStatus(e),new Promise((t=>{this.createHlsInstance().then((i=>{i&&(this.video.onloadedmetadata=()=>{this.recoverPlayStatus()}),this.setUrl(e),this.nPlayer.loadSource(e),this.nPlayer.attachMedia(this.video),t(!0)}))}))):Promise.reject(!1)}reload(){return this.load(this.cacheUrl||this.url,!0)}async createHlsInstance(){let e=await this.destroy();return this.nPlayer=new Ma,e}destroy(){return new Promise((e=>{this.nPlayer?(this.nPlayer.destroy(),e(!0)):e(!1)}))}getBandwidthEstimate(){return 0}}function Fa(e){var t;let{scheduleOption:i,type:r,liveOption:a}=e,{playerData:s}=i;if("live"===r){let e=a.type;if(e&&"auto"!==e)return e;return 1==+s.live_type?Z.Hls:n.default.isSupported()?Z.Flv:Z.Hls}return(null==(t=s.default_server)?void 0:t.mp4_domainnames)?Z.Native:function(e){let{scheduleOption:t}=e;return!t.enable&&t.debugPlayer?t.debugPlayer:Z.Hls}(e)}var Ba,Va="undefined"!=typeof Symbol&&Symbol,ja=function(){if("function"!=typeof Symbol||"function"!=typeof Object.getOwnPropertySymbols)return!1;if("symbol"==typeof Symbol.iterator)return!0;var e={},t=Symbol("test"),i=Object(t);if("string"==typeof t)return!1;if("[object Symbol]"!==Object.prototype.toString.call(t))return!1;if("[object Symbol]"!==Object.prototype.toString.call(i))return!1;for(t in e[t]=42,e)return!1;if("function"==typeof Object.keys&&0!==Object.keys(e).length)return!1;if("function"==typeof Object.getOwnPropertyNames&&0!==Object.getOwnPropertyNames(e).length)return!1;var r=Object.getOwnPropertySymbols(e);if(1!==r.length||r[0]!==t)return!1;if(!Object.prototype.propertyIsEnumerable.call(e,t))return!1;if("function"==typeof Object.getOwnPropertyDescriptor){var n=Object.getOwnPropertyDescriptor(e,t);if(42!==n.value||!0!==n.enumerable)return!1}return!0},za="Function.prototype.bind called on incompatible ",qa=Array.prototype.slice,Ga=Object.prototype.toString,Ha="[object Function]",Wa=function(e){var t=this;if("function"!=typeof t||Ga.call(t)!==Ha)throw new TypeError(za+t);for(var i,r=qa.call(arguments,1),n=function(){if(this instanceof i){var n=t.apply(this,r.concat(qa.call(arguments)));return Object(n)===n?n:this}return t.apply(e,r.concat(qa.call(arguments)))},a=Math.max(0,t.length-r.length),s=[],o=0;o<a;o++)s.push("$"+o);if(i=Function("binder","return function ("+s.join(",")+"){ return binder.apply(this,arguments); }")(n),t.prototype){var l=function(){};l.prototype=t.prototype,i.prototype=new l,l.prototype=null}return i},$a=Function.prototype.bind||Wa,Xa=$a.call(Function.call,Object.prototype.hasOwnProperty),Qa=SyntaxError,Ya=Function,Ka=TypeError,Za=function(e){try{return Ya('"use strict"; return ('+e+").constructor;")()}catch(t){}},Ja=Object.getOwnPropertyDescriptor;if(Ja)try{Ja({},"")}catch(Jl){Ja=null}var es=function(){throw new Ka},ts=Ja?function(){try{return es}catch(e){try{return Ja(arguments,"callee").get}catch(t){return es}}}():es,is="function"==typeof Va&&"function"==typeof Symbol&&"symbol"==typeof Va("foo")&&"symbol"==typeof Symbol("bar")&&ja(),rs=Object.getPrototypeOf||function(e){return e.__proto__},ns={},as="undefined"==typeof Uint8Array?Ba:rs(Uint8Array),ss={"%AggregateError%":"undefined"==typeof AggregateError?Ba:AggregateError,"%Array%":Array,"%ArrayBuffer%":"undefined"==typeof ArrayBuffer?Ba:ArrayBuffer,"%ArrayIteratorPrototype%":is?rs([][Symbol.iterator]()):Ba,"%AsyncFromSyncIteratorPrototype%":Ba,"%AsyncFunction%":ns,"%AsyncGenerator%":ns,"%AsyncGeneratorFunction%":ns,"%AsyncIteratorPrototype%":ns,"%Atomics%":"undefined"==typeof Atomics?Ba:Atomics,"%BigInt%":"undefined"==typeof BigInt?Ba:BigInt,"%Boolean%":Boolean,"%DataView%":"undefined"==typeof DataView?Ba:DataView,"%Date%":Date,"%decodeURI%":decodeURI,"%decodeURIComponent%":decodeURIComponent,"%encodeURI%":encodeURI,"%encodeURIComponent%":encodeURIComponent,"%Error%":Error,"%eval%":eval,"%EvalError%":EvalError,"%Float32Array%":"undefined"==typeof Float32Array?Ba:Float32Array,"%Float64Array%":"undefined"==typeof Float64Array?Ba:Float64Array,"%FinalizationRegistry%":"undefined"==typeof FinalizationRegistry?Ba:FinalizationRegistry,"%Function%":Ya,"%GeneratorFunction%":ns,"%Int8Array%":"undefined"==typeof Int8Array?Ba:Int8Array,"%Int16Array%":"undefined"==typeof Int16Array?Ba:Int16Array,"%Int32Array%":"undefined"==typeof Int32Array?Ba:Int32Array,"%isFinite%":isFinite,"%isNaN%":isNaN,"%IteratorPrototype%":is?rs(rs([][Symbol.iterator]())):Ba,"%JSON%":"object"==typeof JSON?JSON:Ba,"%Map%":"undefined"==typeof Map?Ba:Map,"%MapIteratorPrototype%":"undefined"!=typeof Map&&is?rs((new Map)[Symbol.iterator]()):Ba,"%Math%":Math,"%Number%":Number,"%Object%":Object,"%parseFloat%":parseFloat,"%parseInt%":parseInt,"%Promise%":"undefined"==typeof Promise?Ba:Promise,"%Proxy%":"undefined"==typeof Proxy?Ba:Proxy,"%RangeError%":RangeError,"%ReferenceError%":ReferenceError,"%Reflect%":"undefined"==typeof Reflect?Ba:Reflect,"%RegExp%":RegExp,"%Set%":"undefined"==typeof Set?Ba:Set,"%SetIteratorPrototype%":"undefined"!=typeof Set&&is?rs((new Set)[Symbol.iterator]()):Ba,"%SharedArrayBuffer%":"undefined"==typeof SharedArrayBuffer?Ba:SharedArrayBuffer,"%String%":String,"%StringIteratorPrototype%":is?rs(""[Symbol.iterator]()):Ba,"%Symbol%":is?Symbol:Ba,"%SyntaxError%":Qa,"%ThrowTypeError%":ts,"%TypedArray%":as,"%TypeError%":Ka,"%Uint8Array%":"undefined"==typeof Uint8Array?Ba:Uint8Array,"%Uint8ClampedArray%":"undefined"==typeof Uint8ClampedArray?Ba:Uint8ClampedArray,"%Uint16Array%":"undefined"==typeof Uint16Array?Ba:Uint16Array,"%Uint32Array%":"undefined"==typeof Uint32Array?Ba:Uint32Array,"%URIError%":URIError,"%WeakMap%":"undefined"==typeof WeakMap?Ba:WeakMap,"%WeakRef%":"undefined"==typeof WeakRef?Ba:WeakRef,"%WeakSet%":"undefined"==typeof WeakSet?Ba:WeakSet},os=function e(t){var i;if("%AsyncFunction%"===t)i=Za("async function () {}");else if("%GeneratorFunction%"===t)i=Za("function* () {}");else if("%AsyncGeneratorFunction%"===t)i=Za("async function* () {}");else if("%AsyncGenerator%"===t){var r=e("%AsyncGeneratorFunction%");r&&(i=r.prototype)}else if("%AsyncIteratorPrototype%"===t){var n=e("%AsyncGenerator%");n&&(i=rs(n.prototype))}return ss[t]=i,i},ls={"%ArrayBufferPrototype%":["ArrayBuffer","prototype"],"%ArrayPrototype%":["Array","prototype"],"%ArrayProto_entries%":["Array","prototype","entries"],"%ArrayProto_forEach%":["Array","prototype","forEach"],"%ArrayProto_keys%":["Array","prototype","keys"],"%ArrayProto_values%":["Array","prototype","values"],"%AsyncFunctionPrototype%":["AsyncFunction","prototype"],"%AsyncGenerator%":["AsyncGeneratorFunction","prototype"],"%AsyncGeneratorPrototype%":["AsyncGeneratorFunction","prototype","prototype"],"%BooleanPrototype%":["Boolean","prototype"],"%DataViewPrototype%":["DataView","prototype"],"%DatePrototype%":["Date","prototype"],"%ErrorPrototype%":["Error","prototype"],"%EvalErrorPrototype%":["EvalError","prototype"],"%Float32ArrayPrototype%":["Float32Array","prototype"],"%Float64ArrayPrototype%":["Float64Array","prototype"],"%FunctionPrototype%":["Function","prototype"],"%Generator%":["GeneratorFunction","prototype"],"%GeneratorPrototype%":["GeneratorFunction","prototype","prototype"],"%Int8ArrayPrototype%":["Int8Array","prototype"],"%Int16ArrayPrototype%":["Int16Array","prototype"],"%Int32ArrayPrototype%":["Int32Array","prototype"],"%JSONParse%":["JSON","parse"],"%JSONStringify%":["JSON","stringify"],"%MapPrototype%":["Map","prototype"],"%NumberPrototype%":["Number","prototype"],"%ObjectPrototype%":["Object","prototype"],"%ObjProto_toString%":["Object","prototype","toString"],"%ObjProto_valueOf%":["Object","prototype","valueOf"],"%PromisePrototype%":["Promise","prototype"],"%PromiseProto_then%":["Promise","prototype","then"],"%Promise_all%":["Promise","all"],"%Promise_reject%":["Promise","reject"],"%Promise_resolve%":["Promise","resolve"],"%RangeErrorPrototype%":["RangeError","prototype"],"%ReferenceErrorPrototype%":["ReferenceError","prototype"],"%RegExpPrototype%":["RegExp","prototype"],"%SetPrototype%":["Set","prototype"],"%SharedArrayBufferPrototype%":["SharedArrayBuffer","prototype"],"%StringPrototype%":["String","prototype"],"%SymbolPrototype%":["Symbol","prototype"],"%SyntaxErrorPrototype%":["SyntaxError","prototype"],"%TypedArrayPrototype%":["TypedArray","prototype"],"%TypeErrorPrototype%":["TypeError","prototype"],"%Uint8ArrayPrototype%":["Uint8Array","prototype"],"%Uint8ClampedArrayPrototype%":["Uint8ClampedArray","prototype"],"%Uint16ArrayPrototype%":["Uint16Array","prototype"],"%Uint32ArrayPrototype%":["Uint32Array","prototype"],"%URIErrorPrototype%":["URIError","prototype"],"%WeakMapPrototype%":["WeakMap","prototype"],"%WeakSetPrototype%":["WeakSet","prototype"]},ds=$a,hs=Xa,us=ds.call(Function.call,Array.prototype.concat),cs=ds.call(Function.apply,Array.prototype.splice),ps=ds.call(Function.call,String.prototype.replace),fs=ds.call(Function.call,String.prototype.slice),gs=/[^%.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|%$))/g,ms=/\\(\\)?/g,ys=function(e){var t=fs(e,0,1),i=fs(e,-1);if("%"===t&&"%"!==i)throw new Qa("invalid intrinsic syntax, expected closing `%`");if("%"===i&&"%"!==t)throw new Qa("invalid intrinsic syntax, expected opening `%`");var r=[];return ps(e,gs,(function(e,t,i,n){r[r.length]=i?ps(n,ms,"$1"):t||e})),r},vs=function(e,t){var i,r=e;if(hs(ls,r)&&(r="%"+(i=ls[r])[0]+"%"),hs(ss,r)){var n=ss[r];if(n===ns&&(n=os(r)),void 0===n&&!t)throw new Ka("intrinsic "+e+" exists, but is not available. Please file an issue!");return{alias:i,name:r,value:n}}throw new Qa("intrinsic "+e+" does not exist!")},bs=function(e,t){if("string"!=typeof e||0===e.length)throw new Ka("intrinsic name must be a non-empty string");if(arguments.length>1&&"boolean"!=typeof t)throw new Ka('"allowMissing" argument must be a boolean');var i=ys(e),r=i.length>0?i[0]:"",n=vs("%"+r+"%",t),a=n.name,s=n.value,o=!1,l=n.alias;l&&(r=l[0],cs(i,us([0,1],l)));for(var d=1,h=!0;d<i.length;d+=1){var u=i[d],c=fs(u,0,1),p=fs(u,-1);if(('"'===c||"'"===c||"`"===c||'"'===p||"'"===p||"`"===p)&&c!==p)throw new Qa("property names with quotes must have matching quotes");if("constructor"!==u&&h||(o=!0),hs(ss,a="%"+(r+="."+u)+"%"))s=ss[a];else if(null!=s){if(!(u in s)){if(!t)throw new Ka("base intrinsic for "+e+" exists, but the property is not available.");return}if(Ja&&d+1>=i.length){var f=Ja(s,u);s=(h=!!f)&&"get"in f&&!("originalValue"in f.get)?f.get:s[u]}else h=hs(s,u),s=s[u];h&&!o&&(ss[a]=s)}}return s},ws={exports:{}};!function(e){var t=$a,i=bs,r=i("%Function.prototype.apply%"),n=i("%Function.prototype.call%"),a=i("%Reflect.apply%",!0)||t.call(n,r),s=i("%Object.getOwnPropertyDescriptor%",!0),o=i("%Object.defineProperty%",!0),l=i("%Math.max%");if(o)try{o({},"a",{value:1})}catch(Jl){o=null}e.exports=function(e){var i=a(t,n,arguments);if(s&&o){var r=s(i,"length");r.configurable&&o(i,"length",{value:1+l(0,e.length-(arguments.length-1))})}return i};var d=function(){return a(t,r,arguments)};o?o(e.exports,"apply",{value:d}):e.exports.apply=d}(ws);var Ss=bs,Ts=ws.exports,Es=Ts(Ss("String.prototype.indexOf")),_s=m(Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",default:{}})),ks="function"==typeof Map&&Map.prototype,Ps=Object.getOwnPropertyDescriptor&&ks?Object.getOwnPropertyDescriptor(Map.prototype,"size"):null,As=ks&&Ps&&"function"==typeof Ps.get?Ps.get:null,Ls=ks&&Map.prototype.forEach,Os="function"==typeof Set&&Set.prototype,Cs=Object.getOwnPropertyDescriptor&&Os?Object.getOwnPropertyDescriptor(Set.prototype,"size"):null,Rs=Os&&Cs&&"function"==typeof Cs.get?Cs.get:null,Is=Os&&Set.prototype.forEach,xs="function"==typeof WeakMap&&WeakMap.prototype?WeakMap.prototype.has:null,Ds="function"==typeof WeakSet&&WeakSet.prototype?WeakSet.prototype.has:null,Us="function"==typeof WeakRef&&WeakRef.prototype?WeakRef.prototype.deref:null,Ms=Boolean.prototype.valueOf,Ns=Object.prototype.toString,Fs=Function.prototype.toString,Bs=String.prototype.match,Vs="function"==typeof BigInt?BigInt.prototype.valueOf:null,js=Object.getOwnPropertySymbols,zs="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?Symbol.prototype.toString:null,qs="function"==typeof Symbol&&"object"==typeof Symbol.iterator,Gs=Object.prototype.propertyIsEnumerable,Hs=("function"==typeof Reflect?Reflect.getPrototypeOf:Object.getPrototypeOf)||([].__proto__===Array.prototype?function(e){return e.__proto__}:null),Ws=_s.custom,$s=Ws&&Zs(Ws)?Ws:null,Xs="function"==typeof Symbol&&void 0!==Symbol.toStringTag?Symbol.toStringTag:null;function Qs(e,t,i){var r="double"===(i.quoteStyle||t)?'"':"'";return r+e+r}function Ys(e){return String(e).replace(/"/g,"&quot;")}function Ks(e){return!("[object Array]"!==to(e)||Xs&&"object"==typeof e&&Xs in e)}function Zs(e){if(qs)return e&&"object"==typeof e&&e instanceof Symbol;if("symbol"==typeof e)return!0;if(!e||"object"!=typeof e||!zs)return!1;try{return zs.call(e),!0}catch(Jl){}return!1}var Js=Object.prototype.hasOwnProperty||function(e){return e in this};function eo(e,t){return Js.call(e,t)}function to(e){return Ns.call(e)}function io(e,t){if(e.indexOf)return e.indexOf(t);for(var i=0,r=e.length;i<r;i++)if(e[i]===t)return i;return-1}function ro(e,t){if(e.length>t.maxStringLength){var i=e.length-t.maxStringLength,r="... "+i+" more character"+(i>1?"s":"");return ro(e.slice(0,t.maxStringLength),t)+r}return Qs(e.replace(/(['\\])/g,"\\$1").replace(/[\x00-\x1f]/g,no),"single",t)}function no(e){var t=e.charCodeAt(0),i={8:"b",9:"t",10:"n",12:"f",13:"r"}[t];return i?"\\"+i:"\\x"+(t<16?"0":"")+t.toString(16).toUpperCase()}function ao(e){return"Object("+e+")"}function so(e){return e+" { ? }"}function oo(e,t,i,r){return e+" ("+t+") {"+(r?lo(i,r):i.join(", "))+"}"}function lo(e,t){if(0===e.length)return"";var i="\n"+t.prev+t.base;return i+e.join(","+i)+"\n"+t.prev}function ho(e,t){var i=Ks(e),r=[];if(i){r.length=e.length;for(var n=0;n<e.length;n++)r[n]=eo(e,n)?t(e[n],e):""}var a,s="function"==typeof js?js(e):[];if(qs){a={};for(var o=0;o<s.length;o++)a["$"+s[o]]=s[o]}for(var l in e)eo(e,l)&&(i&&String(Number(l))===l&&l<e.length||qs&&a["$"+l]instanceof Symbol||(/[^\w$]/.test(l)?r.push(t(l,e)+": "+t(e[l],e)):r.push(l+": "+t(e[l],e))));if("function"==typeof js)for(var d=0;d<s.length;d++)Gs.call(e,s[d])&&r.push("["+t(s[d])+"]: "+t(e[s[d]],e));return r}var uo=bs,co=function(e,t){var i=Ss(e,!!t);return"function"==typeof i&&Es(e,".prototype.")>-1?Ts(i):i},po=function e(t,i,r,n){var a=i||{};if(eo(a,"quoteStyle")&&"single"!==a.quoteStyle&&"double"!==a.quoteStyle)throw new TypeError('option "quoteStyle" must be "single" or "double"');if(eo(a,"maxStringLength")&&("number"==typeof a.maxStringLength?a.maxStringLength<0&&a.maxStringLength!==1/0:null!==a.maxStringLength))throw new TypeError('option "maxStringLength", if provided, must be a positive integer, Infinity, or `null`');var s=!eo(a,"customInspect")||a.customInspect;if("boolean"!=typeof s&&"symbol"!==s)throw new TypeError("option \"customInspect\", if provided, must be `true`, `false`, or `'symbol'`");if(eo(a,"indent")&&null!==a.indent&&"\t"!==a.indent&&!(parseInt(a.indent,10)===a.indent&&a.indent>0))throw new TypeError('options "indent" must be "\\t", an integer > 0, or `null`');if(void 0===t)return"undefined";if(null===t)return"null";if("boolean"==typeof t)return t?"true":"false";if("string"==typeof t)return ro(t,a);if("number"==typeof t)return 0===t?1/0/t>0?"0":"-0":String(t);if("bigint"==typeof t)return String(t)+"n";var o=void 0===a.depth?5:a.depth;if(void 0===r&&(r=0),r>=o&&o>0&&"object"==typeof t)return Ks(t)?"[Array]":"[Object]";var l=function(e,t){var i;if("\t"===e.indent)i="\t";else{if(!("number"==typeof e.indent&&e.indent>0))return null;i=Array(e.indent+1).join(" ")}return{base:i,prev:Array(t+1).join(i)}}(a,r);if(void 0===n)n=[];else if(io(n,t)>=0)return"[Circular]";function d(t,i,s){if(i&&(n=n.slice()).push(i),s){var o={depth:a.depth};return eo(a,"quoteStyle")&&(o.quoteStyle=a.quoteStyle),e(t,o,r+1,n)}return e(t,a,r+1,n)}if("function"==typeof t){var h=function(e){if(e.name)return e.name;var t=Bs.call(Fs.call(e),/^function\s*([\w$]+)/);if(t)return t[1];return null}(t),u=ho(t,d);return"[Function"+(h?": "+h:" (anonymous)")+"]"+(u.length>0?" { "+u.join(", ")+" }":"")}if(Zs(t)){var c=qs?String(t).replace(/^(Symbol\(.*\))_[^)]*$/,"$1"):zs.call(t);return"object"!=typeof t||qs?c:ao(c)}if(function(e){if(!e||"object"!=typeof e)return!1;if("undefined"!=typeof HTMLElement&&e instanceof HTMLElement)return!0;return"string"==typeof e.nodeName&&"function"==typeof e.getAttribute}(t)){for(var p="<"+String(t.nodeName).toLowerCase(),f=t.attributes||[],g=0;g<f.length;g++)p+=" "+f[g].name+"="+Qs(Ys(f[g].value),"double",a);return p+=">",t.childNodes&&t.childNodes.length&&(p+="..."),p+="</"+String(t.nodeName).toLowerCase()+">"}if(Ks(t)){if(0===t.length)return"[]";var m=ho(t,d);return l&&!function(e){for(var t=0;t<e.length;t++)if(io(e[t],"\n")>=0)return!1;return!0}(m)?"["+lo(m,l)+"]":"[ "+m.join(", ")+" ]"}if(function(e){return!("[object Error]"!==to(e)||Xs&&"object"==typeof e&&Xs in e)}(t)){var y=ho(t,d);return 0===y.length?"["+String(t)+"]":"{ ["+String(t)+"] "+y.join(", ")+" }"}if("object"==typeof t&&s){if($s&&"function"==typeof t[$s])return t[$s]();if("symbol"!==s&&"function"==typeof t.inspect)return t.inspect()}if(function(e){if(!As||!e||"object"!=typeof e)return!1;try{As.call(e);try{Rs.call(e)}catch(p){return!0}return e instanceof Map}catch(Jl){}return!1}(t)){var v=[];return Ls.call(t,(function(e,i){v.push(d(i,t,!0)+" => "+d(e,t))})),oo("Map",As.call(t),v,l)}if(function(e){if(!Rs||!e||"object"!=typeof e)return!1;try{Rs.call(e);try{As.call(e)}catch(t){return!0}return e instanceof Set}catch(Jl){}return!1}(t)){var b=[];return Is.call(t,(function(e){b.push(d(e,t))})),oo("Set",Rs.call(t),b,l)}if(function(e){if(!xs||!e||"object"!=typeof e)return!1;try{xs.call(e,xs);try{Ds.call(e,Ds)}catch(p){return!0}return e instanceof WeakMap}catch(Jl){}return!1}(t))return so("WeakMap");if(function(e){if(!Ds||!e||"object"!=typeof e)return!1;try{Ds.call(e,Ds);try{xs.call(e,xs)}catch(p){return!0}return e instanceof WeakSet}catch(Jl){}return!1}(t))return so("WeakSet");if(function(e){if(!Us||!e||"object"!=typeof e)return!1;try{return Us.call(e),!0}catch(Jl){}return!1}(t))return so("WeakRef");if(function(e){return!("[object Number]"!==to(e)||Xs&&"object"==typeof e&&Xs in e)}(t))return ao(d(Number(t)));if(function(e){if(!e||"object"!=typeof e||!Vs)return!1;try{return Vs.call(e),!0}catch(Jl){}return!1}(t))return ao(d(Vs.call(t)));if(function(e){return!("[object Boolean]"!==to(e)||Xs&&"object"==typeof e&&Xs in e)}(t))return ao(Ms.call(t));if(function(e){return!("[object String]"!==to(e)||Xs&&"object"==typeof e&&Xs in e)}(t))return ao(d(String(t)));if(!function(e){return!("[object Date]"!==to(e)||Xs&&"object"==typeof e&&Xs in e)}(t)&&!function(e){return!("[object RegExp]"!==to(e)||Xs&&"object"==typeof e&&Xs in e)}(t)){var w=ho(t,d),S=Hs?Hs(t)===Object.prototype:t instanceof Object||t.constructor===Object,T=t instanceof Object?"":"null prototype",E=!S&&Xs&&Object(t)===t&&Xs in t?to(t).slice(8,-1):T?"Object":"",_=(S||"function"!=typeof t.constructor?"":t.constructor.name?t.constructor.name+" ":"")+(E||T?"["+[].concat(E||[],T||[]).join(": ")+"] ":"");return 0===w.length?_+"{}":l?_+"{"+lo(w,l)+"}":_+"{ "+w.join(", ")+" }"}return String(t)},fo=uo("%TypeError%"),go=uo("%WeakMap%",!0),mo=uo("%Map%",!0),yo=co("WeakMap.prototype.get",!0),vo=co("WeakMap.prototype.set",!0),bo=co("WeakMap.prototype.has",!0),wo=co("Map.prototype.get",!0),So=co("Map.prototype.set",!0),To=co("Map.prototype.has",!0),Eo=function(e,t){for(var i,r=e;null!==(i=r.next);r=i)if(i.key===t)return r.next=i.next,i.next=e.next,e.next=i,i},_o=String.prototype.replace,ko=/%20/g,Po="RFC3986",Ao={default:Po,formatters:{RFC1738:function(e){return _o.call(e,ko,"+")},RFC3986:function(e){return String(e)}},RFC1738:"RFC1738",RFC3986:Po},Lo=Ao,Oo=Object.prototype.hasOwnProperty,Co=Array.isArray,Ro=function(){for(var e=[],t=0;t<256;++t)e.push("%"+((t<16?"0":"")+t.toString(16)).toUpperCase());return e}(),Io=function(e,t){for(var i=t&&t.plainObjects?Object.create(null):{},r=0;r<e.length;++r)void 0!==e[r]&&(i[r]=e[r]);return i},xo={arrayToObject:Io,assign:function(e,t){return Object.keys(t).reduce((function(e,i){return e[i]=t[i],e}),e)},combine:function(e,t){return[].concat(e,t)},compact:function(e){for(var t=[{obj:{o:e},prop:"o"}],i=[],r=0;r<t.length;++r)for(var n=t[r],a=n.obj[n.prop],s=Object.keys(a),o=0;o<s.length;++o){var l=s[o],d=a[l];"object"==typeof d&&null!==d&&-1===i.indexOf(d)&&(t.push({obj:a,prop:l}),i.push(d))}return function(e){for(;e.length>1;){var t=e.pop(),i=t.obj[t.prop];if(Co(i)){for(var r=[],n=0;n<i.length;++n)void 0!==i[n]&&r.push(i[n]);t.obj[t.prop]=r}}}(t),e},decode:function(e,t,i){var r=e.replace(/\+/g," ");if("iso-8859-1"===i)return r.replace(/%[0-9a-f]{2}/gi,unescape);try{return decodeURIComponent(r)}catch(Jl){return r}},encode:function(e,t,i,r,n){if(0===e.length)return e;var a=e;if("symbol"==typeof e?a=Symbol.prototype.toString.call(e):"string"!=typeof e&&(a=String(e)),"iso-8859-1"===i)return escape(a).replace(/%u[0-9a-f]{4}/gi,(function(e){return"%26%23"+parseInt(e.slice(2),16)+"%3B"}));for(var s="",o=0;o<a.length;++o){var l=a.charCodeAt(o);45===l||46===l||95===l||126===l||l>=48&&l<=57||l>=65&&l<=90||l>=97&&l<=122||n===Lo.RFC1738&&(40===l||41===l)?s+=a.charAt(o):l<128?s+=Ro[l]:l<2048?s+=Ro[192|l>>6]+Ro[128|63&l]:l<55296||l>=57344?s+=Ro[224|l>>12]+Ro[128|l>>6&63]+Ro[128|63&l]:(o+=1,l=65536+((1023&l)<<10|1023&a.charCodeAt(o)),s+=Ro[240|l>>18]+Ro[128|l>>12&63]+Ro[128|l>>6&63]+Ro[128|63&l])}return s},isBuffer:function(e){return!(!e||"object"!=typeof e)&&!!(e.constructor&&e.constructor.isBuffer&&e.constructor.isBuffer(e))},isRegExp:function(e){return"[object RegExp]"===Object.prototype.toString.call(e)},maybeMap:function(e,t){if(Co(e)){for(var i=[],r=0;r<e.length;r+=1)i.push(t(e[r]));return i}return t(e)},merge:function e(t,i,r){if(!i)return t;if("object"!=typeof i){if(Co(t))t.push(i);else{if(!t||"object"!=typeof t)return[t,i];(r&&(r.plainObjects||r.allowPrototypes)||!Oo.call(Object.prototype,i))&&(t[i]=!0)}return t}if(!t||"object"!=typeof t)return[t].concat(i);var n=t;return Co(t)&&!Co(i)&&(n=Io(t,r)),Co(t)&&Co(i)?(i.forEach((function(i,n){if(Oo.call(t,n)){var a=t[n];a&&"object"==typeof a&&i&&"object"==typeof i?t[n]=e(a,i,r):t.push(i)}else t[n]=i})),t):Object.keys(i).reduce((function(t,n){var a=i[n];return Oo.call(t,n)?t[n]=e(t[n],a,r):t[n]=a,t}),n)}},Do=function(){var e,t,i,r={assert:function(e){if(!r.has(e))throw new fo("Side channel does not contain "+po(e))},get:function(r){if(go&&r&&("object"==typeof r||"function"==typeof r)){if(e)return yo(e,r)}else if(mo){if(t)return wo(t,r)}else if(i)return function(e,t){var i=Eo(e,t);return i&&i.value}(i,r)},has:function(r){if(go&&r&&("object"==typeof r||"function"==typeof r)){if(e)return bo(e,r)}else if(mo){if(t)return To(t,r)}else if(i)return function(e,t){return!!Eo(e,t)}(i,r);return!1},set:function(r,n){go&&r&&("object"==typeof r||"function"==typeof r)?(e||(e=new go),vo(e,r,n)):mo?(t||(t=new mo),So(t,r,n)):(i||(i={key:{},next:null}),function(e,t,i){var r=Eo(e,t);r?r.value=i:e.next={key:t,next:e.next,value:i}}(i,r,n))}};return r},Uo=xo,Mo=Ao,No=Object.prototype.hasOwnProperty,Fo={brackets:function(e){return e+"[]"},comma:"comma",indices:function(e,t){return e+"["+t+"]"},repeat:function(e){return e}},Bo=Array.isArray,Vo=Array.prototype.push,jo=function(e,t){Vo.apply(e,Bo(t)?t:[t])},zo=Date.prototype.toISOString,qo=Mo.default,Go={addQueryPrefix:!1,allowDots:!1,charset:"utf-8",charsetSentinel:!1,delimiter:"&",encode:!0,encoder:Uo.encode,encodeValuesOnly:!1,format:qo,formatter:Mo.formatters[qo],indices:!1,serializeDate:function(e){return zo.call(e)},skipNulls:!1,strictNullHandling:!1},Ho=function e(t,i,r,n,a,s,o,l,d,h,u,c,p,f,g){var m,y=t;if(g.has(t))throw new RangeError("Cyclic object value");if("function"==typeof o?y=o(i,y):y instanceof Date?y=h(y):"comma"===r&&Bo(y)&&(y=Uo.maybeMap(y,(function(e){return e instanceof Date?h(e):e}))),null===y){if(n)return s&&!p?s(i,Go.encoder,f,"key",u):i;y=""}if("string"==typeof(m=y)||"number"==typeof m||"boolean"==typeof m||"symbol"==typeof m||"bigint"==typeof m||Uo.isBuffer(y))return s?[c(p?i:s(i,Go.encoder,f,"key",u))+"="+c(s(y,Go.encoder,f,"value",u))]:[c(i)+"="+c(String(y))];var v,b=[];if(void 0===y)return b;if("comma"===r&&Bo(y))v=[{value:y.length>0?y.join(",")||null:void 0}];else if(Bo(o))v=o;else{var w=Object.keys(y);v=l?w.sort(l):w}for(var S=0;S<v.length;++S){var T=v[S],E="object"==typeof T&&void 0!==T.value?T.value:y[T];if(!a||null!==E){var _=Bo(y)?"function"==typeof r?r(i,T):i:i+(d?"."+T:"["+T+"]");g.set(t,!0);var k=Do();jo(b,e(E,_,r,n,a,s,o,l,d,h,u,c,p,f,k))}}return b},Wo=xo,$o=Object.prototype.hasOwnProperty,Xo=Array.isArray,Qo={allowDots:!1,allowPrototypes:!1,allowSparse:!1,arrayLimit:20,charset:"utf-8",charsetSentinel:!1,comma:!1,decoder:Wo.decode,delimiter:"&",depth:5,ignoreQueryPrefix:!1,interpretNumericEntities:!1,parameterLimit:1e3,parseArrays:!0,plainObjects:!1,strictNullHandling:!1},Yo=function(e){return e.replace(/&#(\d+);/g,(function(e,t){return String.fromCharCode(parseInt(t,10))}))},Ko=function(e,t){return e&&"string"==typeof e&&t.comma&&e.indexOf(",")>-1?e.split(","):e},Zo=function(e,t,i,r){if(e){var n=i.allowDots?e.replace(/\.([^.[]+)/g,"[$1]"):e,a=/(\[[^[\]]*])/g,s=i.depth>0&&/(\[[^[\]]*])/.exec(n),o=s?n.slice(0,s.index):n,l=[];if(o){if(!i.plainObjects&&$o.call(Object.prototype,o)&&!i.allowPrototypes)return;l.push(o)}for(var d=0;i.depth>0&&null!==(s=a.exec(n))&&d<i.depth;){if(d+=1,!i.plainObjects&&$o.call(Object.prototype,s[1].slice(1,-1))&&!i.allowPrototypes)return;l.push(s[1])}return s&&l.push("["+n.slice(s.index)+"]"),function(e,t,i,r){for(var n=r?t:Ko(t,i),a=e.length-1;a>=0;--a){var s,o=e[a];if("[]"===o&&i.parseArrays)s=[].concat(n);else{s=i.plainObjects?Object.create(null):{};var l="["===o.charAt(0)&&"]"===o.charAt(o.length-1)?o.slice(1,-1):o,d=parseInt(l,10);i.parseArrays||""!==l?!isNaN(d)&&o!==l&&String(d)===l&&d>=0&&i.parseArrays&&d<=i.arrayLimit?(s=[])[d]=n:s[l]=n:s={0:n}}n=s}return n}(l,t,i,r)}},Jo={formats:Ao,parse:function(e,t){var i=function(e){if(!e)return Qo;if(null!==e.decoder&&void 0!==e.decoder&&"function"!=typeof e.decoder)throw new TypeError("Decoder has to be a function.");if(void 0!==e.charset&&"utf-8"!==e.charset&&"iso-8859-1"!==e.charset)throw new TypeError("The charset option must be either utf-8, iso-8859-1, or undefined");var t=void 0===e.charset?Qo.charset:e.charset;return{allowDots:void 0===e.allowDots?Qo.allowDots:!!e.allowDots,allowPrototypes:"boolean"==typeof e.allowPrototypes?e.allowPrototypes:Qo.allowPrototypes,allowSparse:"boolean"==typeof e.allowSparse?e.allowSparse:Qo.allowSparse,arrayLimit:"number"==typeof e.arrayLimit?e.arrayLimit:Qo.arrayLimit,charset:t,charsetSentinel:"boolean"==typeof e.charsetSentinel?e.charsetSentinel:Qo.charsetSentinel,comma:"boolean"==typeof e.comma?e.comma:Qo.comma,decoder:"function"==typeof e.decoder?e.decoder:Qo.decoder,delimiter:"string"==typeof e.delimiter||Wo.isRegExp(e.delimiter)?e.delimiter:Qo.delimiter,depth:"number"==typeof e.depth||!1===e.depth?+e.depth:Qo.depth,ignoreQueryPrefix:!0===e.ignoreQueryPrefix,interpretNumericEntities:"boolean"==typeof e.interpretNumericEntities?e.interpretNumericEntities:Qo.interpretNumericEntities,parameterLimit:"number"==typeof e.parameterLimit?e.parameterLimit:Qo.parameterLimit,parseArrays:!1!==e.parseArrays,plainObjects:"boolean"==typeof e.plainObjects?e.plainObjects:Qo.plainObjects,strictNullHandling:"boolean"==typeof e.strictNullHandling?e.strictNullHandling:Qo.strictNullHandling}}(t);if(""===e||null==e)return i.plainObjects?Object.create(null):{};for(var r="string"==typeof e?function(e,t){var i,r={},n=t.ignoreQueryPrefix?e.replace(/^\?/,""):e,a=t.parameterLimit===1/0?void 0:t.parameterLimit,s=n.split(t.delimiter,a),o=-1,l=t.charset;if(t.charsetSentinel)for(i=0;i<s.length;++i)0===s[i].indexOf("utf8=")&&("utf8=%E2%9C%93"===s[i]?l="utf-8":"utf8=%26%2310003%3B"===s[i]&&(l="iso-8859-1"),o=i,i=s.length);for(i=0;i<s.length;++i)if(i!==o){var d,h,u=s[i],c=u.indexOf("]="),p=-1===c?u.indexOf("="):c+1;-1===p?(d=t.decoder(u,Qo.decoder,l,"key"),h=t.strictNullHandling?null:""):(d=t.decoder(u.slice(0,p),Qo.decoder,l,"key"),h=Wo.maybeMap(Ko(u.slice(p+1),t),(function(e){return t.decoder(e,Qo.decoder,l,"value")}))),h&&t.interpretNumericEntities&&"iso-8859-1"===l&&(h=Yo(h)),u.indexOf("[]=")>-1&&(h=Xo(h)?[h]:h),$o.call(r,d)?r[d]=Wo.combine(r[d],h):r[d]=h}return r}(e,i):e,n=i.plainObjects?Object.create(null):{},a=Object.keys(r),s=0;s<a.length;++s){var o=a[s],l=Zo(o,r[o],i,"string"==typeof e);n=Wo.merge(n,l,i)}return!0===i.allowSparse?n:Wo.compact(n)},stringify:function(e,t){var i,r=e,n=function(e){if(!e)return Go;if(null!==e.encoder&&void 0!==e.encoder&&"function"!=typeof e.encoder)throw new TypeError("Encoder has to be a function.");var t=e.charset||Go.charset;if(void 0!==e.charset&&"utf-8"!==e.charset&&"iso-8859-1"!==e.charset)throw new TypeError("The charset option must be either utf-8, iso-8859-1, or undefined");var i=Mo.default;if(void 0!==e.format){if(!No.call(Mo.formatters,e.format))throw new TypeError("Unknown format option provided.");i=e.format}var r=Mo.formatters[i],n=Go.filter;return("function"==typeof e.filter||Bo(e.filter))&&(n=e.filter),{addQueryPrefix:"boolean"==typeof e.addQueryPrefix?e.addQueryPrefix:Go.addQueryPrefix,allowDots:void 0===e.allowDots?Go.allowDots:!!e.allowDots,charset:t,charsetSentinel:"boolean"==typeof e.charsetSentinel?e.charsetSentinel:Go.charsetSentinel,delimiter:void 0===e.delimiter?Go.delimiter:e.delimiter,encode:"boolean"==typeof e.encode?e.encode:Go.encode,encoder:"function"==typeof e.encoder?e.encoder:Go.encoder,encodeValuesOnly:"boolean"==typeof e.encodeValuesOnly?e.encodeValuesOnly:Go.encodeValuesOnly,filter:n,format:i,formatter:r,serializeDate:"function"==typeof e.serializeDate?e.serializeDate:Go.serializeDate,skipNulls:"boolean"==typeof e.skipNulls?e.skipNulls:Go.skipNulls,sort:"function"==typeof e.sort?e.sort:null,strictNullHandling:"boolean"==typeof e.strictNullHandling?e.strictNullHandling:Go.strictNullHandling}}(t);"function"==typeof n.filter?r=(0,n.filter)("",r):Bo(n.filter)&&(i=n.filter);var a,s=[];if("object"!=typeof r||null===r)return"";a=t&&t.arrayFormat in Fo?t.arrayFormat:t&&"indices"in t?t.indices?"indices":"repeat":"indices";var o=Fo[a];i||(i=Object.keys(r)),n.sort&&i.sort(n.sort);for(var l=Do(),d=0;d<i.length;++d){var h=i[d];n.skipNulls&&null===r[h]||jo(s,Ho(r[h],h,o,n.strictNullHandling,n.skipNulls,n.encode?n.encoder:null,n.filter,n.sort,n.allowDots,n.serializeDate,n.format,n.formatter,n.encodeValuesOnly,n.charset,l))}var u=s.join(n.delimiter),c=!0===n.addQueryPrefix?"?":"";return n.charsetSentinel&&("iso-8859-1"===n.charset?c+="utf8=%26%2310003%3B&":c+="utf8=%E2%9C%93&"),u.length>0?c+u:""}};class el{constructor(e){this.store=e,this.e={error:this._onError.bind(this),timeout:this._onTimeout.bind(this),load:this._onLoad.bind(this),loadend:this._onLoadend.bind(this)};let t=new XMLHttpRequest;"ie"!==G.browser&&(t.responseType="json",t.timeout=5e3),t.onerror=this.e.error,t.ontimeout=this.e.timeout,t.onload=this.e.load,t.onloadend=this.e.loadend,this.xhr=t}_onError(e){this.onError&&this.onError(e.target),this.onError=null}_onTimeout(e){this.onTimeout&&this.onTimeout(e.target),this.onTimeout=null}_onLoad(e){if(!e.target)return void this._onError(e);let t=e.target.response;if("ie"===G.browser&&t&&"string"==typeof t)try{t=JSON.parse(t)}catch(n){}let{code:i,data:r}=t;200==+i?(this.onLoad&&this.onLoad(r),this.onLoad=null):this._onError(e)}_onLoadend(e){this.onLoadend&&this.onLoadend(e.target),this.onLoadend=null}fire(e,t={},i="POST"){if(!this.xhr)return;G.isIOS&&G.isUC&&(i="GET");let r=new FormData;if(this.store&&(r.set(Q,this.store.getKV(Q)),r.set($,this.store.getKV($)),r.set(X,this.store.getKV(X)),r.set(Y,this.store.getKV(Y)),r.set(K,this.store.getKV(K))),Object.keys(t).forEach((e=>{r.set(e,t[e])})),"POST"===i)this.xhr.open(i,e),this.xhr.send(r);else if("GET"===i){let t={};r.forEach(((e,i)=>{t[i]=e}));let n=Jo.stringify(t);n&&(e+=`?${n}`),this.xhr.open(i,e),this.xhr.send()}}destroy(){this.xhr&&(this.xhr.onerror=null,this.xhr.onload=null,this.xhr.onloadend=null,this.xhr.ontimeout=null,this.xhr=null,this.onLoad=null,this.onLoadend=null,this.onTimeout=null,this.onError=null)}}const tl=class extends de{constructor(e){super(),this.plugins={},this.isFullscreen=!1,this.enterFullscreen=()=>Promise.resolve(void 0),this.exitFullscreen=()=>Promise.resolve(void 0),this.toggleFullscreen=()=>Promise.resolve(void 0),this.switch=()=>{},this.setQuality=()=>{},this.addBarrage=()=>{},this.clearBarrage=()=>{},this.openBarrage=()=>{},this.closeBarrage=()=>{},this.capture=()=>{},this.selectVtt=()=>{},this.closeVtt=()=>{},this.handleTimeShift=()=>{},this.openUI=()=>{},this.hideUI=()=>{},this.options=(new W).merge(e),this.root=l("#"+e.videoNode),this.registerListeners(),this.createPlayer(),this.applyPlugins()}static use(e){const t=e.pluginName;return tl.plugins.some((t=>t.ctor===e))?tl:null==t?(ge.warn(`VhPlayer use plugin error，plugin: ${e.name} - ${t} can not be used`),tl):(tl.plugins.push({name:t,ctor:e}),tl)}registerListeners(){this.on(ne.SCHEDULER_COMPLETE,(e=>{ge.info("VhPlayer PlayerEvents.SCHEDULER_COMPLETE",e),e.timeShift||this.load(e.url)})),this.on(ne.DEFINITION_CHANGE,(e=>{ge.info("VhPlayer PlayerEvents.DEFINITION_CHANGE",e),this.load(e.url)})),this.on(ne.LINE_CHANGE,(e=>{ge.info("VhPlayer PlayerEvents.LINE_CHANGE",e),e.isReload?this.reload():this.load(e.url)})),this.on(ne.LINE_CHANGED,(()=>{ge.info("VhPlayer PlayerEvents.LINE_CHANGED"),this.intervalLoader&&this.intervalLoader.destroy()})),this.on(ne.PULL_STREAM_FAILED,(e=>{ge.info("VhPlayer PlayerEvents.PULL_STREAM_FAILED",e)})),window.ResizeObserver||z();new ResizeObserver((()=>{this.emit(ne.UIResize)})).observe(this.root)}createPlayer(){switch(this.playerType=Fa(this.options),this.playerType){case Z.Flv:this.vPlayer=new ye(this.options,"flv",this);break;case Z.Hls:a.default.isSupported()?this.vPlayer=new ve(this.options,this):this.vPlayer=new ye(this.options,"native",this);break;case Z.Native:case Z.HlsNative:this.vPlayer=new ye(this.options,"native",this);break;case Z.Dash:this.vPlayer=new be(this.options,this);break;default:throw Error("未提供支持的播放器类型")}this.video=this.vPlayer.video}applyPlugins(){tl.plugins.forEach((e=>{const t=e.ctor;"function"==typeof t&&(this.plugins[e.name]=new t(this))}))}load(e){this.vPlayer.load(e)}reload(){this.vPlayer.reload()}async destroy(){ge.warn("VhPlayer destroy，plugins：",Object.values(this.plugins));for(let e of Object.values(this.plugins))e.destroy&&e.destroy();await this.vPlayer.destroy(),this.video.remove()}play(){return this.video.play()}pause(){this.video.pause()}get isPaused(){return this.video.paused}get autoplay(){return this.video.autoplay}set autoplay(e){this.video.autoplay=e}get buffered(){return this.video.buffered}get bufferedMax(){let e=this.video.buffered;return e.length?e.end(e.length-1):0}get cdnName(){var e,t;return(null==(e=this.def)?void 0:e.currentQualityCdnName)||(null==(t=this.def)?void 0:t.currentQualityLineName)}get quality(){var e;return null==(e=this.def)?void 0:e.currentQuality}get qualities(){var e;return null==(e=this.def)?void 0:e.qualities}get controls(){return this.video.controls}set controls(e){this.video.controls=e}get crossOrigin(){return this.video.crossOrigin}set crossOrigin(e){this.video.crossOrigin=e}get currentTime(){return this.video.currentTime}set currentTime(e){this.video.currentTime=e}get defaultMuted(){return this.video.defaultMuted}set defaultMuted(e){this.video.defaultMuted=e}get duration(){return this.video.duration}get isEnded(){return this.video.ended}getEstimateNetSpeed(){return+this.vPlayer.getBandwidthEstimate().toFixed(3)}get loop(){return this.video.loop}set loop(e){this.video.loop=e}get muted(){return this.video.muted}set muted(e){this.video.muted=e}get networkState(){return this.video.networkState}get playbackRate(){return this.video.playbackRate}set playbackRate(e){this.video.playbackRate=e}get played(){return this.video.played}get preload(){return this.video.preload}set preload(e){this.video.preload=e}get readyState(){return this.video.readyState}get seekable(){return this.video.seekable}get isSeeking(){return this.video.seeking}get volume(){return this.video.volume}set volume(e){this.video.volume=e}static probe(){const e=document.createElement("video"),t=window.MediaSource||window.WebKitMediaSource;function i(i){return t&&t.isTypeSupported?t.isTypeSupported(i):e.canPlayType(i)}return __spreadProps(__spreadValues({},G),{H264:e.canPlayType('video/mp4; codecs="avc1.42E01E, mp4a.40.2"'),H265:e.canPlayType('video/mp4; codecs="hevc"'),WebM_VP8:e.canPlayType('video/webm; codecs="vp8, vorbis"'),WebM_VP9:e.canPlayType('video/webm; codecs="vp9"'),MSE_H264:i('video/mp4; codecs="avc1.4D401E"'),MSE_H265:i('video/mp4; codecs="hevc"'),MSE_WebM_VP8:i('video/webm; codecs="vp8, vorbis"'),MSE_WebM_VP9:i('video/webm; codecs="vp9"'),MSE_AV1:i('video/mp4; codecs="av01.0.05M.08"'),WebSocket:!!window.WebSocket})}static async createInstance(e,t,i){try{fe(void 0!==e.debug&&e.debug);let{scheduleOption:i}=e;if(Fa(e)===Z.Hls&&a.default.isSupported()){let{peer5Option:t}=e,i=(null==t?void 0:t.enable)?t.customerId:"";if(i)try{await d("script-peer5",`https://api.peer5.com/peer5.js?id=${i}`),await d("script-peer5-hls","https://api.peer5.com/peer5.hlsjs.loader.js")}catch(r){ge.error("VhPlayer.createInstance - peer5 sdk load error: "+r.message)}}let n=new tl(e);return window.vp=n,t&&t(n),n}catch(r){ge.warn("VhPlayer.createInstance error",r),i&&i({code:500,message:r.message})}}};let il=tl;il.plugins=[],il.Events=ne;const rl=il;var nl={};!function(e){var t;t=function(e){e.version="1.2.0";var t=function(){for(var e=0,t=new Array(256),i=0;256!=i;++i)e=1&(e=1&(e=1&(e=1&(e=1&(e=1&(e=1&(e=1&(e=i)?-306674912^e>>>1:e>>>1)?-306674912^e>>>1:e>>>1)?-306674912^e>>>1:e>>>1)?-306674912^e>>>1:e>>>1)?-306674912^e>>>1:e>>>1)?-306674912^e>>>1:e>>>1)?-306674912^e>>>1:e>>>1)?-306674912^e>>>1:e>>>1,t[i]=e;return"undefined"!=typeof Int32Array?new Int32Array(t):t}();e.table=t,e.bstr=function(e,i){for(var r=-1^i,n=e.length-1,a=0;a<n;)r=(r=r>>>8^t[255&(r^e.charCodeAt(a++))])>>>8^t[255&(r^e.charCodeAt(a++))];return a===n&&(r=r>>>8^t[255&(r^e.charCodeAt(a))]),-1^r},e.buf=function(e,i){if(e.length>1e4)return function(e,i){for(var r=-1^i,n=e.length-7,a=0;a<n;)r=(r=(r=(r=(r=(r=(r=(r=r>>>8^t[255&(r^e[a++])])>>>8^t[255&(r^e[a++])])>>>8^t[255&(r^e[a++])])>>>8^t[255&(r^e[a++])])>>>8^t[255&(r^e[a++])])>>>8^t[255&(r^e[a++])])>>>8^t[255&(r^e[a++])])>>>8^t[255&(r^e[a++])];for(;a<n+7;)r=r>>>8^t[255&(r^e[a++])];return-1^r}(e,i);for(var r=-1^i,n=e.length-3,a=0;a<n;)r=(r=(r=(r=r>>>8^t[255&(r^e[a++])])>>>8^t[255&(r^e[a++])])>>>8^t[255&(r^e[a++])])>>>8^t[255&(r^e[a++])];for(;a<n+3;)r=r>>>8^t[255&(r^e[a++])];return-1^r},e.str=function(e,i){for(var r,n,a=-1^i,s=0,o=e.length;s<o;)(r=e.charCodeAt(s++))<128?a=a>>>8^t[255&(a^r)]:r<2048?a=(a=a>>>8^t[255&(a^(192|r>>6&31))])>>>8^t[255&(a^(128|63&r))]:r>=55296&&r<57344?(r=64+(1023&r),n=1023&e.charCodeAt(s++),a=(a=(a=(a=a>>>8^t[255&(a^(240|r>>8&7))])>>>8^t[255&(a^(128|r>>2&63))])>>>8^t[255&(a^(128|n>>6&15|(3&r)<<4))])>>>8^t[255&(a^(128|63&n))]):a=(a=(a=a>>>8^t[255&(a^(224|r>>12&15))])>>>8^t[255&(a^(128|r>>6&63))])>>>8^t[255&(a^(128|63&r))];return-1^a}},"undefined"==typeof DO_NOT_EXPORT_CRC?t(e):t({})}(nl);class al{constructor(e=36e5){this.oldToken="",this.newToken="",this.expireThreshold=e,this.expireTime=0}create(e){this.oldToken=e;let t=e.split("_")[0],i=e.split("_")[1],r=t.split("").reverse().join(""),n=`${(nl.str(r)>>>0).toString(16).toUpperCase()}_${i}`;return this.newToken=n,this.expireTime=Date.now()+this.expireThreshold,n}get isExpired(){return Date.now()>this.expireTime}static refreshToken(e){if(!e.token||e.token.isExpired){let t=new al;e.token=t,e.tokenStr=t.create(e.tokenStr)}}}function sl(e,t,i){var r,n;let{scheduleOption:a}=t,s="live"===t.type,{live_type:o,live_subtitle:l}=a.playerData,d=s?(null==(r=t.liveOption)?void 0:r.defaultDefinition)||ee.PSame:(null==(n=t.vodOption)?void 0:n.defaultDefinition)||ee.PSame,h=1===l,u=s?function(e,t,i){var r,n;return t===Z.Flv?{key:"httpflv_url",allQuality:e.httpflv_urls,allQualitySubtitles:e.httpflv_subtitle_urls,tokenStr:e.token}:t===Z.Hls||t===Z.HlsNative?i?{key:"hls_url",allQuality:null==(r=e.timeshift)?void 0:r.hls_urls,allQualitySubtitles:null==(n=e.timeshift_subtitle)?void 0:n.hls_urls,tokenStr:e.token}:{key:"hls_url",allQuality:e.hls_urls,allQualitySubtitles:e.hls_subtitle_urls,tokenStr:e.token}:{key:"rtmp_url",allQuality:e.rtmp_urls,allQualitySubtitles:e.rtmp_subtitle_urls,tokenStr:e.token}}(e,i,1===o):function(e,t){return t===Z.Hls||t===Z.HlsNative?{key:"hls_domainname",allQuality:e.hls_domainnames,tokenStr:e.token}:{key:"mp4_domainname",allQuality:e.mp4_domainnames,tokenStr:e.token}}(e,i),c=h?u.allQualitySubtitles:u.allQuality,p=Object.keys(c);if(!p.length)throw Error("无可用清晰度");p.includes(d)||(d=p[0]);let f=c[d],g=function(e,t){let{debugCDN:i}=t;return i&&e.find((e=>e.cdn_name===i))||e[0]}(f,a),m=f.map((e=>e.cdn_name||e.line));return{allQuality:u.allQuality,allQualitySubtitles:u.allQualitySubtitles,qualities:p,lines:m,currentQuality:d,currentQualityUrl:g[u.key],currentQualityCdnName:g.cdn_name,currentQualityLineName:g.line,currentQualityLines:f,key:u.key,tokenStr:u.tokenStr}}class ol{constructor(e){this.player=e}fetch(){let e=this.buildURL();const t=new el;t.fire(e,{},"GET"),t.onError=e=>ge.error("Schedule fetch error",e),t.onLoad=e=>this.resolveData(e)}buildURL(){return""}getRandom(){return 1e8+(899999999*Math.random()>>0)}resolveData(e){let{options:t,playerType:i}=this.player;if(this.def=sl(e,t,i),ge.info("Schedule get def",this.def),"live"===t.type){let e=new al;this.def.token=e,this.def.tokenStr=e.create(this.def.tokenStr)}this.player.def=this.def,this.player.emit(ne.SCHEDULER_COMPLETE,{url:this.def.currentQualityUrl+"?token="+this.def.tokenStr,timeShift:"live"===t.type&&1===t.scheduleOption.playerData.live_type})}}class ll extends ol{constructor(e){super(e),this.fetch()}buildURL(){let{scheduleOption:e,vodOption:t}=this.player.options,{dispatch_server:i,default_server:r,safe_server:n,log_info:a}=e.playerData;const s="m3u8"===r.uri.split(".").pop();const o="ie"===G.browser,l=G.supportMSE&&!("android"===G.os&&"qqbrowser"===G.browser),d=!(!(null==n?void 0:n.uri)||!s||o||!l);let h={};h.webinar_id=t.recordId,h.rand=this.getRandom(),h.uid=a.uid,h.uri=this.getUri(d),h.bu=1;let u=this.getQuality(d);return h.quality=0===u.length?'["same"]':`["${u.join('","')}"]`,`${i}/api/dispatch_replay?${Jo.stringify(h)}`}getUri(e){let{playerType:t}=this.player,{scheduleOption:i}=this.player.options,{dispatch_server:r,default_server:n,safe_server:a}=i.playerData,s=r+n.uri,o=e?r+a.uri:s,l=document.createElement("a");return l.href="hls"===t?o:s,l.pathname}getQuality(e){let{scheduleOption:t}=this.player.options,{safe_definition:i,definition:r}=t.playerData;return(e?i:r)||["same"]}}class dl extends ol{constructor(e){super(e),this.fetch()}buildURL(){let{scheduleOption:e,liveOption:t}=this.player.options,{dispatch_server:i,log_info:r,app_type:n,live_subtitle:a,live_delay:s}=e.playerData,o={};return o.webinar_id=t.roomId,o.uid=r.uid,o.bu=1,o.rand=this.getRandom(),o.app_type=n,o.is_subtitle=a,o.is_delay_stream=s,`${i}/api/dispatch_play?${Jo.stringify(o)}`}}class hl{constructor(e){this.player=e;let{scheduleOption:t}=this.player.options;t.enable&&this.init()}init(){"live"===this.player.options.type?new dl(this.player):new ll(this.player),this.player.setQuality=this.setQuality.bind(this)}setQuality(e){let{def:t}=this.player;if(!t.qualities)return void ge.warn("Scheduler setQuality - 没有获取到可用清晰度");if(!t.qualities.includes(e))return void ge.warn(`Scheduler setQuality - 清晰度参数不可用-${e}；可设置清晰度：${t.qualities.join()}`);t.currentQuality=e,t.currentQualityLines=t.allQuality[e];let i=t.currentQualityLines.find((e=>e.line===t.currentQualityLineName));t.currentQualityUrl=i[t.key],al.refreshToken(t),this.player.emit(ne.DEFINITION_CHANGE,{url:t.currentQualityUrl+"?token="+t.tokenStr,quality:e})}destroy(){}}hl.pluginName="schedule";const ul=[["requestFullscreen","exitFullscreen","fullscreenElement","fullscreenEnabled","fullscreenchange","fullscreenerror"],["webkitRequestFullscreen","webkitExitFullscreen","webkitFullscreenElement","webkitFullscreenEnabled","webkitfullscreenchange","webkitfullscreenerror"],["webkitRequestFullScreen","webkitCancelFullScreen","webkitCurrentFullScreenElement","webkitCancelFullScreen","webkitfullscreenchange","webkitfullscreenerror"],["mozRequestFullScreen","mozCancelFullScreen","mozFullScreenElement","mozFullScreenEnabled","mozfullscreenchange","mozfullscreenerror"],["msRequestFullscreen","msExitFullscreen","msFullscreenElement","msFullscreenEnabled","MSFullscreenChange","MSFullscreenError"]],cl=(()=>{let e={};for(let t of ul)if(t[1]in document){let i=0,r=t.length;for(;i<r;i++)e[ul[0][i]]=t[i];return e}return e})(),pl={eventNameMap:{change:cl.fullscreenchange,error:cl.fullscreenerror},async request(e,t={navigationUI:"auto"}){if(e=e||document.documentElement,this.isEnabled)return await e[cl.requestFullscreen](t)},exit:async()=>await document[cl.exitFullscreen](),async toggle(e,t={navigationUI:"auto"}){return this.isFullscreen?await this.exit():await this.request(e,t)},onchange(e){this.on("change",e)},onerror(e){this.on("error",e)},on(e,t){this.eventNameMap[e]&&document.addEventListener(this.eventNameMap[e],t,!1)},off(e,t){this.eventNameMap[e]&&document.removeEventListener(this.eventNameMap[e],t,!1)},get isFullscreen(){return Boolean(document[cl.fullscreenElement])},get element(){return document[cl.fullscreenElement]},get isEnabled(){return Boolean(document[cl.fullscreenEnabled])}},fl={async request(e){if(this.isEnabled(e))return await e.webkitEnterFullscreen()},exit:async e=>await e.webkitExitFullscreen(),async toggle(e){return this.isFullscreen?await this.exit(e):await this.request(e)},get isFullscreen(){return document.fullScreen||document.webkitIsFullScreen||!1},isEnabled:e=>!!e.webkitEnterFullscreen};class gl{constructor(e){this.player=e,this.fsChangeHandler=()=>{this.player.emit(ne.FULLSCREEN_CHANGED,null!==pl.element)},this.init()}init(){pl.isEnabled?(this.player.enterFullscreen=pl.request.bind(pl,this.player.root),this.player.exitFullscreen=pl.exit,this.defineProperty(pl),this.player.toggleFullscreen=pl.toggle.bind(pl,this.player.root)):fl.isEnabled(this.player.video)&&(this.player.enterFullscreen=fl.request.bind(fl,this.player.video),this.player.exitFullscreen=fl.exit.bind(fl,this.player.video),this.defineProperty(fl),this.player.toggleFullscreen=fl.toggle.bind(fl,this.player.video)),pl.on("change",this.fsChangeHandler)}defineProperty(e){Object.defineProperty(this.player,"isFullscreen",{get:()=>e.isFullscreen})}destroy(){pl.off("change",this.fsChangeHandler)}}gl.pluginName="fullscreen";class ml{constructor(e){this.player=e,this.lagTimes=0,this.init()}init(){let{switchOption:e,type:t}=this.player.options;e.enable?(this.player.switch=this.switch.bind(this),"vod"!==t?this.registerListeners():ge.warn("Switcher 点播不运行卡顿切线")):ge.warn("Switcher 未开启切线功能")}registerListeners(){this.player.on(ne.LAG_REPORT,this.lag,this),this.player.on(ne.LAG_RECOVER,this.lagRecover,this)}lag(e){ge.warn("Switcher LAG_REPORT",e),this.lagTimes+=1,this.lagTimes>=3&&(ge.info("Switcher 开始卡顿切线"),this.lagTimes=0,this.switch())}lagRecover(e){ge.info("Switcher LAG_RECOVER",e),this.lagTimes=0}switch(e){let{def:t}=this.player,i=t.currentQualityCdnName||t.currentQualityLineName;if(e&&e===i)return void ge.warn("Switcher switch - 切线被忽略, 切换到了相同线路");let r=e?this.findLine(t.currentQualityLines,e):this.getNextLine(t.currentQualityLines,i);r?(t.currentQualityUrl=r[t.key],t.currentQualityCdnName=r.cdn_name,t.currentQualityLineName=r.line,al.refreshToken(t),this.player.emit(ne.LINE_CHANGE,{url:t.currentQualityUrl+"?token="+t.tokenStr,line:r.cdn_name||r.line,isReload:(r.cdn_name||r.line)===i})):ge.warn("Switcher switch - 切线被忽略, 线路未找到")}openLiveSubtitle(){}closeLiveSubtitle(){}getNextLine(e,t){let i=e.findIndex((e=>e.line===t))+1;return i>=e.length&&(i=0),e[i]}findLine(e,t){return e.find((e=>(e.cdn_name||e.line)===t))}destroy(){this.player.off(ne.LAG_REPORT),this.player.off(ne.LAG_RECOVER)}}ml.pluginName="switcher";class yl{constructor(e){this.player=e,this.isPursuing=!1,this.init()}init(){let{scheduleOption:e,pursueOption:t,type:i}=this.player.options;if(!t.enable)return void ge.warn("Pursue - 未开启追播功能");if("vod"===i)return void ge.warn("Pursue - 点播不运行追播策略");let{playerType:r}=this.player;1!=+e.playerData.live_type||r!==Z.Hls?r!==Z.Flash?r!==Z.HlsNative?(this.pursueConfig=t[r],ge.info("Pursue 开启追播策略",this.pursueConfig),this.registerListeners()):ge.warn("Pursue - 播放原生m3u8时，不运行追播策略"):ge.warn("Pursue - flash不运行追播策略"):ge.warn("Pursue - 时移直播不运行追播策略")}registerListeners(){this._onTimeupdate=H(this.onTimeupdate.bind(this),1e3),this.player.video.addEventListener("timeupdate",this._onTimeupdate)}unRegisterListeners(){this.player.video.removeEventListener("timeupdate",this._onTimeupdate)}onTimeupdate(){let e=this.player.bufferedMax,t=e-this.player.currentTime,{bufferPursue:i,bufferSeek:r,bufferStop:n,pursueSpeed:a,mode:s}=this.pursueConfig;if(t>i||this.isPursuing&&t>n)switch(s){case"pursue":t>r?this.jumpTo(e-n):this.run(a);break;case"seek":this.jumpTo(e-n);break;default:ge.warn(`Pursue 追播类型配置错误，只支持 pursue、seek，配置为 ${s}`)}else this.walk()}jumpTo(e){e<=0||(ge.info("Pursue jumpTo",e),this.player.currentTime=e,this.player.playbackRate=1,this.isPursuing=!1)}run(e){this.isPursuing||e<1||(ge.info("Pursue run speed",e),this.player.playbackRate=e,this.isPursuing=!0)}walk(){this.player.playbackRate=1,this.isPursuing=!1}destroy(){this.unRegisterListeners()}}yl.pluginName="pursue";class vl{constructor(e){this.player=e,this.pauseTime=0,this.firstTime=0,this.init()}init(){let{type:e}=this.player.options;"vod"!==e?this.registerListeners():ge.warn("Replay - 点播不运行暂停恢复逻辑")}registerListeners(){this.player.on(ne.Play,this.onPlay,this),this.player.on(ne.Pause,this.onPause,this),this.player.on(ne.Loaded,this.onLoaded,this),this.player.on(ne.LINE_CHANGE,this.onLineChange,this)}onLineChange(){this.pauseTime=0,this.firstTime=0}onPlay(){this.pauseTime?this.handleReplay((performance.now()-this.pauseTime)/1e3):this.onFirstPlay()}handleReplay(e){ge.info("Replay 暂停时长",e);let t=this.player.bufferedMax,{scheduleOption:i,liveOption:r}=this.player.options,n=1==+i.playerData.live_type;if(r.type===Z.Hls&&n&&this.player.cdnName===ie.TX)isFinite(t)&&t>=this.player.currentTime+e?ge.info("Replay - 时移直播暂停恢复(短暂停)，从暂停处接着播放"):ge.info("Replay - 时移直播暂停恢复(长暂停)，定位到最新进度");else{if(r.type===Z.Flash)return void this.player.reload();ge.info("Replay - 直播暂停恢复，跳到最新"),this.player.currentTime=this.player.currentTime+e}}onFirstPlay(){if(ge.info("Replay - 直播开始时，定位到最新进度"),this.firstTime)this.handleReplay((performance.now()-this.firstTime)/1e3);else{let{pursueOption:e}=this.player.options,t=e[this.player.playerType],i=this.player.bufferedMax-t.bufferStop;i>0&&(this.player.currentTime=this.player.currentTime+i)}}onLoaded(){this.player.playerType===Z.Hls&&(this.firstTime=performance.now())}onPause(){this.pauseTime=performance.now()}destroy(){}}vl.pluginName="replay";class bl{constructor(e){this.player=e,this.lastCurrentTime=0,this.lagTimes=0,this.lagBeginTime=0,this.detectInterval=0,this.gapDetectTime=500,this.gapEmitTime=3e3,this.init(),this.gapEmitLagTimes=this.gapEmitTime/this.gapDetectTime}init(){this.registerListeners()}registerListeners(){this.player.on(ne.Play,this.startDetect,this),this.player.on(ne.Pause,this.stopDetect,this),this.player.on(ne.Ended,this.stopDetect,this),this.player.on(ne.Error,this.onError,this),this.player.on(ne.Stalled,this.onError,this),this.player.on(ne.LINE_CHANGE,this.stopDetect,this),this.player.on(ne.PULL_STREAM_FAILED,this.stopDetect,this)}onError(e){e&&e.target&&"stalled"===e.type||this.startDetect()}startDetect(){this.detectInterval||(ge.info("Lag - 开始卡顿检测..."),this.detectInterval=window.setInterval((()=>{this.checkLag(this.player.currentTime),this.lagTimes&&this.lagTimes%this.gapEmitLagTimes==0?this.player.emit(ne.LAG_REPORT,{times:this.lagTimes,beginTime:this.lagBeginTime}):!this.lagTimes&&this.lagBeginTime&&(this.player.emit(ne.LAG_RECOVER,{lastTime:Date.now()-this.lagBeginTime}),this.lagBeginTime=0)}),this.gapDetectTime))}stopDetect(){ge.info("Lag - 停止卡顿检测"),clearInterval(this.detectInterval),this.detectInterval=0,this.lagTimes=0,this.lagBeginTime=0,this.lastCurrentTime=0}checkLag(e){this.lastCurrentTime===e?(this.lagTimes+=1,this.lagBeginTime||(this.lagBeginTime=Date.now()-this.gapDetectTime)):(this.lastCurrentTime=e,this.lagTimes=0)}destroy(){clearInterval(this.detectInterval),this.detectInterval=0,this.lagTimes=0,this.lagBeginTime=0,this.lastCurrentTime=0}}bl.pluginName="lag";class wl{static create(){return wl.S4()+wl.S4()+"-"+wl.S4()+"-"+wl.S4()+"-"+wl.S4()+"-"+wl.S4()+wl.S4()+wl.S4()}static S4(){return(65536*(1+Math.random())|0).toString(16).substring(1)}}class Sl{constructor(e){this.player=e,this.rootWidth=0,this.rootHeight=0,this.tracksSize=30,this.renderTopPosition=0,this.renderBottomPosition=0,this.tracker=[],this.renderQueue=[],this.renderTimer=0,this.renderSuccessCount=0,this.renderAborted=!1,this.renderDelay=150,this.opened=!0,this.init()}init(){var e;let{videoNode:t,barrageOption:i}=this.player.options;if(!i.enable)return void ge.warn("Barrage - 未开启弹幕功能");this.opened=null==(e=i.defaultOpen)||e;let r=h();!1!==r?(this.cssTransition=r,this.elRoot=s("#"+t),this.elBarrageRoot=o("div",{},{class:"barrage-root"}),this.elRoot.appendChild(this.elBarrageRoot),this.registerListeners(),this.player.addBarrage=this.addBarrage.bind(this),this.player.clearBarrage=this.clearBarrage.bind(this),this.player.openBarrage=this.open.bind(this),this.player.closeBarrage=this.close.bind(this)):ge.warn("Barrage - not support css3 transition")}registerListeners(){this.player.on(ne.Ended,this.clearBarrage,this),this.player.on(ne.UIResize,this.resize,this),p(null,(()=>{this.clearBarrage()}))}open(){this.opened=!0,this.player.emit(ne.OPEN_BARRAGE)}close(){this.opened=!1,this.player.emit(ne.CLOSE_BARRAGE),this.clearBarrage()}addBarrage(e,t={}){this.opened?this.tracker.length?(this.renderQueue.push({id:wl.create(),msg:this.filterContent(e),style:__spreadValues(__spreadValues({},this.player.options.barrageOption.style),t),width:0,totalDistance:0,rollSpeed:this.player.options.barrageOption.speed,rollTime:0,useTracks:0,tracks:[]}),this.renderTimer||this.render()):ge.warn("Barrage addBarrage - 添加弹幕失败，轨道数量为0"):ge.warn("Barrage addBarrage - 添加弹幕失败，弹幕未开启")}render(){try{this.renderToDom()}finally{this.renderEnd()}}renderToDom(){if(this.renderQueue.length){const e=this.renderQueue[0];let t=e.node;if(!t){e.node=t=o("div",{},{class:"barrage-item"}),t.innerHTML=e.msg;for(let i of Object.keys(e.style))t.style[i]=e.style[i]}if(this.elBarrageRoot.appendChild(t),e.useTracks=Math.ceil(t.offsetHeight/this.tracksSize),e.useTracks>this.tracker.length)return ge.warn("Barrage renderToDom - 弹幕占用高度过高，丢弃"),this.renderQueue.shift(),void this.elBarrageRoot.removeChild(t);e.width=t.offsetWidth,e.totalDistance=t.offsetWidth+this.rootWidth,e.rollTime=e.totalDistance/e.rollSpeed,this.addToTracks(e),e.tracks.length?(this.renderSuccessCount++,this.renderAborted=!1,this.renderQueue.shift(),t.setAttribute("data-y",e.tracks[0]+""),t.setAttribute("data-id",e.id),t.style.top=`${e.tracks[0]*this.tracksSize+this.renderTopPosition}px`,t.style[this.cssTransition.css]=`transform ${e.rollTime}s linear`,t.style.transform=`translate3d(-${e.totalDistance}px, 0, 0)`,t.addEventListener(this.cssTransition.event,(()=>{this.removeFromTracker(e.tracks,e.id),this.elBarrageRoot.removeChild(t)}),!1)):(this.renderAborted=!0,this.elBarrageRoot.removeChild(t))}}renderEnd(){this.renderQueue.length?(this.adaptRenderDelay(),this.renderTimer=window.setTimeout((()=>{this.render()}),this.renderDelay)):this.renderTimer=0}adaptRenderDelay(){this.renderAborted?(this.renderDelay+=40,this.renderSuccessCount=0):this.renderSuccessCount>10&&(this.renderDelay-=50,this.renderSuccessCount=0)}addToTracks(e){let t,i,r=[];for(let n=0;n<this.tracker.length;n++)if(t=this.tracker[n],t.length?(i=t[t.length-1],-c(i.node)>i.width?r.push(n):r=[]):r.push(n),r.length>=e.useTracks){e.tracks=r,r.forEach((t=>{this.tracker[t].push(e)}));break}}removeFromTracker(e,t){for(let i of e){const e=this.tracker[i];if(!e)continue;let r=0,n=e.length;for(;r<n;r++)if(e[r].id===t){e.splice(r,1);break}}}filterContent(e){return e&&e.replace(/<(?!img).*?>/gi,"")}clearBarrage(){this.eachNode((e=>{e.remove()})),this.tracker.forEach((e=>[])),this.renderQueue=[],this.player.emit(ne.CLEAR_BARRAGE)}computedTracks(){let{positionRange:e}=this.player.options.barrageOption;this.player.isFullscreen?(this.renderTopPosition=window.innerHeight*e[0],this.renderBottomPosition=window.innerHeight*e[1]):(this.renderTopPosition=this.rootHeight*e[0],this.renderBottomPosition=this.rootHeight*e[1]);let t=this.renderBottomPosition-this.renderTopPosition;const i=Math.floor(t/this.tracksSize);this.tracker=new Array(i);for(let r=0;r<i;r++)this.tracker[r]=[];ge.info("Barrage computedTracks",i)}resize(){ge.info("Barrage resize"),this.rootWidth=this.elRoot.clientWidth,this.rootHeight=this.elRoot.clientHeight,this.clearBarrage(),this.computedTracks()}eachNode(e){let t,i,r=this.elBarrageRoot.firstChild;for(;r;)1===r.nodeType&&(i=r.getAttribute("data-y"),t=r.getAttribute("data-id"),i&&t&&e(r,+i,t)),r=r.nextSibling}destroy(){var e;this.clearBarrage(),null==(e=this.elBarrageRoot)||e.remove()}}Sl.pluginName="barrage";var Tl,El;class _l{constructor(e){this.player=e,this.timer=0,this.createMarqueeItem=e=>{if(1===e){const e=this.elMarqueeRoot.querySelector(".marquee");e&&e.remove()}else if(!this.checkPosition())return!1;let{text:t,position:i=1,duration:r=6,alpha:n,fontSize:a,fontColor:s,height:l}=this.player.options.marqueeOption;if(!t)return void ge.warn("Marquee - 未提供配置：text");let d=o("div",{innerHTML:t},{class:"marquee",style:(n?`opacity: ${n/100};`:"")+(a?`font-size: ${a}px;`:"")+(s?`color: ${s};`:"")+(l?`line-height: ${l}px;`:"")});this.elMarqueeRoot.appendChild(d);const h=this.elMarqueeRoot.offsetWidth,u=this.elMarqueeRoot.offsetHeight,c=d.offsetWidth,p=d.offsetHeight,f={1:1,2:"20%",3:"50%",4:"80%"};switch(i){case 1:if(0===e){const e=.2*u,t=Math.floor(.6*u/p);let i=[e];for(let n=1;n<=t;n+=1)i.push(i[n-1]+p);let r=Math.floor(Math.random()*i.length);d.style.top=`${i[r]}px`}else.2*u>=p/2?(d.style.top=60*Math.random()+20+"%",d.style.transform="translateY(-50%)"):d.style.top=Math.random()*(u-p)+"px";break;case 2:.2*u>=p/2?(d.style.top=f[i],d.style.transform="translateY(-50%)"):d.style.top="0%";break;case 3:d.style.top=f[i],d.style.transform="translateY(-50%)";break;case 4:.2*u>=p/2?(d.style.top=f[i],d.style.transform="translateY(-50%)"):d.style.bottom="0%"}if(0===e)d.style.left="100%",d.style[this.cssTransition.css]=`transform ${r}s linear`,this._stepMoveCss3({label:d,textWidth:c,rootWidth:h});else{const e=h&&c&&(h-c)/h*100,t=e&&Math.random()*e;d.style.left=`${t}%`}},this.init()}init(){let{videoNode:e,marqueeOption:t}=this.player.options;if(!t.enable)return void ge.warn("Marquee - 未开启跑马灯功能");let i=h();!1!==i?(this.cssTransition=i,this.elRoot=s("#"+e),this.elMarqueeRoot=o("div",{},{class:"marquee-root"}),this.elRoot.appendChild(this.elMarqueeRoot),this.registerListeners(),this.createMarquee()):ge.warn("Marquee - not support css3 transition")}registerListeners(){p((()=>{this.timer||this.createMarquee()}),(()=>{this.destroy()}))}createMarquee(){let{type:e=0,interval:t=5}=this.player.options.marqueeOption;this.timer=window.setInterval(this.createMarqueeItem,1e3*t,e),this.createMarqueeItem(e)}_stepMoveCss3(e){e.label.addEventListener(this.cssTransition.event,(()=>{e.label.remove()})),e.label.style.transform=`translate(-${e.textWidth+e.rootWidth}px, -50%)`}checkPosition(){const e=this.elMarqueeRoot.querySelectorAll(".marquee");for(let t=0;t<e.length;t+=1){if(0===c(e[t]))return!1}return!0}destroy(){var e;clearInterval(this.timer),this.timer=0;const t=this.elMarqueeRoot.querySelectorAll(".marquee");let i=0,r=t.length;for(;i<r;i++)t[i].remove();null==(e=this.elMarqueeRoot)||e.remove()}}_l.pluginName="marquee";class kl{constructor(e){this.player=e,this.init()}init(){this.player.capture=this.capture.bind(this)}capture(){this.elCanvas||(this.elCanvas=document.createElement("canvas"));let e=this.player.video;this.elCanvas.width=e.videoWidth,this.elCanvas.height=e.videoHeight;let t=this.elCanvas.getContext("2d");return null==t||t.drawImage(e,0,0),this.elCanvas.toDataURL("image/jpeg")}destroy(){}}kl.pluginName="capture";class Pl{constructor(e,t){this.elRoot=e,this.vhPlayer=t,this.elMedia=t.video}}class Al extends Pl{constructor(e,t){super(e,t),this.width=0,this.cacheLayerX=0,this.cacheX=-1,this.cachePercent=-1,this.isSeeking=!1,this.onMouseDown=(e,t)=>{this.isSeeking=!0,this.cacheX=e.clientX;let i=e.clientX-t;e.target===this.elPos&&(i=e.clientX-t/2),this.cacheLayerX=e.target===this.elPos?i-8:i,this.percentMove(this.cacheLayerX/this.width*100)},this.onMouseMove=e=>{-1!==this.cacheX&&this.percentMove((this.cacheLayerX+e.clientX-this.cacheX)/this.width*100)},this.mouseUp=e=>{-1!==this.cacheX&&(this.isSeeking=!1,this.elMedia.currentTime=(this.cacheLayerX+e.clientX-this.cacheX)/this.width*this.elMedia.duration,this.cacheX=-1)},this.onEnded=()=>{this.isSeeking||(this.elBarCurrent.style.transform="translateX(0%)",this.elBarBuffered.style.transform="translateX(0%)",this.elPos.style.transform=`translate(${this.width}px, -50%)`)},this.init(),this.registerListeners()}init(){this.elBarRoot=o("div",{},{class:"bar-root"}),this.elBarRoot.innerHTML='\n<div class="bar bar-current"></div>\n<div class="bar bar-buffered"></div>\n<div class="pos"></div>\n',this.elRoot.appendChild(this.elBarRoot),this.elBarCurrent=this.elBarRoot.querySelector(".bar-current"),this.elBarBuffered=this.elBarRoot.querySelector(".bar-buffered"),this.elPos=this.elBarRoot.querySelector(".pos"),setTimeout((()=>{this.width=this.elBarRoot.clientWidth}),100)}registerListeners(){f(this.elBarRoot,"down",this.onMouseDown),f(this.elRoot,"move",this.onMouseMove),f(this.elBarRoot,"up",this.mouseUp),this.elRoot.addEventListener("mouseleave",this.mouseUp),this._onTimeupdate=H(this.onTimeupdate.bind(this),500),this._onProgress=H(this.onProgress.bind(this),500),this.elMedia.addEventListener("timeupdate",this._onTimeupdate),this.elMedia.addEventListener("progress",this._onProgress),this.elMedia.addEventListener("ended",this.onEnded),this.vhPlayer.on(ne.UIResize,this.onResize,this)}onResize(){this.width=this.elBarRoot.clientWidth,-1!==this.cachePercent&&this.percentMove(this.cachePercent)}onTimeupdate(){this.isSeeking||this.percentMove(this.elMedia.currentTime/this.elMedia.duration*100)}onProgress(){let e=_e(this.elMedia)/this.elMedia.duration*100;this.elBarBuffered.style.transform=`translateX(${-100+e}%)`}percentMove(e){e>100||e<0||(this.cachePercent=e,this.elBarCurrent.style.transform=`translateX(${-100+e}%)`,this.elPos.style.transform=`translate(${e*this.width/100}px, -50%)`)}unRegisterListeners(){this.elMedia.removeEventListener("timeupdate",this._onTimeupdate),this.elMedia.removeEventListener("progress",this._onProgress),this.elMedia.removeEventListener("ended",this.onEnded)}destroy(){this.unRegisterListeners()}}class Ll extends Pl{constructor(e,t){super(e,t),this.width=0,this.cacheLayerX=0,this.cacheX=-1,this.cachePercent=-1,this.timeShiftMax=7200,this.timeShiftDuration=7110,this.onMouseDown=e=>{this.cacheX=e.clientX,this.cacheLayerX=e.target===this.elPos?e.layerX-8:e.layerX,this.percentMove(this.cacheLayerX/this.width*100)},this.onMouseMove=e=>{-1!==this.cacheX&&this.percentMove((this.cacheLayerX+e.clientX-this.cacheX)/this.width*100)},this.mouseUp=e=>{if(-1===this.cacheX)return;let t=(this.cacheLayerX+e.clientX-this.cacheX)/this.width*this.timeShiftDuration;t=this.timeShiftDuration-t+90,t=t>this.timeShiftMax?this.timeShiftMax:t,this.vhPlayer.handleTimeShift(t),this.cacheX=-1},this.init(),this.registerListeners()}init(){this.elTsBarRoot=o("div",{},{class:"bar-root"}),this.elTsBarRoot.innerHTML='\n<div class="bar bar-current"></div>\n<div class="pos hide"></div>\n',this.elRoot.appendChild(this.elTsBarRoot),this.elBarCurrent=this.elTsBarRoot.querySelector(".bar-current"),this.elPos=this.elTsBarRoot.querySelector(".pos"),setTimeout((()=>{this.width=this.elTsBarRoot.clientWidth,this.percentMove(100),this.elPos.classList.remove("hide")}),100)}registerListeners(){this.elTsBarRoot.addEventListener("mousedown",this.onMouseDown),this.elRoot.addEventListener("mousemove",this.onMouseMove),this.elRoot.addEventListener("mouseleave",this.mouseUp),this.elTsBarRoot.addEventListener("mouseup",this.mouseUp),this.vhPlayer.on(ne.UIResize,this.onResize,this)}onResize(){this.width=this.elTsBarRoot.clientWidth,-1!==this.cachePercent&&this.percentMove(this.cachePercent)}percentMove(e){e>100||e<0||(this.cachePercent=e,this.elBarCurrent.style.transform=`translateX(${-100+e}%)`,this.elPos.style.transform=`translate(${e*this.width/100}px, -50%)`)}destroy(){}}class Ol extends Pl{constructor(e,t){super(e,t),this.onPlay=()=>{this.elIcon.classList.remove("icon-player-bofang"),this.elIcon.classList.add("icon-player-bofangzanting")},this.onPause=()=>{this.elIcon.classList.remove("icon-player-bofangzanting"),this.elIcon.classList.add("icon-player-bofang")},this.togglePlay=()=>{this.elMedia.paused?this.elMedia.play():this.elMedia.pause()},this.init(),this.registerListeners()}init(){this.elPlayRoot=o("div",{},{class:"ui-play-root"}),this.elPlayRoot.innerHTML='\n<i class="iconfont-player" title="播放/暂停"></i>\n',this.elRoot.appendChild(this.elPlayRoot),this.elIcon=this.elPlayRoot.querySelector(".iconfont-player"),this.elMedia.paused?this.onPause():this.onPlay()}registerListeners(){this.elIcon.addEventListener("click",this.togglePlay),this.elMedia.addEventListener("play",this.onPlay),this.elMedia.addEventListener("pause",this.onPause)}unRegisterListeners(){this.elMedia.removeEventListener("play",this.onPlay),this.elMedia.removeEventListener("pause",this.onPause)}destroy(){this.unRegisterListeners()}}class Cl extends Pl{constructor(e,t){super(e,t),this.reload=()=>{this.vhPlayer.emit(ne.LINE_CHANGE,{isReload:!0})},this.init(),this.registerListeners()}init(){this.elReloadRoot=o("div",{},{class:"ui-reload-root"}),this.elReloadRoot.innerHTML='\n<i class="iconfont-player icon-player-reload" title="刷新"></i>\n',this.elRoot.appendChild(this.elReloadRoot),this.elIcon=this.elReloadRoot.querySelector(".iconfont-player")}registerListeners(){this.elIcon.addEventListener("click",this.reload)}destroy(){this.elIcon.removeEventListener("click",this.reload)}}class Rl extends Pl{constructor(e,t){super(e,t),this.onTimeupdate=()=>{this.elDurationCurrent.textContent=this.timeFormat(this.elMedia.currentTime)},this.onDurationChange=()=>{this.elDurationTotal.textContent=this.timeFormat(this.elMedia.duration)},this.onEnd=()=>{this.elDurationCurrent.textContent=this.timeFormat(this.elMedia.duration)},this.init(),this.registerListeners()}init(){this.elDurationRoot=o("div",{},{class:"ui-duration-root"}),this.elDurationRoot.innerHTML='\n<span class="duration duration-current">00</span> / <span class="duration duration-total"></span>\n',this.elRoot.appendChild(this.elDurationRoot),this.elDurationCurrent=this.elDurationRoot.querySelector(".duration-current"),this.elDurationTotal=this.elDurationRoot.querySelector(".duration-total"),this.elDurationCurrent.textContent=this.timeFormat(0)}registerListeners(){this.elMedia.addEventListener("timeupdate",this.onTimeupdate),this.elMedia.addEventListener("durationchange",this.onDurationChange),this.elMedia.addEventListener("ended",this.onEnd)}timeFormat(e){let t=Math.floor(e/3600),i=Math.floor(e/60%60),r=Math.floor(e%60);return`${t>0?this.fillZero(t,!1)+":":""}${this.fillZero(i,!0)}:${this.fillZero(r,!0)}`}fillZero(e,t){return e>0?e<10?"0"+e:e+"":t?"00":""}unRegisterListeners(){this.elMedia.removeEventListener("timeupdate",this.onTimeupdate),this.elMedia.removeEventListener("durationchange",this.onDurationChange),this.elMedia.removeEventListener("ended",this.onEnd)}destroy(){this.unRegisterListeners()}}class Il extends Pl{constructor(e,t){super(e,t),this.opened=!0,this.onClick=()=>{this.opened?(this.elIcon.classList.replace("icon-player-danmukaiqi","icon-player-danmuguanbi"),this.vhPlayer.closeBarrage()):(this.elIcon.classList.replace("icon-player-danmuguanbi","icon-player-danmukaiqi"),this.vhPlayer.openBarrage()),this.opened=!this.opened},this.init(),this.registerListeners()}init(){let{barrageOption:e}=this.vhPlayer.options;e.enable&&(this.elBarrageRoot=o("div",{},{class:"ui-barrage-root"}),this.elBarrageRoot.innerHTML='\n      <i class="iconfont-player icon-player-danmukaiqi"></i>\n    ',this.elRoot.appendChild(this.elBarrageRoot),this.elIcon=this.elBarrageRoot.querySelector(".iconfont-player"))}registerListeners(){this.elIcon.addEventListener("click",this.onClick)}destroy(){this.elIcon.removeEventListener("click",this.onClick)}}class xl extends Pl{constructor(e,t){super(e,t),this.timer=0,this.onClick=e=>{this.changeVolume(e.layerY-this.height)},this.onMouseOverIcon=()=>{this.mouseOverShowSlider(),this.height||(this.height=this.elSliderRoot.clientHeight)},this.mouseOverShowSlider=()=>{this.vhPlayer.emit(ne.UISingleDisplay,this.constructor.name),this.elSlider.classList.add("active"),this.timer&&clearTimeout(this.timer)},this.mouseLeaveHideSlider=()=>{this.timer&&clearTimeout(this.timer),this.timer=window.setTimeout((()=>{this.elSlider.classList.remove("active")}),1e3)},this.toggleMuted=()=>{this.vhPlayer.video.muted=!this.vhPlayer.video.muted},this.onDrag=e=>{e.preventDefault(),0!==e.clientY&&this.changeLayout(e.layerY-2)},this.onDragEnd=e=>{e.preventDefault(),this.changeVolume(e.layerY-2)},this.init(),this.registerListeners()}init(){this.elVolRoot=o("div",{},{class:"ui-volume-root"}),this.elVolRoot.innerHTML='\n<i class="iconfont-player iconfont-player-vol"></i>\n<div class="volume-slider">\n  <div class="slider-root">\n    <div class="slider"></div>\n  </div>\n  <div class="pos" draggable="true"></div>\n</div>\n',this.elRoot.appendChild(this.elVolRoot),this.elIcon=this.elVolRoot.querySelector(".iconfont-player"),this.elSlider=this.elVolRoot.querySelector(".volume-slider"),this.elSliderRoot=this.elVolRoot.querySelector(".slider-root"),this.elSliderVol=this.elVolRoot.querySelector(".slider"),this.elSliderPos=this.elVolRoot.querySelector(".pos"),this.onVolumechange()}registerListeners(){this.elIcon.addEventListener("click",this.toggleMuted),this.elIcon.addEventListener("mouseenter",this.onMouseOverIcon),this.elIcon.addEventListener("mouseleave",this.mouseLeaveHideSlider),this.elSlider.addEventListener("mouseenter",this.mouseOverShowSlider),this.elSlider.addEventListener("mouseleave",this.mouseLeaveHideSlider),this.elSliderRoot.addEventListener("click",this.onClick),this.elSliderPos.addEventListener("drag",this.onDrag),this.elSliderPos.addEventListener("dragend",this.onDragEnd),this.vhPlayer.on(ne.Volumechange,this.onVolumechange,this)}onVolumechange(){let e=this.vhPlayer.video.muted?0:this.vhPlayer.video.volume;this.elSliderVol.style.transform=`translateY(${100*(1-e)}%)`,this.elSliderPos.style.transform=`translateY(${70*-e}px)`,this.vhPlayer.video.muted?(this.elIcon.classList.add("icon-player-jingyin"),this.elIcon.classList.remove("icon-player-shengyin")):(this.elIcon.classList.remove("icon-player-jingyin"),this.elIcon.classList.add("icon-player-shengyin"))}changeVolume(e){let t=this.height;e>0?e=0:e<-t&&(e=-t);let i=(t+e)/t;this.vhPlayer.video.volume=1-i,this.vhPlayer.video.muted=1===i}changeLayout(e){let t=this.height;e>0?e=0:e<-t&&(e=-t),this.elSliderVol.style.transform=`translateY(${(t+e)/t*100}%)`,this.elSliderPos.style.transform=`translateY(${e}px)`}destroy(){}}class Dl extends Pl{constructor(e,t){super(e,t),this.toggleFs=()=>{this.vhPlayer.toggleFullscreen()},this.init(),this.registerListeners()}init(){this.elFsRoot=o("div",{},{class:"ui-fullscreen-root"}),this.elFsRoot.innerHTML='\n<i class="iconfont-player icon-player-quanping1" title="全屏"></i>\n',this.elRoot.appendChild(this.elFsRoot),this.elIcon=this.elFsRoot.querySelector(".iconfont-player")}registerListeners(){this.elIcon.addEventListener("click",this.toggleFs),this.vhPlayer.on(ne.FULLSCREEN_CHANGED,this.onFsChange,this)}onFsChange(e){e?this.elIcon.classList.replace("icon-player-quanping1","icon-player-quanping"):this.elIcon.classList.replace("icon-player-quanping","icon-player-quanping1")}unRegisterListeners(){this.elIcon.removeEventListener("click",this.toggleFs),this.vhPlayer.off(ne.FULLSCREEN_CHANGED)}destroy(){this.unRegisterListeners()}}(El=Tl||(Tl={})).Vtt="vtt",El.Line="line",El.Quality="quality";class Ul extends Pl{constructor(e,t){super(e,t),this.mapping={[Tl.Vtt]:this.elContentVtt,[Tl.Line]:this.elContentLine,[Tl.Quality]:this.elContentQuality},this.timer1=-1,this.onContentMouseLeave=()=>{this.timer1=window.setTimeout((()=>{this.hide()}),1e3)},this.onClick=()=>{this.elSettingContent.classList.contains("active")?this.hide():(this.vhPlayer.emit(ne.UISingleDisplay,this.constructor.name),this.elSettingContent.classList.add("active"))},this.init(),this.registerListeners()}init(){this.elSettingRoot=o("div",{},{class:"ui-setting-root"}),this.elSettingRoot.innerHTML='\n<i class="iconfont-player icon-player-diandiandian" title="设置"></i>\n<ul class="setting-content"></ul>\n',this.elRoot.appendChild(this.elSettingRoot),this.elIcon=this.elSettingRoot.querySelector(".iconfont-player"),this.elSettingContent=this.elSettingRoot.querySelector(".setting-content")}registerListeners(){this.vhPlayer.on(ne.SCHEDULER_COMPLETE,this.onScheduleComplete,this),this.vhPlayer.on(ne.VTT_ADDED,this.addVttUI,this),this.vhPlayer.on(ne.UISingleDisplay,this.onSingleDisplay,this),this.vhPlayer.on(ne.DEFINITION_CHANGE,this.onQualityChange,this),this.vhPlayer.on(ne.LINE_CHANGE,this.onLineChange,this),this.vhPlayer.on(ne.VTT_SELECTED,this.onVttSelected,this),this.vhPlayer.on(ne.VTT_CLOSED,this.onVttClosed,this),this.elIcon.addEventListener("click",this.onClick),this.elSettingContent.addEventListener("mouseleave",this.onContentMouseLeave)}bindMouseEvent(e){this.mapping[e].addEventListener("mouseenter",(()=>{this.timer1&&window.clearTimeout(this.timer1)})),this.mapping[e].addEventListener("mouseleave",(e=>{e.currentTarget.classList.remove("active")}))}showSelectedUI(e){for(let t of Object.keys(this.mapping))t===e?this.mapping[t].classList.add("active"):this.mapping[t]&&this.mapping[t].classList.remove("active")}showSelectedUI2(e,t){let i=this.mapping[e].querySelectorAll("li");for(let r of i)r.dataset.val===t?r.classList.add("active"):r.classList.remove("active")}onQualityChange(e){this.showSelectedUI2(Tl.Quality,e.quality)}onLineChange(e){this.showSelectedUI2(Tl.Line,e.line)}onVttSelected(e){this.showSelectedUI2(Tl.Vtt,e.vtt)}onVttClosed(){this.showSelectedUI2(Tl.Vtt,"")}onScheduleComplete(){let{scheduleOption:e}=this.vhPlayer.options;if(e.enable){let e=document.createElement("li"),t=document.createElement("li");e.textContent="线路",t.textContent="清晰度",e.addEventListener("click",(()=>{this.showSelectedUI(Tl.Line)})),t.addEventListener("click",(()=>{this.showSelectedUI(Tl.Quality)})),this.elSettingContent.appendChild(e),this.elSettingContent.appendChild(t),this.addLineUI(),this.addQualityUI()}}addLineUI(){this.elContentLine=o("ul",{},{class:"setting-content2 setting-content-line"}),this.elSettingRoot.appendChild(this.elContentLine),this.mapping.line=this.elContentLine,this.elSettingContent2=this.elSettingRoot.querySelectorAll(".setting-content2"),this.bindMouseEvent(Tl.Line);let{lines:e,currentQualityCdnName:t,currentQualityLineName:i}=this.vhPlayer.def,{uiOptions:r}=this.vhPlayer.options;const n=!!(null==r?void 0:r.line)&&r.line;let a=document.createDocumentFragment();for(let s of e){let e=document.createElement("li");e.textContent=n&&n[s]?n[s]:s,e.dataset.val=s,s===(t||i)&&e.classList.add("active"),e.addEventListener("click",(e=>{this.vhPlayer.switch(e.currentTarget.dataset.val),this.hide()})),a.appendChild(e)}this.elContentLine.appendChild(a)}addQualityUI(){this.elContentQuality=o("ul",{},{class:"setting-content2 setting-content-quality"}),this.elSettingRoot.appendChild(this.elContentQuality),this.mapping.quality=this.elContentQuality,this.elSettingContent2=this.elSettingRoot.querySelectorAll(".setting-content2"),this.bindMouseEvent(Tl.Quality);let{qualities:e,currentQuality:t}=this.vhPlayer.def,{uiOptions:i}=this.vhPlayer.options;const r=!!(null==i?void 0:i.quality)&&i.quality;let n=document.createDocumentFragment();for(let a of e){let e=document.createElement("li");e.textContent=r&&r[a]?r[a]:a,e.dataset.val=a,a===t&&e.classList.add("active"),e.addEventListener("click",(e=>{this.vhPlayer.setQuality(e.currentTarget.dataset.val),this.hide()})),n.appendChild(e)}this.elContentQuality.appendChild(n)}addVttUI(){let{vttOptions:e,type:t}=this.vhPlayer.options;if(e.enable&&"vod"===t){this.elContentVtt=o("ul",{},{class:"setting-content2 setting-content-vtt"}),this.elSettingRoot.appendChild(this.elContentVtt),this.mapping.vtt=this.elContentVtt,this.elSettingContent2=this.elSettingRoot.querySelectorAll(".setting-content2"),this.bindMouseEvent(Tl.Vtt);let t=document.createElement("li");t.textContent="字幕",t.addEventListener("click",(()=>{this.showSelectedUI(Tl.Vtt)})),this.elSettingContent.appendChild(t);let i=document.createElement("li");i.textContent="关闭",i.dataset.val="",i.addEventListener("click",(()=>{this.vhPlayer.closeVtt(),this.hide()})),this.elContentVtt.appendChild(i);let r=document.createDocumentFragment();for(let n of e.tracks){let e=document.createElement("li");e.textContent=n.label||n.srclang,e.dataset.val=n.srclang,n.default&&e.classList.add("active"),e.addEventListener("click",(()=>{this.vhPlayer.selectVtt(n.srclang),this.hide()})),r.appendChild(e)}this.elContentVtt.appendChild(r)}}onSingleDisplay(e){e!==this.constructor.name&&this.hide()}hide(){this.elSettingContent.classList.remove("active"),this.elSettingContent2.forEach((e=>e.classList.remove("active")))}destroy(){}}class Ml{constructor(e){this.player=e,this.toggleShow=e=>{if(this.elControlWrapper.classList.contains("active")){let t=0,i=e.target;for(;t<6&&i&&i!==this.elControlWrapper;)i=i.parentNode,t+=1;i!==this.elControlWrapper&&this.elControlWrapper.classList.remove("active")}else this.elControlWrapper.classList.add("active")},this.init()}init(){let{videoNode:e,scheduleOption:t,vttOptions:i,type:r,controls:n}=this.player.options;if("custom"!==n)return void ge.warn("UI - 未开启自定义控制栏");this.elRoot=s("#"+e),this.elControlWrapper=o("div",{},{class:"player-control-wrapper active "+("live"===r?"is-live":"")}),this.elLoadingWrapper=o("div",{},{class:"player-loading-wrapper hide"}),this.elLoadingWrapper.innerHTML='\n      <i class="iconfont-player icon-player-Loading"></i>\n    ',this.elControlWrapper.innerHTML='\n      <div class="bar-wrapper"></div>\n      <div class="tools-wrapper">\n        <div class="tools-wrapper-left"></div>\n        <div class="tools-wrapper-right"></div>\n      </div>',this.elRoot.appendChild(this.elLoadingWrapper),this.elRoot.appendChild(this.elControlWrapper);let a=this.elRoot.querySelector(".tools-wrapper-left"),l=this.elRoot.querySelector(".tools-wrapper-right"),d=this.elRoot.querySelector(".bar-wrapper");new Ol(a,this.player),"live"===r&&new Cl(a,this.player),"vod"===r?(new Al(d,this.player),new Rl(a,this.player)):1===t.playerData.live_type?new Ll(d,this.player):d.remove(),new Il(l,this.player),"pc"===G.platform&&new xl(l,this.player),new Dl(l,this.player),(t.enable||i.enable&&"vod"===r)&&new Ul(l,this.player),this.player.openUI=this.openUI.bind(this),this.player.hideUI=this.hideUI.bind(this),this.registerListeners()}registerListeners(){this.elRoot.addEventListener("click",this.toggleShow),this.player.on(ne.Waiting,(()=>{this.elLoadingWrapper.classList.remove("hide")})),this.player.on(ne.Canplay,(()=>{this.elLoadingWrapper.classList.add("hide")}))}openUI(){this.elControlWrapper.classList.add("active")}hideUI(){this.elControlWrapper.classList.remove("active")}destroy(){var e;null==(e=this.elControlWrapper)||e.remove()}}Ml.pluginName="UI";class Nl{constructor(e){this.player=e,this.init()}init(){var e;let{vttOptions:t,type:i}=this.player.options;"live"!==i?t.enable?(null==(e=t.tracks)?void 0:e.length)?(this.loadTracks(),this.player.selectVtt=this.selectVtt.bind(this),this.player.closeVtt=this.closeVtt.bind(this)):ge.warn("Vtt - 字幕列表为空"):ge.warn("Vtt - 未开启字幕"):ge.warn("Vtt - 暂不支持对直播添加字幕")}loadTracks(){for(let e of this.player.options.vttOptions.tracks)this.addTracks(e);this.player.emit(ne.VTT_ADDED)}selectVtt(e){for(let t of this.player.video.textTracks)t.language===e?(t.mode="showing",this.player.emit(ne.VTT_SELECTED,{vtt:e})):t.mode="hidden"}closeVtt(){for(let e of this.player.video.textTracks)e.mode="hidden";this.player.emit(ne.VTT_CLOSED)}addTracks(e){let t=o("track",{},{label:e.label||e.srclang,kind:e.kind,srclang:e.srclang,src:e.src});t.default=!0===e.default,this.player.video.appendChild(t)}destroy(){}}Nl.pluginName="Vtt";const Fl=class{constructor(e){this.player=e,this.init()}init(){let{type:e}=this.player.options;"vod"!==e?this.player.playerType===Z.Hls?(this.player.handleTimeShift=this.handleTimeShift.bind(this),this.registerListeners()):ge.warn(`TimeShift - 直播时移只支持hls，当前播放器类型：${this.player.playerType}`):ge.warn("TimeShift - 点播活动不运行直播时移")}registerListeners(){this.player.on(ne.SCHEDULER_COMPLETE,this.onScheduleComplete,this)}handleTimeShift(e=0){if(this.player.cdnName!==ie.TX)return void ge.warn(`TimeShift - 直播时移只支持腾讯线路，当前线路：${this.player.cdnName}`);e=e<Fl.TENCENT_DELAY?Fl.TENCENT_DELAY:Math.round(e);let t=(this.player.vPlayer.url||this.player.vPlayer.cacheUrl).split("?")[0]+this.creatTencentTimeShiftUrl(e);this.player.load(t),this.player.emit(ne.LIVE_TIMESHIFT,{delay:e,url:t})}onScheduleComplete(e){e.timeShift&&this.player.load(`${e.url}&delay=${Fl.TENCENT_DELAY}`)}creatAliyunTimeShiftUrl(e){return`?aliyunols=on&lhs_start_human_s_8=${e}`}creatTencentTimeShiftUrl(e){let{def:t}=this.player;return al.refreshToken(t),`?delay=${e}&token=${t.tokenStr}`}destroy(){}};let Bl=Fl;Bl.pluginName="timeShift",Bl.TENCENT_DELAY=90,rl.use(hl),rl.use(gl),rl.use(ml),rl.use(yl),rl.use(vl),rl.use(bl),rl.use(Sl),rl.use(_l),rl.use(kl),rl.use(Ml),rl.use(Nl),rl.use(Bl);const Vl=document.querySelector.bind(document);function jl(e,t,i="click"){"string"==typeof e&&(e=Vl(e)),e&&e.addEventListener(i,t)}function zl(){let e={};return new window.URL(location.href).searchParams.forEach(((t,i,r)=>{e[i]=t})),e}let ql;const Gl={dispatch_server:"https://gslb.e.vhall.com",log_info:{uid:"10000127"}},Hl=__spreadProps(__spreadValues({},Gl),{safe_definition:["same","a","360p"],definition:["same","a","360p"],default_server:{uri:"/vhallyun/vhallcoop/02290ce8c85e49463092cb860d455983/58faa1f6/02290ce8c85e49463092cb860d455983.m3u8",mp4_domainnames:""},subtitle_info:{}}),Wl=__spreadProps(__spreadValues({},Gl),{app_type:0,live_type:0,live_subtitle:0,live_delay:0,live_duration:0});let $l=[location.pathname+"out.flv",location.pathname+"qhh.flv"],Xl=[location.pathname+"hls1/out.m3u8",location.pathname+"hls2/qhh.m3u8"];function Ql(e="flv",t=0){let i="flv"===e?$l:Xl;if(2===i.length){let e=zl();console.log("ana querystring",e),e.url&&i.unshift(e.url)}return{index:t=t>=i.length?0:t,url:i[t]+"?token=alibaba"}}const Yl={videoNode:"vh-player",type:"vod",autoplay:!0,controls:"custom",muted:!1,debug:!0};function Kl(){let e;function t(){const t=function(){let e=zl();console.log("ana querystring",e);const t=e.type;return"vod"===t&&"true"===e.schedule&&e.scheduleUri&&(Hl.default_server.uri=e.scheduleUri),"live"===t&&"true"===e.timeshift&&(Wl.live_type=1),__spreadProps(__spreadValues({},Yl),{type:t||"vod",appId:e.appId,accountId:405,token:"vhall",liveOption:{roomId:e.roomId,type:e.playerType||Z.Flv},vodOption:{recordId:e.recordId},scheduleOption:{enable:"true"===e.schedule,playerData:"live"===t?Wl:Hl,debugUrl:e.url?e.url+(-1!==e.url.indexOf("?token")?"":"?token=alibaba"):"",debugCDN:e.cdn||ie.TX,debugPlayer:e.playerType},peer5Option:{enable:"true"===e.peer5,customerId:e.peer5CustomerId,fallback:!0},switchOption:{enable:!0},pursueOption:{enable:!0},marqueeOption:{enable:!0,type:1,text:"test marquee"},vttOptions:{enable:!0,tracks:[{label:"英文",kind:"subtitles",srclang:"en",src:location.pathname+"vtt/subtitles_en.vtt"},{label:"中文",kind:"subtitles",srclang:"zh",src:location.pathname+"vtt/subtitles_zh.vtt",default:!0}]},uiOptions:{line:{[ie.TX]:"腾讯线路",[ie.ALI]:"备用线路1",[ie.HW]:"备用线路2",[ie.CY]:"备用线路3"},quality:{[ee.PSame]:"原画",[ee.P720]:"高清",[ee.P480]:"标清",[ee.P360]:"流畅",[ee.Pa]:"音频"}}})}();rl.createInstance(t,(i=>{if(e=i,function(e){e.on(rl.Events.FULLSCREEN_CHANGED,(e=>{console.log("Events.FULLSCREEN_CHANGED",e)}))}(i),function(e){const t=["abort","canplay","canplaythrough","durationchange","emptied","ended","error","loadeddata","loadedmetadata","loadstart","pause","play","ratechange","seeked","seeking","stalled","suspend","waiting"];for(let i of t)e.video.addEventListener(i,(()=>{console.log(`[vlog - origin event: ${i}]`)}))}(i),!t.scheduleOption.enable)if(t.scheduleOption.debugUrl)e.load(t.scheduleOption.debugUrl);else{const t={flv:"out.flv",hls:"hls1/out.m3u8",native:"hls1/out.m3u8",flash:"",dash:"dash/qhh.mpd"};e.load(location.pathname+t[e.playerType])}}),(e=>{console.error(e)}))}!function(e){let t;ql||(ql=Vl("#log")),"object"==typeof e?(t=document.createElement("pre"),t.textContent=JSON.stringify(e,null,2)):(t=document.createElement("p"),t.textContent=e),ql.appendChild(t)}(rl.probe());const i=s(".mask-info"),r=s("#bandwidth"),n=s("#cdn"),a=s("#quality"),o=s("#bufferedTime"),l=s("#playedTime"),d=s("#canSeekTime"),h=s(".mask-capture"),u=s(".mask-capture > img");let c=0,p=0;jl(s("#btn-init-player"),(()=>{t()})),jl(s("#btn-toggle-play"),(()=>{e.video.paused?e.play():e.pause()})),jl(s("#btn-seek"),(()=>{e.currentTime=70})),jl(s("#btn-destroy"),(()=>{e.destroy()})),jl(s("#btn-capture"),(()=>{h.style.display="block",u.src=e.capture(),window.clearTimeout(p),p=window.setTimeout((()=>{h.style.display="none"}),3e3)})),jl(s("#btn-add-barrage"),(()=>{let t=new Array(100);for(let i of t)e.addBarrage("test barrage 测试弹幕",{color:"red"})})),jl(s("#btn-clear-barrage"),(()=>{e.clearBarrage()})),jl(s("#btn-browser-hank"),(()=>{s("#mask-all").style.display="block"}));const f=()=>{n.textContent=null==e?void 0:e.cdnName,a.textContent=null==e?void 0:e.quality,r.textContent=(null==e?void 0:e.getEstimateNetSpeed())+"",o.textContent=(null==e?void 0:e.bufferedMax)+"",l.textContent=(null==e?void 0:e.currentTime)+"",d.textContent=(null==e?void 0:e.bufferedMax)-(null==e?void 0:e.currentTime)+""};jl(s("#btn-mask-info"),(()=>{"block"===i.style.display?(i.style.display="none",clearInterval(c)):(i.style.display="block",f(),c=window.setInterval(f,5e3))}))}function Zl(){let e,t;jl(s("#btn-flv-init"),(()=>{Yl.videoNode="flv-player",console.log("Flv Player Params:",Yl),window.vp=e=new ye(Yl),t=Ql("flv"),e.load(t.url).then((()=>{!function(e){e.nPlayer.on(ye.Events.ERROR,((e,t,i)=>{console.log("FlvPlayer.Events.ERROR"),console.log("errorType: ",e),console.log("errorDetail: ",t),console.log("errorInfo: ",i)})),e.nPlayer.on(ye.Events.LOADING_COMPLETE,(e=>{console.log("FlvPlayer.Events.LOADING_COMPLETE",e)})),e.nPlayer.on(ye.Events.MEDIA_INFO,(e=>{console.log("FlvPlayer.Events.MEDIA_INFO",e)})),e.nPlayer.on(ye.Events.METADATA_ARRIVED,(e=>{console.log("FlvPlayer.Events.METADATA_ARRIVED",e)})),e.nPlayer.on(ye.Events.RECOVERED_EARLY_EOF,(e=>{console.log("FlvPlayer.Events.RECOVERED_EARLY_EOF",e)})),e.nPlayer.on(ye.Events.SCRIPTDATA_ARRIVED,(e=>{console.log("FlvPlayer.Events.SCRIPTDATA_ARRIVED",e)})),e.nPlayer.on(ye.Events.STATISTICS_INFO,(e=>{}))}(e)}))})),jl(s("#btn-flv-toggle-play"),(()=>{e.video.paused?e.video.play():e.video.pause()})),jl(s("#btn-flv-switch"),(()=>{t=Ql("flv",t.index+1),e.load(t.url)}))}window.onload=function(){Kl(),Zl(),function(){let e,t;jl(s("#btn-hls-init"),(()=>{Yl.videoNode="hls-player",console.log("Hls Player Params:",Yl),fe(Yl.debug),window.vp=e=new ve(Yl),t=Ql("hls"),e.load(t.url)})),jl(s("#btn-hls-toggle-play"),(()=>{e.video.paused?e.video.play():e.video.pause()})),jl(s("#btn-hls-switch"),(()=>{t=Ql("hls",t.index+1),e.load(t.url)})),jl(s("#btn-hls-seek"),(()=>{e.video.currentTime=1440}))}(),function(){let e,t;jl(s("#btn-hlslite-init"),(()=>{Yl.videoNode="hls-lite-player",console.log("HlsLite Player Params:",Yl),fe(Yl.debug),window.vp=e=new Na(Yl),t=Ql("hls"),e.load(t.url)})),jl(s("#btn-hlslite-toggle-play"),(()=>{e.video.paused?e.video.play():e.video.pause()})),jl(s("#btn-hlslite-switch"),(()=>{t=Ql("hls",t.index+1),e.load(t.url)}))}()}}(flvjs,Hls,dashjs);
